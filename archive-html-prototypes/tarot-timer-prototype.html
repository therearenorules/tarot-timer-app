<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íƒ€ë¡œ íƒ€ì´ë¨¸ í”„ë¡œí† íƒ€ì…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            /* ë¸Œëœë“œ ìƒ‰ìƒ */
            --background: #0f0f1a;
            --foreground: #ffffff;
            --card: #1a1f3a;
            --card-foreground: #ffffff;
            --primary: #4a1a4f;
            --secondary: #1a1f3a;
            --secondary-foreground: #c8b8d4;
            --accent: #f4d03f;
            --accent-foreground: #0f0f1a;
            --border: #2a2f4a;
            --premium-gold: #f4d03f;
            --deep-purple: #4a1a4f;
            --midnight-blue: #1a1f3a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--midnight-blue) 0%, var(--deep-purple) 50%, var(--midnight-blue) 100%);
            color: var(--foreground);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes mystical-pulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1); 
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.02); 
            }
        }

        .mystical-pulse {
            animation: mystical-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(244, 208, 63, 0.3);
            }
            50% { 
                box-shadow: 0 0 40px rgba(244, 208, 63, 0.6);
            }
        }

        .glow-effect {
            animation: glow 2s ease-in-out infinite;
        }

        /* ì»¨í…Œì´ë„ˆ */
        .app-container {
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--background);
            position: relative;
            overflow: hidden;
        }

        /* í—¤ë” */
        .header {
            padding: 44px 20px 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--premium-gold) 0%, #ffffff 50%, var(--premium-gold) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: var(--secondary-foreground);
            font-size: 16px;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ íƒ­ */
        .nav-tabs {
            display: flex;
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(16px);
            border-radius: 16px;
            margin: 0 20px;
            padding: 4px;
            position: relative;
        }

        .nav-tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .nav-tab.active {
            background: var(--primary);
            color: var(--foreground);
            box-shadow: 0 4px 12px rgba(74, 26, 79, 0.3);
        }

        .nav-tab:not(.active) {
            color: var(--secondary-foreground);
        }

        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            padding: 20px;
            min-height: calc(100vh - 180px);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* ìŠ¤í”„ë ˆë“œ ì„ íƒ í™”ë©´ */
        .spread-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-top: 24px;
        }

        .spread-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .spread-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--premium-gold) 0%, var(--accent) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .spread-card:hover,
        .spread-card.selected {
            border-color: var(--premium-gold);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(244, 208, 63, 0.2);
        }

        .spread-card:hover::before,
        .spread-card.selected::before {
            opacity: 1;
        }

        .spread-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
        }

        .spread-description {
            color: var(--secondary-foreground);
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .spread-cards {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .spread-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--premium-gold);
            font-size: 14px;
            font-weight: 600;
        }

        .spread-time {
            color: var(--secondary-foreground);
            font-size: 12px;
        }

        /* íƒ€ì´ë¨¸ í™”ë©´ */
        .timer-container {
            text-align: center;
            padding: 40px 0;
        }

        .timer-circle {
            width: 280px;
            height: 280px;
            margin: 0 auto 40px;
            position: relative;
        }

        .circle-progress {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(var(--premium-gold) 0deg, transparent 0deg);
            padding: 8px;
            transition: all 0.1s ease;
        }

        .circle-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--card);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--border);
        }

        .timer-time {
            font-size: 48px;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .timer-label {
            color: var(--secondary-foreground);
            font-size: 16px;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .control-btn {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.2s ease;
            position: relative;
        }

        .control-btn.primary {
            background: var(--primary);
            color: var(--foreground);
            box-shadow: 0 4px 16px rgba(74, 26, 79, 0.3);
        }

        .control-btn.primary:active {
            transform: scale(0.95);
        }

        .control-btn.secondary {
            background: var(--secondary);
            color: var(--secondary-foreground);
            border: 2px solid var(--border);
        }

        .current-spread {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .current-spread h3 {
            color: var(--premium-gold);
            font-size: 16px;
            margin-bottom: 8px;
        }

        .current-spread p {
            color: var(--secondary-foreground);
            font-size: 14px;
        }

        /* ì„¸ì…˜ ê¸°ë¡ í™”ë©´ */
        .sessions-list {
            margin-top: 20px;
        }

        .session-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .session-spread {
            color: var(--premium-gold);
            font-weight: 600;
        }

        .session-date {
            color: var(--secondary-foreground);
            font-size: 12px;
        }

        .session-duration {
            color: var(--foreground);
            font-size: 18px;
            font-weight: 700;
        }

        /* ë²„íŠ¼ */
        .btn {
            background: var(--primary);
            color: var(--foreground);
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-top: 20px;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn.secondary {
            background: transparent;
            color: var(--secondary-foreground);
            border: 2px solid var(--border);
        }

        /* ì„¤ì • í™”ë©´ */
        .settings-group {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .settings-group h3 {
            color: var(--premium-gold);
            font-size: 16px;
            margin-bottom: 16px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: var(--foreground);
            font-size: 14px;
        }

        .setting-value {
            color: var(--secondary-foreground);
            font-size: 14px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 375px) {
            .timer-circle {
                width: 240px;
                height: 240px;
            }
            
            .timer-time {
                font-size: 36px;
            }
            
            .header h1 {
                font-size: 24px;
            }
        }

        /* ìƒíƒœ í‘œì‹œ */
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-ready { background: var(--premium-gold); }
        .status-running { background: #22c55e; }
        .status-paused { background: #f59e0b; }
        .status-finished { background: #ef4444; }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--secondary-foreground);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--foreground);
        }

        .empty-state p {
            font-size: 14px;
            line-height: 1.4;
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--premium-gold);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1 class="mystical-pulse">ğŸ”® íƒ€ë¡œ íƒ€ì´ë¨¸</h1>
            <p>ì‹ ë¹„ë¡œìš´ ì—¬ì •ì„ ì‹œì‘í•˜ì„¸ìš”</p>
        </div>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ íƒ­ -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-screen="spreads">ìŠ¤í”„ë ˆë“œ</div>
            <div class="nav-tab" data-screen="timer">íƒ€ì´ë¨¸</div>
            <div class="nav-tab" data-screen="sessions">ì„¸ì…˜</div>
            <div class="nav-tab" data-screen="settings">ì„¤ì •</div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="main-content">
            <!-- ìŠ¤í”„ë ˆë“œ ì„ íƒ í™”ë©´ -->
            <div id="spreads" class="screen active">
                <div class="spread-grid">
                    <div class="spread-card" data-spread="past-present-future">
                        <div class="spread-name">ê³¼ê±°-í˜„ì¬-ë¯¸ë˜</div>
                        <div class="spread-description">ì‹œê°„ì˜ íë¦„ ì†ì—ì„œ ìƒí™©ì„ íŒŒì•…í•˜ê³  ë¯¸ë˜ë¥¼ ì¤€ë¹„í•˜ì„¸ìš”</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>ğŸ”®</span>
                                <span>3ì¥ì˜ ì¹´ë“œ</span>
                            </div>
                            <div class="spread-time">15ë¶„ ê¶Œì¥</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="love-relationship">
                        <div class="spread-name">ì—°ì• ìš´</div>
                        <div class="spread-description">ì‚¬ë‘ê³¼ ê´€ê³„ì— ëŒ€í•œ ê¹Šì€ í†µì°°ì„ ì–»ì–´ë³´ì„¸ìš”</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>ğŸ’•</span>
                                <span>5ì¥ì˜ ì¹´ë“œ</span>
                            </div>
                            <div class="spread-time">25ë¶„ ê¶Œì¥</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="career-money">
                        <div class="spread-name">ì§ì—…ê³¼ ê¸ˆì „ìš´</div>
                        <div class="spread-description">ì»¤ë¦¬ì–´ì™€ ì¬ì •ì— ê´€í•œ ì¡°ì–¸ì„ êµ¬í•´ë³´ì„¸ìš”</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>ğŸ’°</span>
                                <span>4ì¥ì˜ ì¹´ë“œ</span>
                            </div>
                            <div class="spread-time">20ë¶„ ê¶Œì¥</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="celtic-cross">
                        <div class="spread-name">ì…€í‹± í¬ë¡œìŠ¤</div>
                        <div class="spread-description">ê°€ì¥ ì „í†µì ì´ê³  í¬ê´„ì ì¸ íƒ€ë¡œ ìŠ¤í”„ë ˆë“œ</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>âœ¨</span>
                                <span>10ì¥ì˜ ì¹´ë“œ</span>
                            </div>
                            <div class="spread-time">45ë¶„ ê¶Œì¥</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="daily-guidance">
                        <div class="spread-name">ì˜¤ëŠ˜ì˜ ê°€ì´ë˜ìŠ¤</div>
                        <div class="spread-description">í•˜ë£¨ë¥¼ ì‹œì‘í•˜ê¸° ì „ í•„ìš”í•œ ì¡°ì–¸ì„ ë°›ì•„ë³´ì„¸ìš”</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>ğŸŒ…</span>
                                <span>1ì¥ì˜ ì¹´ë“œ</span>
                            </div>
                            <div class="spread-time">5ë¶„ ê¶Œì¥</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- íƒ€ì´ë¨¸ í™”ë©´ -->
            <div id="timer" class="screen">
                <div id="timer-content">
                    <div class="empty-state">
                        <div class="empty-state-icon">â±ï¸</div>
                        <h3>ìŠ¤í”„ë ˆë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
                        <p>ë¨¼ì € ìŠ¤í”„ë ˆë“œ íƒ­ì—ì„œ ì›í•˜ëŠ” ìŠ¤í”„ë ˆë“œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                    </div>
                </div>
            </div>

            <!-- ì„¸ì…˜ ê¸°ë¡ í™”ë©´ -->
            <div id="sessions" class="screen">
                <div id="sessions-content">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“š</div>
                        <h3>ì•„ì§ ê¸°ë¡ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ì²« ë²ˆì§¸ íƒ€ë¡œ ì„¸ì…˜ì„ ì‹œì‘í•´ë³´ì„¸ìš”</p>
                    </div>
                </div>
            </div>

            <!-- ì„¤ì • í™”ë©´ -->
            <div id="settings" class="screen">
                <div class="settings-group">
                    <h3>íƒ€ì´ë¨¸ ì„¤ì •</h3>
                    <div class="setting-item">
                        <div class="setting-label">ìë™ ì‹œì‘</div>
                        <div class="setting-value">ì¼œì§</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">ì™„ë£Œ ì‹œ ì•Œë¦¼</div>
                        <div class="setting-value">ì¼œì§</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">ë°°ê²½ ìŒì•…</div>
                        <div class="setting-value">êº¼ì§</div>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>ì•± ì •ë³´</h3>
                    <div class="setting-item">
                        <div class="setting-label">ë²„ì „</div>
                        <div class="setting-value">1.0.0</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">ì œì‘ì</div>
                        <div class="setting-value">Claude Code</div>
                    </div>
                </div>

                <button class="btn secondary" onclick="clearAllSessions()">
                    ëª¨ë“  ì„¸ì…˜ ê¸°ë¡ ì‚­ì œ
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒíƒœ
        let currentSpread = null;
        let timer = null;
        let timerInterval = null;
        let startTime = null;
        let pausedTime = 0;
        let isRunning = false;
        let isPaused = false;

        // ìŠ¤í”„ë ˆë“œ ì •ë³´
        const spreads = {
            'past-present-future': {
                name: 'ê³¼ê±°-í˜„ì¬-ë¯¸ë˜',
                description: 'ì‹œê°„ì˜ íë¦„ ì†ì—ì„œ ìƒí™©ì„ íŒŒì•…í•˜ê³  ë¯¸ë˜ë¥¼ ì¤€ë¹„í•˜ì„¸ìš”',
                cards: 3,
                recommendedTime: 15 * 60, // 15ë¶„ (ì´ˆ ë‹¨ìœ„)
                emoji: 'ğŸ”®'
            },
            'love-relationship': {
                name: 'ì—°ì• ìš´',
                description: 'ì‚¬ë‘ê³¼ ê´€ê³„ì— ëŒ€í•œ ê¹Šì€ í†µì°°ì„ ì–»ì–´ë³´ì„¸ìš”',
                cards: 5,
                recommendedTime: 25 * 60,
                emoji: 'ğŸ’•'
            },
            'career-money': {
                name: 'ì§ì—…ê³¼ ê¸ˆì „ìš´',
                description: 'ì»¤ë¦¬ì–´ì™€ ì¬ì •ì— ê´€í•œ ì¡°ì–¸ì„ êµ¬í•´ë³´ì„¸ìš”',
                cards: 4,
                recommendedTime: 20 * 60,
                emoji: 'ğŸ’°'
            },
            'celtic-cross': {
                name: 'ì…€í‹± í¬ë¡œìŠ¤',
                description: 'ê°€ì¥ ì „í†µì ì´ê³  í¬ê´„ì ì¸ íƒ€ë¡œ ìŠ¤í”„ë ˆë“œ',
                cards: 10,
                recommendedTime: 45 * 60,
                emoji: 'âœ¨'
            },
            'daily-guidance': {
                name: 'ì˜¤ëŠ˜ì˜ ê°€ì´ë˜ìŠ¤',
                description: 'í•˜ë£¨ë¥¼ ì‹œì‘í•˜ê¸° ì „ í•„ìš”í•œ ì¡°ì–¸ì„ ë°›ì•„ë³´ì„¸ìš”',
                cards: 1,
                recommendedTime: 5 * 60,
                emoji: 'ğŸŒ…'
            }
        };

        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // ë„¤ë¹„ê²Œì´ì…˜ íƒ­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab));
            });

            // ìŠ¤í”„ë ˆë“œ ì¹´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.querySelectorAll('.spread-card').forEach(card => {
                card.addEventListener('click', () => selectSpread(card));
            });

            // ì €ì¥ëœ ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸°
            loadSessions();
        }

        // íƒ­ ì „í™˜
        function switchTab(clickedTab) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // í´ë¦­ëœ íƒ­ê³¼ í•´ë‹¹ í™”ë©´ í™œì„±í™”
            clickedTab.classList.add('active');
            const screenId = clickedTab.dataset.screen;
            document.getElementById(screenId).classList.add('active');

            // íŠ¹ë³„í•œ ê²½ìš° ì²˜ë¦¬
            if (screenId === 'sessions') {
                loadSessions();
            }
        }

        // ìŠ¤í”„ë ˆë“œ ì„ íƒ
        function selectSpread(card) {
            // ì´ì „ ì„ íƒ ì œê±°
            document.querySelectorAll('.spread-card').forEach(c => {
                c.classList.remove('selected');
            });

            // ìƒˆ ì„ íƒ í‘œì‹œ
            card.classList.add('selected');

            const spreadKey = card.dataset.spread;
            currentSpread = spreads[spreadKey];
            currentSpread.key = spreadKey;

            // íƒ€ì´ë¨¸ í™”ë©´ ì—…ë°ì´íŠ¸
            updateTimerScreen();

            // ì„ íƒ í›„ 1ì´ˆ ë’¤ íƒ€ì´ë¨¸ íƒ­ìœ¼ë¡œ ì „í™˜
            setTimeout(() => {
                document.querySelector('[data-screen="timer"]').click();
            }, 1000);
        }

        // íƒ€ì´ë¨¸ í™”ë©´ ì—…ë°ì´íŠ¸
        function updateTimerScreen() {
            if (!currentSpread) return;

            const timerContent = document.getElementById('timer-content');
            const totalSeconds = currentSpread.recommendedTime;

            timerContent.innerHTML = `
                <div class="timer-container">
                    <div class="current-spread">
                        <h3>${currentSpread.emoji} ${currentSpread.name}</h3>
                        <p>${currentSpread.description}</p>
                    </div>

                    <div class="timer-circle glow-effect">
                        <div class="circle-progress" id="circle-progress">
                            <div class="circle-inner">
                                <div class="timer-time" id="timer-display">
                                    ${formatTime(totalSeconds)}
                                </div>
                                <div class="timer-label">
                                    ${currentSpread.cards}ì¥ì˜ ì¹´ë“œ â€¢ ${Math.floor(totalSeconds / 60)}ë¶„
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timer-controls">
                        <button class="control-btn secondary" onclick="resetTimer()" title="ë¦¬ì…‹">
                            â¹ï¸
                        </button>
                        <button class="control-btn primary" id="play-pause-btn" onclick="toggleTimer()" title="ì‹œì‘/ì¼ì‹œì •ì§€">
                            â–¶ï¸
                        </button>
                        <button class="control-btn secondary" onclick="finishSession()" title="ì™„ë£Œ">
                            âœ…
                        </button>
                    </div>
                </div>
            `;

            resetTimer();
        }

        // íƒ€ì´ë¨¸ í† ê¸€ (ì‹œì‘/ì¼ì‹œì •ì§€)
        function toggleTimer() {
            if (!isRunning && !isPaused) {
                // ì‹œì‘
                startTimer();
            } else if (isRunning) {
                // ì¼ì‹œì •ì§€
                pauseTimer();
            } else if (isPaused) {
                // ì¬ê°œ
                resumeTimer();
            }
        }

        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            if (!currentSpread) return;

            startTime = Date.now();
            isRunning = true;
            isPaused = false;
            
            const totalSeconds = currentSpread.recommendedTime;
            let remainingTime = totalSeconds;

            // ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.getElementById('play-pause-btn').innerHTML = 'â¸ï¸';
            document.getElementById('play-pause-btn').title = 'ì¼ì‹œì •ì§€';

            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime + pausedTime) / 1000);
                remainingTime = Math.max(0, totalSeconds - elapsed);

                updateTimerDisplay(remainingTime, totalSeconds);

                if (remainingTime <= 0) {
                    completeTimer();
                }
            }, 1000);
        }

        // íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€
        function pauseTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            pausedTime += Date.now() - startTime;
            isRunning = false;
            isPaused = true;

            // ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.getElementById('play-pause-btn').innerHTML = 'â–¶ï¸';
            document.getElementById('play-pause-btn').title = 'ì¬ê°œ';
        }

        // íƒ€ì´ë¨¸ ì¬ê°œ
        function resumeTimer() {
            startTime = Date.now();
            isRunning = true;
            isPaused = false;

            const totalSeconds = currentSpread.recommendedTime;
            const elapsed = Math.floor(pausedTime / 1000);
            let remainingTime = Math.max(0, totalSeconds - elapsed);

            // ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.getElementById('play-pause-btn').innerHTML = 'â¸ï¸';
            document.getElementById('play-pause-btn').title = 'ì¼ì‹œì •ì§€';

            timerInterval = setInterval(() => {
                const currentElapsed = Math.floor((Date.now() - startTime + pausedTime) / 1000);
                remainingTime = Math.max(0, totalSeconds - currentElapsed);

                updateTimerDisplay(remainingTime, totalSeconds);

                if (remainingTime <= 0) {
                    completeTimer();
                }
            }, 1000);
        }

        // íƒ€ì´ë¨¸ ë¦¬ì…‹
        function resetTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            isRunning = false;
            isPaused = false;
            pausedTime = 0;
            startTime = null;

            if (currentSpread) {
                const totalSeconds = currentSpread.recommendedTime;
                updateTimerDisplay(totalSeconds, totalSeconds);
            }

            // ë²„íŠ¼ ë¦¬ì…‹
            const playBtn = document.getElementById('play-pause-btn');
            if (playBtn) {
                playBtn.innerHTML = 'â–¶ï¸';
                playBtn.title = 'ì‹œì‘';
            }
        }

        // íƒ€ì´ë¨¸ ì™„ë£Œ
        function completeTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            isRunning = false;
            isPaused = false;

            // ì™„ë£Œ íš¨ê³¼
            document.querySelector('.timer-circle').classList.add('mystical-pulse');
            
            // ì•Œë¦¼ (ë¸Œë¼ìš°ì €ê°€ ì§€ì›í•˜ëŠ” ê²½ìš°)
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('íƒ€ë¡œ ì„¸ì…˜ ì™„ë£Œ!', {
                    body: `${currentSpread.name} ì„¸ì…˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`,
                    icon: 'ğŸ”®'
                });
            }

            // ìë™ìœ¼ë¡œ ì„¸ì…˜ ì €ì¥
            setTimeout(() => {
                finishSession();
            }, 2000);
        }

        // ì„¸ì…˜ ì™„ë£Œ
        function finishSession() {
            if (!currentSpread) return;

            const totalTime = currentSpread.recommendedTime;
            const elapsedTime = pausedTime + (isRunning ? Date.now() - startTime : 0);
            const actualDuration = Math.floor(elapsedTime / 1000);

            // ì„¸ì…˜ ì €ì¥
            const session = {
                id: Date.now(),
                spreadKey: currentSpread.key,
                spreadName: currentSpread.name,
                totalTime: totalTime,
                actualDuration: actualDuration,
                completedAt: new Date().toISOString(),
                isCompleted: actualDuration >= totalTime
            };

            saveSession(session);
            resetTimer();

            // ì„¸ì…˜ íƒ­ìœ¼ë¡œ ì „í™˜
            document.querySelector('[data-screen="sessions"]').click();
        }

        // íƒ€ì´ë¨¸ ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        function updateTimerDisplay(remainingTime, totalTime) {
            const display = document.getElementById('timer-display');
            const progress = document.getElementById('circle-progress');
            
            if (display) {
                display.textContent = formatTime(remainingTime);
                
                // ì‹œê°„ì´ ì¤„ì–´ë“¤ìˆ˜ë¡ ìƒ‰ìƒ ë³€ê²½
                if (remainingTime < 60) {
                    display.style.color = '#ef4444'; // ë¹¨ê°„ìƒ‰
                } else if (remainingTime < 300) {
                    display.style.color = '#f59e0b'; // ì£¼í™©ìƒ‰
                } else {
                    display.style.color = 'var(--foreground)';
                }
            }

            if (progress) {
                const percentage = ((totalTime - remainingTime) / totalTime) * 360;
                progress.style.background = `conic-gradient(var(--premium-gold) ${percentage}deg, transparent ${percentage}deg)`;
            }
        }

        // ì‹œê°„ í¬ë§·íŒ…
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // ì„¸ì…˜ ì €ì¥
        function saveSession(session) {
            let sessions = JSON.parse(localStorage.getItem('tarotSessions') || '[]');
            sessions.unshift(session); // ìµœì‹ ìˆœ ì •ë ¬
            
            // ìµœëŒ€ 50ê°œ ì„¸ì…˜ë§Œ ë³´ê´€
            if (sessions.length > 50) {
                sessions = sessions.slice(0, 50);
            }
            
            localStorage.setItem('tarotSessions', JSON.stringify(sessions));
        }

        // ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSessions() {
            const sessions = JSON.parse(localStorage.getItem('tarotSessions') || '[]');
            const container = document.getElementById('sessions-content');

            if (sessions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“š</div>
                        <h3>ì•„ì§ ê¸°ë¡ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ì²« ë²ˆì§¸ íƒ€ë¡œ ì„¸ì…˜ì„ ì‹œì‘í•´ë³´ì„¸ìš”</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="sessions-list">
                    ${sessions.map(session => `
                        <div class="session-card">
                            <div class="session-header">
                                <div class="session-spread">
                                    <span class="status-indicator status-${session.isCompleted ? 'finished' : 'paused'}"></span>
                                    ${spreads[session.spreadKey]?.emoji || 'ğŸ”®'} ${session.spreadName}
                                </div>
                                <div class="session-date">
                                    ${new Date(session.completedAt).toLocaleDateString('ko-KR', {
                                        month: 'short',
                                        day: 'numeric',
                                        hour: '2-digit',
                                        minute: '2-digit'
                                    })}
                                </div>
                            </div>
                            <div class="session-duration">
                                ${formatTime(session.actualDuration)} / ${formatTime(session.totalTime)}
                                ${session.isCompleted ? 'âœ…' : 'â¸ï¸'}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // ëª¨ë“  ì„¸ì…˜ ê¸°ë¡ ì‚­ì œ
        function clearAllSessions() {
            if (confirm('ëª¨ë“  ì„¸ì…˜ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('tarotSessions');
                loadSessions();
            }
        }

        // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ íƒ€ì´ë¨¸ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
        });

        // ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™”
        document.addEventListener('touchstart', function() {}, { passive: true });
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>