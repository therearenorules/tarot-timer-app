<!DOCTYPE html>
<html lang="ko" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarot Timer App - Full Feature Demo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            /* Typography Scale */
            --text-display-large: 32px;
            --text-display-medium: 28px;
            --text-title-large: 24px;
            --text-title-medium: 20px;
            --text-title-small: 18px;
            --text-body-large: 16px;
            --text-body-medium: 14px;
            --text-body-small: 12px;
            --text-caption: 11px;
            --text-overline: 10px;
            
            /* Font Weights */
            --font-weight-regular: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            
            /* Line Heights */
            --line-height-tight: 1.2;
            --line-height-normal: 1.3;
            --line-height-relaxed: 1.4;
            --line-height-loose: 1.5;
            --line-height-extra-loose: 1.6;
        }

        /* Ïã†ÎπÑÎ°úÏö¥ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes mystical-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        
        @keyframes mystical-glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(212, 175, 55, 0.3), 0 0 40px rgba(212, 175, 55, 0.1);
            }
            50% { 
                box-shadow: 0 0 30px rgba(212, 175, 55, 0.5), 0 0 60px rgba(212, 175, 55, 0.2);
            }
        }
        
        @keyframes mystical-shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes mystical-float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(1deg); }
            66% { transform: translateY(-5px) rotate(-1deg); }
        }
        
        .animate-mystical-pulse {
            animation: mystical-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .animate-mystical-glow {
            animation: mystical-glow 3s ease-in-out infinite;
        }
        
        .animate-mystical-shimmer {
            animation: mystical-shimmer 2s ease-in-out infinite;
        }
        
        .animate-mystical-float {
            animation: mystical-float 6s ease-in-out infinite;
        }

        /* Typography Classes */
        .display-large {
            font-size: var(--text-display-large);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
        }

        .display-medium {
            font-size: var(--text-display-medium);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
        }

        .title-large {
            font-size: var(--text-title-large);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-normal);
        }

        .title-medium {
            font-size: var(--text-title-medium);
            font-weight: var(--font-weight-medium);
            line-height: var(--line-height-normal);
        }

        .title-small {
            font-size: var(--text-title-small);
            font-weight: var(--font-weight-medium);
            line-height: var(--line-height-normal);
        }

        .body-large {
            font-size: var(--text-body-large);
            font-weight: var(--font-weight-regular);
            line-height: var(--line-height-loose);
        }

        .body-medium {
            font-size: var(--text-body-medium);
            font-weight: var(--font-weight-regular);
            line-height: var(--line-height-loose);
        }

        .body-small {
            font-size: var(--text-body-small);
            font-weight: var(--font-weight-regular);
            line-height: var(--line-height-loose);
        }

        .caption {
            font-size: var(--text-caption);
            font-weight: var(--font-weight-regular);
            line-height: var(--line-height-relaxed);
        }

        .overline {
            font-size: var(--text-overline);
            font-weight: var(--font-weight-medium);
            line-height: var(--line-height-relaxed);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Mobile touch optimization */
        .touch-optimization {
            -webkit-tap-highlight-color: rgba(212, 175, 55, 0.2);
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            min-height: 44px; /* iOS accessibility guideline */
            min-width: 44px;
            touch-action: manipulation; /* Fast tap, prevents zoom on double-tap */
            transition: all 0.2s ease;
        }
        
        /* Active touch states for buttons */
        .touch-optimization:active {
            transform: scale(0.96);
            background-color: rgba(212, 175, 55, 0.15) !important;
        }
        
        /* Touch-friendly card interactions */
        .touch-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .touch-card:active {
            transform: scale(0.98);
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.4);
            border-color: rgba(212, 175, 55, 0.6);
        }
        
        /* Remove hover effects on touch-only devices */
        @media (hover: none) and (pointer: coarse) {
            .hover\\:scale-105:hover,
            .hover\\:scale-\\[1\\.02\\]:hover {
                transform: none !important;
            }
            .hover\\:animate-mystical-pulse:hover,
            .hover\\:animate-mystical-glow:hover {
                animation: none !important;
            }
            .hover\\:shadow-xl:hover,
            .hover\\:shadow-2xl:hover {
                box-shadow: none !important;
            }
            .hover\\:from-yellow-500:hover,
            .hover\\:to-yellow-600:hover {
                background: none !important;
            }
            .group:hover .group-hover\\:text-yellow-400 {
                color: inherit !important;
            }
            .group:hover .group-hover\\:opacity-100 {
                opacity: inherit !important;
            }
        }

        /* Custom scrollbar */
        .scrollbar-none {
            -ms-overflow-style: none;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }

        .scrollbar-none::-webkit-scrollbar {
            display: none;
        }

        /* Gradient text utilities */
        .text-gradient-gold {
            background: linear-gradient(135deg, #f4d03f 0%, #d4af37 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .text-gradient-mystical {
            background: linear-gradient(135deg, #f4d03f 0%, #ffffff 50%, #f4d03f 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Tab switching animation */
        .tab-content {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .demo-section {
            min-height: 60vh;
            padding: 2rem 1rem;
        }

        /* Celtic Cross Layout Styles */
        .celtic-cross {
            position: relative;
            width: 100%;
            height: 60vh; /* 100vh ‚Üí 60vhÎ°ú Î≥ÄÍ≤ΩÌïòÏó¨ ÏÉÅÌïò Î≤ÑÌäºÍ≥º Ï†úÎ™©Ïù¥ Î≥¥Ïù¥ÎèÑÎ°ù */
            max-height: 400px; /* ÏµúÎåÄ ÎÜíÏù¥ Ï†úÌïú */
            min-height: 300px; /* ÏµúÏÜå ÎÜíÏù¥ Î≥¥Ïû• */
        }

        .celtic-cross .card {
            position: absolute;
            width: 60px; /* Ïù¥Ï†Ñ ÌÅ¨Í∏∞Î°ú Î≥µÍµ¨ */
            height: 100px; /* Ïù¥Ï†Ñ ÌÅ¨Í∏∞Î°ú Î≥µÍµ¨ */
            transform: translate(-50%, -50%);
        }

        /* 4Ïó¥ Íµ¨Ï°∞: 1Ïó¥(12.5%), 2Ïó¥(37.5%), 3Ïó¥(62.5%), 4Ïó¥(87.5%) */
        /* Ïù¥Ï†Ñ ÏÑ§Ï†ïÏúºÎ°ú Î≥µÍµ¨ */
        
        /* 1Ïó¥ - Ïπ¥Îìú 5 */
        .celtic-cross .card-5 { left: 12.5%; top: 45%; }
        
        /* 2Ïó¥ - Ïπ¥Îìú 1/2/3/4 (Ï§ëÏïô ÌÅ¨Î°úÏä§) */
        .celtic-cross .card-1 { left: 37.5%; top: 45%; }
        .celtic-cross .card-2 { left: 37.5%; top: 45%; transform: translate(-50%, -50%) rotate(90deg); }
        .celtic-cross .card-3 { left: 37.5%; top: 10%; }
        .celtic-cross .card-4 { left: 37.5%; top: 75%; }
        
        /* 3Ïó¥ - Ïπ¥Îìú 6 */
        .celtic-cross .card-6 { left: 62.5%; top: 45%; }
        
        /* 4Ïó¥ - Ïπ¥Îìú 7/8/9/10 (Ïö∞Ï∏° Ïä§ÌÉúÌîÑ) */
        .celtic-cross .card-7 { left: 87.5%; top: 91%; }
        .celtic-cross .card-8 { left: 87.5%; top: 63%; }
        .celtic-cross .card-9 { left: 87.5%; top: 35%; }
        .celtic-cross .card-10 { left: 87.5%; top: 7%; }

        /* =====================================
           üéØ Enhanced Card Flip Animation System
           ===================================== */
        
        /* Ïπ¥Îìú Îí§ÏßëÍ∏∞ Ïª®ÌÖåÏù¥ÎÑà */
        .card-flip {
            perspective: 1000px;
            transform-style: preserve-3d;
        }

        /* Ïπ¥Îìú Îí§ÏßëÍ∏∞ ÎÇ¥Î∂Ä ÏöîÏÜå */
        .card-flip-inner {
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Îí§ÏßëÌûå ÏÉÅÌÉú */
        .card-flip.flipped .card-flip-inner {
            transform: rotateY(180deg);
        }

        /* Ïπ¥Îìú ÏïûÎ©¥Í≥º Îí∑Î©¥ Í≥µÌÜµ Ïä§ÌÉÄÏùº */
        .card-front, .card-back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 8px;
            overflow: hidden;
        }

        /* Ïπ¥Îìú Îí∑Î©¥ (Í∏∞Î≥∏ ÏÉÅÌÉú) */
        .card-back {
            transform: rotateY(0deg);
            background: linear-gradient(135deg, #4a1a4f 0%, #1a1f3a 50%, #4a1a4f 100%);
            border: 2px solid rgba(212, 175, 55, 0.5);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        /* Ïπ¥Îìú ÏïûÎ©¥ (Îí§ÏßëÌûå ÏÉÅÌÉúÏóêÏÑú Î≥¥ÏûÑ) */
        .card-front {
            transform: rotateY(180deg);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.5),
                0 2px 8px rgba(212, 175, 55, 0.2);
        }

        /* Î°úÎî© Ïä§ÌîºÎÑà Ïï†ÎãàÎ©îÏù¥ÏÖò Í∞úÏÑ† */
        @keyframes mystical-spin {
            0% { 
                transform: rotate(0deg) scale(1);
                opacity: 1;
            }
            50% { 
                transform: rotate(180deg) scale(1.1);
                opacity: 0.8;
            }
            100% { 
                transform: rotate(360deg) scale(1);
                opacity: 1;
            }
        }

        .mystical-spinner {
            animation: mystical-spin 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            filter: drop-shadow(0 0 8px rgba(212, 175, 55, 0.5));
        }

        /* Ïπ¥Îìú Î°úÎî© ÏÉÅÌÉú Ìö®Í≥º */
        .card-loading {
            background: linear-gradient(
                45deg,
                rgba(74, 26, 79, 0.3) 0%,
                rgba(26, 31, 58, 0.3) 25%,
                rgba(74, 26, 79, 0.3) 50%,
                rgba(26, 31, 58, 0.3) 75%,
                rgba(74, 26, 79, 0.3) 100%
            );
            background-size: 200% 200%;
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 200%;
            }
            100% {
                background-position: -200% -200%;
            }
        }

        /* Ïπ¥Îìú ÏóêÎü¨ ÏÉÅÌÉú Ìö®Í≥º */
        .card-error {
            background: linear-gradient(
                135deg,
                rgba(148, 91, 148, 0.7) 0%,
                rgba(74, 26, 79, 0.8) 50%,
                rgba(148, 91, 148, 0.7) 100%
            );
            border: 2px solid rgba(212, 175, 55, 0.3);
            backdrop-filter: blur(8px);
        }

        /* Ïπ¥Îìú ÏÑ±Í≥µ Î°úÎìú Ìö®Í≥º */
        .card-loaded {
            animation: card-reveal 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }

        @keyframes card-reveal {
            0% {
                opacity: 0;
                transform: scale(0.9) rotateY(-10deg);
                filter: blur(4px);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.05) rotateY(5deg);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateY(0deg);
                filter: blur(0px);
            }
        }

        /* ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî ÌéÑÏä§ Ìö®Í≥º */
        .placeholder-pulse {
            animation: placeholder-glow 2s ease-in-out infinite;
        }

        @keyframes placeholder-glow {
            0%, 100% {
                opacity: 0.6;
                transform: scale(1);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
                text-shadow: 0 0 20px rgba(212, 175, 55, 0.6);
            }
        }

        /* ÌÑ∞Ïπò ÎîîÎ∞îÏù¥Ïä§ÏóêÏÑú Îí§ÏßëÍ∏∞ Ìö®Í≥º ÏµúÏ†ÅÌôî */
        @media (hover: none) and (pointer: coarse) {
            .card-flip-inner {
                transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }
        }

        /* ÌîÑÎ¶¨Î°úÎî©Îêú Ïù¥ÎØ∏ÏßÄ ÌëúÏãú Ìö®Í≥º */
        .preloaded-image {
            opacity: 0;
            animation: fade-in-smooth 0.4s ease-out forwards;
        }

        @keyframes fade-in-smooth {
            0% {
                opacity: 0;
                transform: scale(0.98);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* =====================================
           üéØ Card Popup Modal Styles
           ===================================== */
        
        .card-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .card-popup-overlay.active {
            opacity: 1;
        }

        .card-popup-content {
            max-width: 90vw;
            max-height: 90vh;
            transform: scale(0.8) translateY(30px);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }

        .card-popup-overlay.active .card-popup-content {
            transform: scale(1) translateY(0);
        }

        .card-popup-image {
            max-width: 300px;
            max-height: 500px;
            border-radius: 16px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 8px 24px rgba(212, 175, 55, 0.2);
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .card-popup-close {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 40px;
            height: 40px;
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid rgba(212, 175, 55, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #d4af37;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(8px);
        }

        .card-popup-close:hover {
            background: rgba(212, 175, 55, 0.3);
            border-color: rgba(212, 175, 55, 0.8);
            transform: scale(1.1);
        }

        .card-popup-info {
            position: absolute;
            bottom: -60px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(8px);
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
    </style>
</head>
<body class="min-h-screen text-white " style="background: linear-gradient(135deg, #1a1f3a 0%, #4a1a4f 50%, #1a1f3a 100%); font-family: 'Noto Sans KR', sans-serif;">
    
    <!-- Subtle Background Effects -->
    <div class="fixed inset-0 opacity-30 pointer-events-none" style="background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.03), transparent)"></div>

    <!-- Main Container -->
    <div class="relative z-10 max-w-md mx-auto min-h-screen">
        

        <!-- Tab Navigation -->
        <div class="fixed bottom-0 left-0 right-0 z-50">
            <!-- Glow effect -->
            <div class="absolute -top-8 inset-x-0 h-8 pointer-events-none" style="background: linear-gradient(to top, rgba(26, 31, 58, 0.8), transparent)"></div>
            
            <!-- Navigation -->
            <div class="backdrop-blur-xl border-t shadow-2xl" style="background: rgba(26, 31, 58, 0.95); border-top-color: rgba(212, 175, 55, 0.2);">
                <div class="absolute inset-0 pointer-events-none" style="background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.05), transparent)"></div>
                
                <div class="container mx-auto max-w-md relative">
                    <div class="grid w-full grid-cols-4 bg-transparent border-none rounded-none h-auto p-0">
                        <!-- Timer Tab -->
                        <button id="timer-tab" class="tab-button flex flex-col items-center gap-2 p-4 rounded-none bg-transparent border-none transition-all duration-300 group hover:text-white/80 text-yellow-400 bg-yellow-400/10 touch-optimization" onclick="showTab('timer')">
                            <div class="relative">
                                <svg class="h-6 w-6 transition-all duration-300 scale-110 drop-shadow-lg" fill="currentColor" viewBox="0 0 24 24">
                                    <!-- ÌÉÄÎ°úÏπ¥Îìú Î∞∞Í≤Ω -->
                                    <rect x="4" y="2" width="16" height="20" rx="2" ry="2" fill="currentColor" opacity="0.9"/>
                                    <rect x="5" y="3" width="14" height="18" rx="1" ry="1" fill="rgba(26, 31, 58, 0.8)"/>
                                    <!-- ÏãúÍ≥Ñ ÏöîÏÜå -->
                                    <circle cx="12" cy="10" r="4" fill="none" stroke="currentColor" stroke-width="1.5"/>
                                    <polyline points="12,8 12,10 13.5,11.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
                                    <!-- ÌÉÄÎ°ú Ïû•Ïãù -->
                                    <circle cx="8" cy="17" r="1" fill="currentColor" opacity="0.6"/>
                                    <circle cx="12" cy="17" r="1" fill="currentColor" opacity="0.6"/>
                                    <circle cx="16" cy="17" r="1" fill="currentColor" opacity="0.6"/>
                                </svg>
                                <div class="absolute -inset-2 rounded-full transition-opacity blur-sm -z-10 opacity-100" style="background-color: rgba(212, 175, 55, 0.2)"></div>
                                <div class="absolute -inset-1 rounded-full transition-opacity animate-pulse -z-10 opacity-100" style="background-color: rgba(212, 175, 55, 0.3)"></div>
                            </div>
                            <span class="caption font-medium">ÌÉÄÏù¥Î®∏</span>
                            <div class="h-0.5 w-8 rounded-full transition-opacity shadow-lg opacity-100" style="background-color: #d4af37; box-shadow: 0 0 12px rgba(212, 175, 55, 0.5)"></div>
                        </button>
                        
                        <!-- Spreads Tab -->
                        <button id="spreads-tab" class="tab-button flex flex-col items-center gap-2 p-4 rounded-none bg-transparent border-none transition-all duration-300 group hover:text-white/80 text-white/60 touch-optimization" onclick="showTab('spreads')">
                            <div class="relative">
                                <svg class="h-6 w-6 transition-all duration-300" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4V4H4z"/>
                                    <path d="M10 4h4v16h-4V4z"/>
                                    <path d="M16 4h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4V4z"/>
                                    <circle cx="6" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                    <circle cx="12" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                    <circle cx="18" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                </svg>
                                <div class="absolute -inset-2 rounded-full transition-opacity blur-sm -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.2)"></div>
                                <div class="absolute -inset-1 rounded-full transition-opacity animate-pulse -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.3)"></div>
                            </div>
                            <span class="caption font-medium">Ïä§ÌîÑÎ†àÎìú</span>
                            <div class="h-0.5 w-8 rounded-full transition-opacity shadow-lg opacity-0" style="background-color: #d4af37; box-shadow: 0 0 12px rgba(212, 175, 55, 0.5)"></div>
                        </button>
                        
                        <!-- Journal Tab -->
                        <button id="journal-tab" class="tab-button flex flex-col items-center gap-2 p-4 rounded-none bg-transparent border-none transition-all duration-300 group hover:text-white/80 text-white/60 touch-optimization" onclick="showTab('journal')">
                            <div class="relative">
                                <svg class="h-6 w-6 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                </svg>
                                <div class="absolute -inset-2 rounded-full transition-opacity blur-sm -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.2)"></div>
                                <div class="absolute -inset-1 rounded-full transition-opacity animate-pulse -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.3)"></div>
                            </div>
                            <span class="caption font-medium">Îã§Ïù¥Ïñ¥Î¶¨</span>
                            <div class="h-0.5 w-8 rounded-full transition-opacity shadow-lg opacity-0" style="background-color: #d4af37; box-shadow: 0 0 12px rgba(212, 175, 55, 0.5)"></div>
                        </button>
                        
                        <!-- Settings Tab -->
                        <button id="settings-tab" class="tab-button flex flex-col items-center gap-2 p-4 rounded-none bg-transparent border-none transition-all duration-300 group hover:text-white/80 text-white/60 touch-optimization" onclick="showTab('settings')">
                            <div class="relative">
                                <svg class="h-6 w-6 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                                </svg>
                                <div class="absolute -inset-2 rounded-full transition-opacity blur-sm -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.2)"></div>
                                <div class="absolute -inset-1 rounded-full transition-opacity animate-pulse -z-10 opacity-0" style="background-color: rgba(212, 175, 55, 0.3)"></div>
                            </div>
                            <span class="caption font-medium">ÏÑ§Ï†ï</span>
                            <div class="h-0.5 w-8 rounded-full transition-opacity shadow-lg opacity-0" style="background-color: #d4af37; box-shadow: 0 0 12px rgba(212, 175, 55, 0.5)"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content Container -->
        <div class="pb-24 px-6" id="content-container">

            <!-- Timer Tab Content -->
            <div id="timer-content" class="tab-content demo-section">
                <div class="space-y-8">
                    <!-- Header -->
                    <div class="text-center space-y-4">
                        <div class="flex items-center justify-center">
                            <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="currentColor" viewBox="0 0 24 24">
                                <!-- ÌÉÄÎ°úÏπ¥Îìú Î∞∞Í≤Ω -->
                                <rect x="4" y="1" width="16" height="22" rx="2" ry="2" fill="currentColor" opacity="0.9"/>
                                <rect x="5" y="2" width="14" height="20" rx="1" ry="1" fill="rgba(26, 31, 58, 0.7)"/>
                                <!-- ÏãúÍ≥Ñ ÏöîÏÜå -->
                                <circle cx="12" cy="11" r="5" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                <polyline points="12,8 12,11 15,13" stroke="currentColor" stroke-width="1.8" fill="none"/>
                                <!-- ÌÉÄÎ°ú Ïû•Ïãù -->
                                <circle cx="8" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                                <circle cx="12" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                                <circle cx="16" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                            </svg>
                        </div>
                        <h1 class="display-large text-gradient-mystical">Tarot Timer</h1>
                        <p class="body-small text-white/70">24ÏãúÍ∞Ñ ÌÉÄÎ°ú Ïó¨Ï†ïÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî</p>
                    </div>

                    <!-- Initial State: Before Drawing Cards -->
                    <div id="initial-state" class="space-y-8">
                        <div class="text-center space-y-4">
                            <div class="bg-white/5 border border-white/10 rounded-2xl p-8 space-y-6">
                                <div class="space-y-3">
                                    <svg class="h-16 w-16 mx-auto text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4V4H4z"/>
                                        <path d="M10 4h4v16h-4V4z"/>
                                        <path d="M16 4h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4V4z"/>
                                        <circle cx="6" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                        <circle cx="12" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                        <circle cx="18" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                    </svg>
                                    <h2 class="title-large text-white">24ÏãúÍ∞ÑÏùò Ïã†ÎπÑÎ°úÏö¥ Ïó¨Ï†ï</h2>
                                    <p class="body-medium text-white/70 max-w-sm mx-auto">
                                        ÌïòÎ£® 24ÏãúÍ∞Ñ, Í∞Å ÏãúÍ∞ÑÎßàÎã§Ïùò ÌäπÎ≥ÑÌïú Î©îÏãúÏßÄÎ•º Îã¥ÏùÄ ÌÉÄÎ°úÏπ¥ÎìúÎ•º ÎΩëÏïÑÎ≥¥ÏÑ∏Ïöî.
                                    </p>
                                </div>
                                
                                <button id="draw-cards-btn" onclick="drawDailyCards()" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-semibold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 animate-mystical-pulse">
                                    24ÏãúÍ∞Ñ ÌÉÄÎ°ú ÎΩëÍ∏∞
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Cards Drawn State: After Drawing Cards -->
                    <div id="cards-drawn-state" class="space-y-8 hidden">

                        <!-- New Current Time Header Design -->
                        <div class="text-center space-y-3">
                            <div class="flex items-center justify-center space-x-3">
                                <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12,6 12,12 16,14"></polyline>
                                </svg>
                                <div class="title-medium text-white" id="current-time">Ïò§ÌõÑ 2:30</div>
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                            </div>
                            <p class="body-small text-white/70">ÌòÑÏû¨ ÏãúÍ∞ÑÏùò ÌÉÄÎ°úÏπ¥Îìú</p>
                        </div>

                    <!-- Current Card Display -->
                    <div class="relative">
                        <div class="absolute -inset-4 bg-gradient-to-r from-yellow-400/20 via-transparent to-yellow-400/20 blur-2xl rounded-3xl"></div>
                        <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl rounded-2xl p-6 space-y-6">
                            <!-- Card Image -->
                            <div class="flex justify-center">
                                <div class="relative">
                                    <div class="absolute -inset-2 bg-yellow-400/30 blur-xl rounded-2xl"></div>
                                    <div class="relative w-48 h-80 rounded-2xl overflow-hidden shadow-2xl border-2 border-yellow-400/50 animate-mystical-float">
                                        <img src="assets/tarot-cards/classic-tarot/major_17_star.jpg" alt="ÌÉÄÎ°ú Ïπ¥Îìú" class="w-full h-full object-cover transition-all duration-500">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card Name Below Image -->
                            <div class="text-center">
                                <h3 id="current-card-name" class="title-medium text-white">The Star</h3>
                            </div>
                            
                            <!-- Card Details -->
                            <div class="text-center space-y-4 p-4 bg-white/5 rounded-xl border border-white/10">
                                <div class="flex flex-wrap justify-center gap-2">
                                    <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors border-yellow-400/40 text-yellow-400 bg-yellow-400/10">Ìù¨Îßù</span>
                                    <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors border-yellow-400/40 text-yellow-400 bg-yellow-400/10">ÏòÅÍ∞ê</span>
                                    <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors border-yellow-400/40 text-yellow-400 bg-yellow-400/10">ÏπòÏú†</span>
                                </div>
                                <p class="body-medium text-white/90 leading-relaxed max-w-sm mx-auto">
                                    Ïñ¥Îë† ÏÜçÏóêÏÑúÎèÑ Ìù¨ÎßùÏùò ÎπõÏùÑ Ï∞æÎäî ÏãúÍ∞ÑÏûÖÎãàÎã§. ÎÇ¥Î©¥Ïùò ÌèâÌôîÏôÄ ÏòÅÏ†ÅÏù∏ ÏπòÏú†Í∞Ä ÌïÑÏöîÌïú ÏàúÍ∞ÑÏù¥ÏóêÏöî.
                                </p>
                            </div>
                            
                            <!-- Current Time Memo Area -->
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                        </svg>
                                        <h3 class="title-small text-white">Î©îÎ™®</h3>
                                    </div>
                                    <button 
                                        onclick="saveCurrentTimeMemo()" 
                                        class="flex items-center gap-1 px-2 py-0.5 text-xs rounded-md bg-yellow-400/10 border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/20 transition-all duration-300 touch-optimization"
                                    >
                                        <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                        Ï†ÄÏû•
                                    </button>
                                </div>
                                <textarea 
                                    id="current-time-memo" 
                                    placeholder="Ïù¥ ÏãúÍ∞ÑÏóê ÎåÄÌïú ÏÉùÍ∞ÅÏù¥ÎÇò ÎäêÎÇåÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî..."
                                    class="w-full h-24 p-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/50 body-small resize-none focus:outline-none focus:border-yellow-400/50 focus:bg-white/10 transition-all">
                                </textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 24-Hour Cards Section -->
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <h2 class="title-medium text-white flex items-center gap-2">
                                <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12,6 12,12 16,14"></polyline>
                                </svg>
                                24ÏãúÍ∞Ñ ÏóêÎÑàÏßÄ ÌùêÎ¶Ñ
                            </h2>
                            <button onclick="redrawCards()" class="flex items-center px-3 py-0.5 text-sm rounded-lg border border-yellow-400/30 text-yellow-400 bg-yellow-400/5 hover:bg-yellow-400/10 transition-all duration-300 touch-optimization">
                                <svg class="h-3 w-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                Îã§Ïãú ÎΩëÍ∏∞
                            </button>
                        </div>
                        
                        <!-- Horizontal scroll of 24 cards -->
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 w-8 bg-gradient-to-r pointer-events-none z-10" style="background: linear-gradient(to right, #1a1f3a, transparent)"></div>
                            <div class="absolute inset-y-0 right-0 w-8 bg-gradient-to-l pointer-events-none z-10" style="background: linear-gradient(to left, #1a1f3a, transparent)"></div>
                            
                            <div class="overflow-x-auto pb-2 scrollbar-none">
                                <div class="flex gap-3 px-4" style="width: max-content">
                                    <!-- Sample 24-hour cards -->
                                    <!-- 24ÏãúÍ∞Ñ Ï†ÑÏ≤¥ Ïπ¥Îìú (0Ïãú-23Ïãú) -->
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(0)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_00_fool.jpg" alt="0Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏûêÏ†ï</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(1)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_01_magician.jpg" alt="1Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏÉàÎ≤Ω 1Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(2)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_02_high_priestess.jpg" alt="2Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏÉàÎ≤Ω 2Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(3)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_03_empress.jpg" alt="3Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏÉàÎ≤Ω 3Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(4)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_04_emperor.jpg" alt="4Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏÉàÎ≤Ω 4Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(5)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_05_hierophant.jpg" alt="5Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">ÏÉàÎ≤Ω 5Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(6)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_06_lovers.jpg" alt="6Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 6Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(7)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_07_chariot.jpg" alt="7Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 7Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(8)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_08_strength.jpg" alt="8Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 8Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(9)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_09_hermit.jpg" alt="9Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 9Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(10)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_10_wheel_of_fortune.jpg" alt="10Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 10Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(11)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_11_justice.jpg" alt="11Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§Ï†Ñ 11Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(12)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_12_hanged_man.jpg" alt="12Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ï†ïÏò§</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(13)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_13_death.jpg" alt="13Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 1Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(14)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_14_temperance.jpg" alt="14Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 2Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(15)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_15_devil.jpg" alt="15Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 3Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(16)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_16_tower.jpg" alt="16Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 4Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(17)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_17_star.jpg" alt="17Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 5Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(18)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_18_moon.jpg" alt="18Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 6Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(19)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_19_sun.jpg" alt="19Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 7Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(20)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_20_judgement.jpg" alt="20Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 8Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(21)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/major_21_world.jpg" alt="21Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 9Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(22)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/minor_cups_ace.jpg" alt="22Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 10Ïãú</p>
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 touch-optimization cursor-pointer p-2" onclick="selectCard(23)">
                                        <div class="text-center space-y-2">
                                            <div class="relative w-14 h-22 rounded-lg overflow-hidden shadow-lg transition-all duration-300">
                                                <img src="assets/tarot-cards/classic-tarot/minor_cups_two.jpg" alt="23Ïãú" class="w-full h-full object-cover">
                                            </div>
                                            <p class="caption text-white/70">Ïò§ÌõÑ 11Ïãú</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Save Button -->
                    <div class="relative">
                        <div class="absolute -inset-1 bg-gradient-to-r from-yellow-400/40 to-yellow-500/40 blur-lg rounded-xl"></div>
                        <button onclick="saveDailyTarot()" class="relative w-full py-4 text-lg font-bold transition-all duration-500 bg-gradient-to-r from-yellow-400 to-yellow-500 text-black hover:from-yellow-500 hover:to-yellow-600 shadow-2xl shadow-yellow-400/30 hover:animate-mystical-glow rounded-xl touch-optimization">
                            <svg class="h-5 w-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                            </svg>
                            Îç∞ÏùºÎ¶¨ ÌÉÄÎ°ú Ï†ÄÏû•ÌïòÍ∏∞
                        </button>
                    </div>
                    </div>
                    <!-- End of Cards Drawn State -->

                </div>
            </div>

            <!-- Spreads Tab Content -->
            <div id="spreads-content" class="tab-content demo-section hidden">
                <div class="space-y-8">
                    <!-- Header Section -->
                    <div class="text-center space-y-4">
                        <div class="flex items-center justify-center">
                            <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4V4H4z"/>
                                <path d="M10 4h4v16h-4V4z"/>
                                <path d="M16 4h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4V4z"/>
                                <circle cx="6" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                <circle cx="12" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                <circle cx="18" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                            </svg>
                        </div>
                        <h1 class="display-large text-gradient-mystical">Spreads</h1>
                        <p class="body-small text-white/70">Îã§ÏñëÌïú ÏÉÅÌô©Ïóê ÎßûÎäî ÌÉÄÎ°ú Ïä§ÌîÑÎ†àÎìúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                    </div>
                    
                    <!-- Spreads List -->
                    <div class="space-y-6">

                    <!-- Spread Cards -->
                    <div class="space-y-6">
                        <!-- 1Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú - Îπ†Î•∏ ÎΩëÍ∏∞ (Í∏∞Î≥∏) -->
                        <div class="relative mb-6" onclick="startSpreadReading('one-card')">
                            <!-- Glow Effect Background -->
                            <div class="absolute -inset-2 bg-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl rounded-2xl p-6 cursor-pointer group hover:bg-white/15 transition-all duration-300">
                                <!-- Header with icon and title -->
                                <div class="flex items-start mb-3">
                                    <div class="mr-3 mt-0.5">
                                        <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                            <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
                                        </svg>
                                    </div>
                                    <div class="flex-1 flex items-center justify-between">
                                        <h3 class="text-xl font-semibold text-white group-hover:text-yellow-400 transition-colors">1Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú - Îπ†Î•∏ ÎΩëÍ∏∞</h3>
                                        <span class="inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-semibold bg-blue-500/20 text-blue-400 border-blue-400/30">
                                            Í∏∞Î≥∏
                                        </span>
                                    </div>
                                </div>
                                
                                <!-- Subtitle -->
                                <p class="text-xs text-yellow-400/80 mb-4">One Card Quick Draw</p>
                                
                                <!-- Description Box -->
                                <div class="p-4 bg-black/20 rounded-xl border border-white/10 mb-5">
                                    <p class="text-sm text-white/90 leading-relaxed">1Ïû•Ïùò Ïπ¥ÎìúÎ•º ÏÇ¨Ïö©ÌïòÎäî beginner Î†àÎ≤® Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                
                                <!-- Start Button -->
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-500 hover:to-yellow-600 transition-all duration-300 shadow-lg shadow-yellow-400/20 group-hover:shadow-yellow-400/30 flex items-center justify-center gap-2">
                                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- 3Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú (Í∏∞Î≥∏) -->
                        <div class="relative mb-6" onclick="startSpreadReading('three-card')">
                            <!-- Glow Effect Background -->
                            <div class="absolute -inset-2 bg-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl rounded-2xl p-6 cursor-pointer group hover:bg-white/15 transition-all duration-300">
                                <!-- Header with icon and title -->
                                <div class="flex items-start mb-3">
                                    <div class="mr-3 mt-0.5">
                                        <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                            <line x1="9" y1="9" x2="15" y2="15"></line>
                                            <line x1="15" y1="9" x2="9" y2="15"></line>
                                        </svg>
                                    </div>
                                    <div class="flex-1 flex items-center justify-between">
                                        <h3 class="text-xl font-semibold text-white group-hover:text-yellow-400 transition-colors">3Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú</h3>
                                        <span class="inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-semibold bg-blue-500/20 text-blue-400 border-blue-400/30">
                                            Í∏∞Î≥∏
                                        </span>
                                    </div>
                                </div>
                                
                                <!-- Subtitle -->
                                <p class="text-xs text-yellow-400/80 mb-4">Three Card Spread</p>
                                
                                <!-- Description Box -->
                                <div class="p-4 bg-black/20 rounded-xl border border-white/10 mb-5">
                                    <p class="text-sm text-white/90 leading-relaxed">3Ïû•Ïùò Ïπ¥ÎìúÎ•º ÏÇ¨Ïö©ÌïòÎäî beginner Î†àÎ≤® Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                
                                <!-- Start Button -->
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-500 hover:to-yellow-600 transition-all duration-300 shadow-lg shadow-yellow-400/20 group-hover:shadow-yellow-400/30 flex items-center justify-center gap-2">
                                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- 5Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú (Í∏∞Î≥∏) -->
                        <div class="relative group" onclick="startSpreadReading('five-card')">
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/20 via-transparent to-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl touch-card rounded-2xl p-6 space-y-4 cursor-pointer">
                                <div class="flex items-start justify-between">
                                    <div class="space-y-2 flex-1">
                                        <div class="flex items-center gap-3">
                                            <div class="relative">
                                                <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <polygon points="12,2 22,8.5 17.5,20 6.5,20 2,8.5"></polygon>
                                                </svg>
                                            </div>
                                            <h3 class="title-medium text-white group-hover:text-yellow-400 transition-colors">5Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú</h3>
                                            <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold bg-blue-500/20 text-blue-400 border-blue-400/30">
                                                Í∏∞Î≥∏
                                            </span>
                                        </div>
                                        <p class="body-small text-yellow-400/80">Five Card V-Shape</p>
                                    </div>
                                </div>
                                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                                    <p class="body-small text-white/90 leading-relaxed">Ï¢ÖÌï©Ï†ÅÏù∏ ÏïàÎÇ¥Î•º ÏúÑÌïú VÏûê ÌòïÌÉúÏùò 5Ïû• Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 text-base hover:from-yellow-500 hover:to-yellow-600 transition-all duration-500 shadow-2xl shadow-yellow-400/20 group-hover:shadow-yellow-400/30 rounded-xl touch-optimization">
                                    <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- 4Ïπ¥Îìú ÏãúÍ∞ÑÏÑ† (Í∏∞Î≥∏) -->
                        <div class="relative group" onclick="startSpreadReading('four-card-timeline')">
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/20 via-transparent to-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl touch-card rounded-2xl p-6 space-y-4 cursor-pointer">
                                <div class="flex items-start justify-between">
                                    <div class="space-y-2 flex-1">
                                        <div class="flex items-center gap-3">
                                            <div class="relative">
                                                <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <line x1="3" y1="12" x2="21" y2="12"></line>
                                                    <line x1="3" y1="6" x2="3" y2="18"></line>
                                                    <line x1="9" y1="6" x2="9" y2="18"></line>
                                                    <line x1="15" y1="6" x2="15" y2="18"></line>
                                                    <line x1="21" y1="6" x2="21" y2="18"></line>
                                                </svg>
                                            </div>
                                            <h3 class="title-medium text-white group-hover:text-yellow-400 transition-colors">4Ïπ¥Îìú ÏãúÍ∞ÑÏÑ†</h3>
                                            <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold bg-blue-500/20 text-blue-400 border-blue-400/30">
                                                Í∏∞Î≥∏
                                            </span>
                                        </div>
                                        <p class="body-small text-yellow-400/80">Four Card Timeline</p>
                                    </div>
                                </div>
                                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                                    <p class="body-small text-white/90 leading-relaxed">ÏãúÍ∞ÑÏùò ÌùêÎ¶ÑÏóê Îî∞Î•∏ ÏÉÅÌô© Î≥ÄÌôîÎ•º Î≥¥Îäî 4Ïû• ÏãúÍ∞ÑÏÑ† Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 text-base hover:from-yellow-500 hover:to-yellow-600 transition-all duration-500 shadow-2xl shadow-yellow-400/20 group-hover:shadow-yellow-400/30 rounded-xl touch-optimization">
                                    <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- ÏºàÌã± ÌÅ¨Î°úÏä§ (ÌîÑÎ¶¨ÎØ∏ÏóÑ) -->
                        <div class="relative group" onclick="startSpreadReading('celtic-cross')">
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/20 via-transparent to-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl touch-card rounded-2xl p-6 space-y-4 cursor-pointer">
                                <div class="flex items-start justify-between">
                                    <div class="space-y-2 flex-1">
                                        <div class="flex items-center gap-3">
                                            <div class="relative">
                                                <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                                </svg>
                                            </div>
                                            <h3 class="title-medium text-white group-hover:text-yellow-400 transition-colors">ÏºàÌã± ÌÅ¨Î°úÏä§</h3>
                                            <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold bg-gradient-to-r from-yellow-400 to-yellow-500 text-black border-none shadow-lg gap-1">
                                                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                                                </svg>
                                                ÌîÑÎ¶¨ÎØ∏ÏóÑ
                                            </span>
                                        </div>
                                        <p class="body-small text-yellow-400/80">Celtic Cross</p>
                                    </div>
                                </div>
                                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                                    <p class="body-small text-white/90 leading-relaxed">Î≥µÏû°Ìïú ÏÉÅÌô©Ïóê ÎåÄÌïú ÍπäÏù¥ ÏûàÎäî ÌÜµÏ∞∞ÏùÑ Ï†úÍ≥µÌïòÎäî 10Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 text-base hover:from-yellow-500 hover:to-yellow-600 transition-all duration-500 shadow-2xl shadow-yellow-400/20 group-hover:shadow-yellow-400/30 rounded-xl touch-optimization">
                                    <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- Ïªµ Ïò§Î∏å Î¶¥Î†àÏù¥ÏÖòÏã≠ (ÌîÑÎ¶¨ÎØ∏ÏóÑ) -->
                        <div class="relative mb-6" onclick="startSpreadReading('cup-of-relationship')">
                            <!-- Premium Glow Effect Background -->
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/30 to-yellow-500/30 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            
                            <div class="relative bg-white/10 backdrop-blur-lg border border-yellow-400/30 shadow-2xl rounded-2xl p-6 cursor-pointer group hover:bg-white/15 transition-all duration-300">
                                <!-- Header with icon and title -->
                                <div class="flex items-start mb-3">
                                    <div class="mr-3 mt-0.5">
                                        <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                            <path d="M12 2c-4.418 0-8 2.686-8 6 0 4.418 8 14 8 14s8-9.582 8-14c0-3.314-3.582-6-8-6z"/>
                                            <circle cx="12" cy="8" r="3"/>
                                        </svg>
                                    </div>
                                    <div class="flex-1 flex items-center justify-between">
                                        <h3 class="text-xl font-semibold text-white group-hover:text-yellow-400 transition-colors">Ïªµ Ïò§Î∏å Î¶¥Î†àÏù¥ÏÖòÏã≠</h3>
                                        <span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold bg-gradient-to-r from-yellow-400 to-yellow-500 text-black shadow-lg gap-1">
                                            <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                                            </svg>
                                            ÌîÑÎ¶¨ÎØ∏ÏóÑ
                                        </span>
                                    </div>
                                </div>
                                
                                <!-- Subtitle -->
                                <p class="text-xs text-yellow-400/80 mb-4">Cup of Relationship</p>
                                
                                <!-- Description Box -->
                                <div class="p-4 bg-black/20 rounded-xl border border-white/10 mb-5">
                                    <p class="text-sm text-white/90 leading-relaxed">7Ïû•Ïùò Ïπ¥ÎìúÎ•º ÏÇ¨Ïö©ÌïòÎäî intermediate Î†àÎ≤® Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                
                                <!-- Start Button -->
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-500 hover:to-yellow-600 transition-all duration-300 shadow-lg shadow-yellow-400/20 group-hover:shadow-yellow-400/30 flex items-center justify-center gap-2">
                                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- ABÏÑ†ÌÉù Ïä§ÌîÑÎ†àÎìú (ÌîÑÎ¶¨ÎØ∏ÏóÑ) -->
                        <div class="relative group" onclick="startSpreadReading('ab-choice')">
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/20 via-transparent to-yellow-400/20 blur-xl rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <div class="relative bg-white/10 backdrop-blur-lg border border-white/20 shadow-2xl touch-card rounded-2xl p-6 space-y-4 cursor-pointer">
                                <div class="flex items-start justify-between">
                                    <div class="space-y-2 flex-1">
                                        <div class="flex items-center gap-3">
                                            <div class="relative">
                                                <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                </svg>
                                            </div>
                                            <h3 class="title-medium text-white group-hover:text-yellow-400 transition-colors">ABÏÑ†ÌÉù Ïä§ÌîÑÎ†àÎìú</h3>
                                            <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold bg-gradient-to-r from-yellow-400 to-yellow-500 text-black border-none shadow-lg gap-1">
                                                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                                                </svg>
                                                ÌîÑÎ¶¨ÎØ∏ÏóÑ
                                            </span>
                                        </div>
                                        <p class="body-small text-yellow-400/80">AB Choice Spread</p>
                                    </div>
                                </div>
                                <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                                    <p class="body-small text-white/90 leading-relaxed">Îëê Í∞ÄÏßÄ Ï§ëÏöîÌïú ÏÑ†ÌÉùÏßÄÎ•º ÎπÑÍµê Î∂ÑÏÑùÌïòÎäî 7Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìúÏûÖÎãàÎã§.</p>
                                </div>
                                <button class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 text-base hover:from-yellow-500 hover:to-yellow-600 transition-all duration-500 shadow-2xl shadow-yellow-400/20 group-hover:shadow-yellow-400/30 rounded-xl touch-optimization">
                                    <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                                    </svg>
                                    Î¶¨Îî© ÏãúÏûë
                                </button>
                            </div>
                        </div>

                        <!-- Premium Section -->
                        <div class="relative">
                            <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400/30 to-yellow-500/30 blur-xl rounded-2xl"></div>
                            <div class="relative bg-white/10 backdrop-blur-lg border border-yellow-400/30 shadow-2xl rounded-2xl p-6 text-center space-y-4">
                                <div class="space-y-3">
                                    <div class="flex items-center justify-center">
                                        <div class="relative">
                                            <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                                            </svg>
                                            <div class="absolute inset-0 bg-yellow-400/30 blur-lg rounded-full"></div>
                                        </div>
                                    </div>
                                    <h3 class="title-large text-white">ÌîÑÎ¶¨ÎØ∏ÏóÑ Ïä§ÌîÑÎ†àÎìú</h3>
                                    <p class="body-medium text-white/70 leading-relaxed">Îçî ÍπäÍ≥† Ï†ïÌôïÌïú ÌÉÄÎ°ú Î¶¨Îî©ÏùÑ Í≤ΩÌóòÌï¥Î≥¥ÏÑ∏Ïöî</p>
                                </div>
                                <div class="flex justify-center">
                                    <span class="inline-flex items-center rounded-full px-4 py-2 bg-gradient-to-r from-yellow-400 to-yellow-500 text-black gap-2">
                                        <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                        </svg>
                                        ÌôúÏÑ±ÌôîÎê®
                                    </span>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Journal Tab Content -->
            <div id="journal-content" class="tab-content demo-section hidden">
                <div class="space-y-8">
                    <div class="text-center space-y-4">
                        <div class="flex items-center justify-center">
                            <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                            </svg>
                        </div>
                        <h1 class="display-large text-gradient-mystical">Diary</h1>
                        <p class="body-small text-white/70">ÎãπÏã†Ïùò ÌÉÄÎ°ú Ïó¨Ï†ïÏùÑ Í∏∞Î°ùÌïòÍ≥† ÎêòÎèåÏïÑÎ≥¥ÏÑ∏Ïöî</p>
                    </div>

                    <!-- Section Toggle -->
                    <div class="flex bg-white/5 rounded-xl p-1 border border-white/10">
                        <button id="daily-btn" class="flex-1 py-3 px-4 rounded-lg body-small font-medium transition-all duration-300 bg-yellow-400 text-black shadow-lg touch-optimization" onclick="showJournalSection('daily')">
                            Îç∞ÏùºÎ¶¨ ÌÉÄÎ°úÏùºÍ∏∞
                        </button>
                        <button id="spreads-btn" class="flex-1 py-3 px-4 rounded-lg body-small font-medium transition-all duration-300 text-white/70 hover:text-white touch-optimization" onclick="showJournalSection('spreads')">
                            Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù
                        </button>
                    </div>

                    <!-- Daily Tarot Section -->
                    <div id="daily-section">
                        <div class="space-y-6">
                            <div class="flex items-center justify-between">
                                <h2 class="title-medium text-white flex items-center gap-2">
                                    <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12,6 12,12 16,14"></polyline>
                                    </svg>
                                    Îç∞ÏùºÎ¶¨ ÌÉÄÎ°úÏùºÍ∏∞
                                </h2>
                                <span id="diary-count" class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">0Í∞ú Í∏∞Î°ù</span>
                            </div>
                            
                            <!-- Daily Diary Entry -->
                            <div id="daily-diary-list" class="space-y-4">
                                <!-- Sample diary entry -->
                                <div class="bg-white/5 border border-white/10 touch-card rounded-2xl p-5 space-y-4">
                                    <div class="flex items-start justify-between">
                                        <!-- ÎÇ†Ïßú -->
                                        <div class="flex items-center gap-2">
                                            <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                                <line x1="3" y1="10" x2="21" y2="10"></line>
                                            </svg>
                                            <span class="body-medium text-white">2025ÎÖÑ 1Ïõî 4Ïùº Í∏àÏöîÏùº</span>
                                        </div>
                                        <!-- Ï†ÄÏû•Îê® ÌëúÏãú -->
                                        <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">${record.spreadType}</span>
                                    </div>
                                    
                                    <!-- 24ÏãúÍ∞Ñ Ïπ¥ÎìúÎì§ -->
                                    <div class="flex gap-1 overflow-x-auto pb-2 scrollbar-none">
                                        <div class="flex-shrink-0 w-7 h-12 rounded overflow-hidden border border-yellow-400/30 shadow-lg relative">
                                            <img src="assets/tarot-cards/classic-tarot/major_19_sun.jpg" alt="Ïπ¥Îìú" class="w-full h-full object-cover">
                                            <!-- Î©îÎ™® ÏûàÏùÑ Îïå Î≥Ñ ÌëúÏãú -->
                                            <div class="absolute top-0 right-0 w-2 h-2 bg-yellow-400 rounded-full flex items-center justify-center">
                                                <svg class="w-1 h-1 text-black" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0 w-7 h-12 rounded overflow-hidden border border-yellow-400/30 shadow-lg">
                                            <img src="assets/tarot-cards/classic-tarot/major_18_moon.jpg" alt="Ïπ¥Îìú" class="w-full h-full object-cover">
                                        </div>
                                        <div class="flex-shrink-0 w-7 h-12 rounded overflow-hidden border border-yellow-400/30 shadow-lg relative">
                                            <img src="assets/tarot-cards/classic-tarot/major_21_world.jpg" alt="Ïπ¥Îìú" class="w-full h-full object-cover">
                                            <!-- Î©îÎ™® ÏûàÏùÑ Îïå Î≥Ñ ÌëúÏãú -->
                                            <div class="absolute top-0 right-0 w-2 h-2 bg-yellow-400 rounded-full flex items-center justify-center">
                                                <svg class="w-1 h-1 text-black" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0 w-7 h-12 rounded bg-white/10 border border-white/20 flex items-center justify-center">
                                            <span class="text-xs text-white/60">+21</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Î©îÎ™® Í∞úÏàòÏôÄ Î≥¥Í∏∞ Î≤ÑÌäº -->
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <svg class="h-3 w-3 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                            </svg>
                                            <span class="caption text-yellow-400">4Í∞ú ÏãúÍ∞ÑÎåÄ Î©îÎ™®</span>
                                        </div>
                                        <button onclick="viewDailyDiary('2025-01-04')" class="px-3 py-0.5 text-sm rounded-lg border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10 transition-all duration-300 touch-optimization">
                                            Î≥¥Í∏∞
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Spreads Section (hidden by default) -->
                    <div id="spreads-section" class="hidden">
                        <div class="space-y-6">
                            <div class="flex items-center justify-between">
                                <h2 class="title-medium text-white flex items-center gap-2">
                                    <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="9" y1="9" x2="15" y2="15"></line>
                                        <line x1="15" y1="9" x2="9" y2="15"></line>
                                    </svg>
                                    Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù
                                </h2>
                                <span id="spread-count" class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">0Í∞ú Í∏∞Î°ù</span>
                            </div>
                            
                            <!-- Dynamic Spread Records List -->
                            <div id="spread-records-list" class="space-y-4">
                                <!-- Dynamic content will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab Content -->
            <div id="settings-content" class="tab-content demo-section hidden">
                <div class="space-y-8">
                    <div class="text-center space-y-4">
                        <div class="flex items-center justify-center">
                            <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                        </div>
                        <h1 class="display-large text-gradient-mystical">Setting</h1>
                        <p class="body-small text-white/70">Îã§ÏñëÌïú Í∏∞Îä•ÏùÑ ÏÑ§Ï†ïÌï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>

                    <!-- Premium Membership -->
                    <div class="bg-white/5 border border-yellow-400/30 rounded-2xl p-6 space-y-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <svg class="h-6 w-6 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                                </svg>
                                <div>
                                    <h3 class="title-small text-white">ÌîÑÎ¶¨ÎØ∏ÏóÑ Î©§Î≤ÑÏã≠</h3>
                                    <p class="body-small text-white/60">ÌôúÏÑ±Ìôî</p>
                                </div>
                            </div>
                            <span class="inline-flex items-center rounded-full px-3 py-1 bg-gradient-to-r from-yellow-400 to-yellow-500 text-black text-xs font-semibold">ÌôúÏÑ±Ìôî</span>
                        </div>
                        
                        <div class="space-y-3 pl-9">
                            <div class="flex items-center gap-2 body-small text-white/80">
                                <div class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></div>
                                ÌîÑÎ¶¨ÎØ∏ÏóÑ Ïä§ÌîÑÎ†àÎìú
                            </div>
                            <div class="flex items-center gap-2 body-small text-white/80">
                                <div class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></div>
                                Í¥ëÍ≥† ÏóÜÏùå
                            </div>
                            <div class="flex items-center gap-2 body-small text-white/80">
                                <div class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></div>
                                Î¨¥Ï†úÌïú Ï†ÄÏû•
                            </div>
                        </div>
                    </div>

                    <!-- Display & Theme -->
                    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 space-y-6">
                        <h3 class="title-small text-white flex items-center gap-2">
                            <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                            ÎîîÏä§ÌîåÎ†àÏù¥ & ÌÖåÎßà
                        </h3>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="body-medium text-white">Îã§ÌÅ¨ Î™®Îìú</p>
                                    <p class="body-small text-white/60">Ïã†ÎπÑÎ°úÏö¥ Í≤ΩÌóòÏùÑ ÏúÑÌï¥ Ìï≠ÏÉÅ ÏºúÏßê</p>
                                </div>
                                <!-- Toggle Switch (always on) -->
                                <div class="w-10 h-6 bg-yellow-400 rounded-full relative">
                                    <div class="w-4 h-4 bg-black rounded-full absolute top-1 right-1 transition-all duration-300"></div>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="body-medium text-white">Ïñ∏Ïñ¥</p>
                                    <p class="body-small text-white/60">ÌïúÍµ≠Ïñ¥</p>
                                </div>
                                <button class="flex items-center px-3 py-1 text-sm rounded-lg border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10 transition-all duration-300 touch-optimization">
                                    <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="2" y1="12" x2="22" y2="12"></line>
                                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                    </svg>
                                    EN
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications -->
                    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 space-y-6">
                        <h3 class="title-small text-white flex items-center gap-2">
                            <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                            </svg>
                            ÏïåÎ¶º
                        </h3>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="body-medium text-white">Ïä§ÌîÑÎ†àÎìú ÏôÑÎ£å</p>
                                    <p class="body-small text-white/60">ÌÉÄÎ°ú Î¶¨Îî©Ïù¥ ÏôÑÎ£åÎêòÎ©¥ ÏïåÎ¶ºÏùÑ Î∞õÏäµÎãàÎã§</p>
                                </div>
                                <div class="w-10 h-6 bg-yellow-400 rounded-full relative">
                                    <div class="w-4 h-4 bg-black rounded-full absolute top-1 right-1 transition-all duration-300"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Version Info -->
                    <div class="text-center space-y-2 py-6">
                        <p class="body-small text-white/60">Î≤ÑÏ†Ñ 1.0.0</p>
                        <p class="caption text-white/40">¬© 2025 Tarot Timer. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mystical Quote -->
        <div class="text-center p-6 bg-white/5 rounded-xl border border-white/10 backdrop-blur-sm mx-6 mb-6">
            <p class="text-white/80 italic leading-relaxed body-small">
                "Î≥ÑÎì§Ïù¥ ÏÜçÏÇ≠Ïù¥Îäî ÎπÑÎ∞ÄÏùÑ Îì§Ïñ¥Î≥¥ÏÑ∏Ïöî. ÎãπÏã†Ïùò Ïö¥Î™ÖÏù¥ ÌéºÏ≥êÏßëÎãàÎã§."
            </p>
        </div>
    </div>

    <!-- Card Popup Modal -->
    <div id="cardPopupOverlay" class="card-popup-overlay" onclick="closeCardPopup()">
        <div class="card-popup-content" onclick="event.stopPropagation()">
            <button class="card-popup-close" onclick="closeCardPopup()">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <img id="cardPopupImage" class="card-popup-image" src="" alt="">
            <div class="card-popup-info">
                <div id="cardPopupName" class="title-medium text-yellow-400 mb-1"></div>
                <div id="cardPopupPosition" class="body-small text-white/70"></div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Check if spread interface is currently active and reset it
            const timerContent = document.getElementById('timer-content');
            const hasSpreadInterface = timerContent && timerContent.querySelector('[data-spread-id]');
            
            if (hasSpreadInterface) {
                // Reset to normal timer content
                resetTimerContent();
            }

            // Also check if spread reading interface is active in spreads tab
            const spreadsContent = document.getElementById('spreads-content');
            const hasSpreadReading = spreadsContent && spreadsContent.querySelector('.spread-reading-interface');
            
            if (hasSpreadReading && tabName !== 'spreads') {
                // Clean up spread reading interface if switching away from spreads
                backToSpreadSelection();
            }

            // Show tab navigation if it was hidden
            const tabNavigation = document.querySelector('.fixed.bottom-0');
            if (tabNavigation && tabNavigation.classList.contains('hidden')) {
                tabNavigation.classList.remove('hidden');
            }

            // Reset any spread-related states
            currentSpread = null;
            currentSpreadCards = [];

            // Hide all tab contents
            const tabContents = ['timer-content', 'spreads-content', 'journal-content', 'settings-content'];
            tabContents.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.add('hidden');
                }
            });

            // Show selected tab content
            const selectedContent = document.getElementById(tabName + '-content');
            if (selectedContent) {
                selectedContent.classList.remove('hidden');
                
                // If we just reset timer content, don't animate - just show immediately
                if (hasSpreadInterface && tabName === 'timer') {
                    selectedContent.style.opacity = '1';
                    selectedContent.style.transform = 'translateY(0)';
                } else {
                    // Add animation for normal tab switches
                    selectedContent.style.opacity = '0';
                    selectedContent.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        selectedContent.style.transition = 'all 0.5s ease-out';
                        selectedContent.style.opacity = '1';
                        selectedContent.style.transform = 'translateY(0)';
                    }, 10);
                }
            }

            // Update tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                const glowDivs = button.querySelectorAll('div');
                const indicator = button.querySelector('.h-0\\.5');
                
                // Reset all buttons
                button.classList.remove('text-yellow-400', 'bg-yellow-400/10');
                button.classList.add('text-white/60');
                
                glowDivs.forEach(div => {
                    if (div.classList.contains('absolute') && div.classList.contains('-inset-2')) {
                        div.classList.remove('opacity-100');
                        div.classList.add('opacity-0');
                    }
                    if (div.classList.contains('animate-pulse')) {
                        div.classList.remove('opacity-100');
                        div.classList.add('opacity-0');
                    }
                });
                
                const svg = button.querySelector('svg');
                if (svg) {
                    svg.classList.remove('scale-110', 'drop-shadow-lg');
                }
                
                if (indicator) {
                    indicator.classList.remove('opacity-100');
                    indicator.classList.add('opacity-0');
                }
            });

            // Activate selected tab
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.remove('text-white/60');
                selectedTab.classList.add('text-yellow-400', 'bg-yellow-400/10');
                
                const glowDivs = selectedTab.querySelectorAll('div');
                glowDivs.forEach(div => {
                    if (div.classList.contains('absolute') && div.classList.contains('-inset-2')) {
                        div.classList.remove('opacity-0');
                        div.classList.add('opacity-100');
                    }
                    if (div.classList.contains('animate-pulse')) {
                        div.classList.remove('opacity-0');
                        div.classList.add('opacity-100');
                    }
                });
                
                const svg = selectedTab.querySelector('svg');
                if (svg) {
                    svg.classList.add('scale-110', 'drop-shadow-lg');
                }
                
                const indicator = selectedTab.querySelector('.h-0\\.5');
                if (indicator) {
                    indicator.classList.remove('opacity-0');
                    indicator.classList.add('opacity-100');
                }
            }
        }

        // Journal section switching
        function showJournalSection(section) {
            const dailyBtn = document.getElementById('daily-btn');
            const spreadsBtn = document.getElementById('spreads-btn');
            const dailySection = document.getElementById('daily-section');
            const spreadsSection = document.getElementById('spreads-section');

            if (section === 'daily') {
                dailyBtn.classList.add('bg-yellow-400', 'text-black', 'shadow-lg');
                dailyBtn.classList.remove('text-white/70', 'hover:text-white');
                spreadsBtn.classList.remove('bg-yellow-400', 'text-black', 'shadow-lg');
                spreadsBtn.classList.add('text-white/70', 'hover:text-white');
                
                dailySection.classList.remove('hidden');
                spreadsSection.classList.add('hidden');
            } else {
                spreadsBtn.classList.add('bg-yellow-400', 'text-black', 'shadow-lg');
                spreadsBtn.classList.remove('text-white/70', 'hover:text-white');
                dailyBtn.classList.remove('bg-yellow-400', 'text-black', 'shadow-lg');
                dailyBtn.classList.add('text-white/70', 'hover:text-white');
                
                spreadsSection.classList.remove('hidden');
                dailySection.classList.add('hidden');
            }
        }

        // Update current time
        function updateTime() {
            const now = new Date();
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                const hours = now.getHours();
                const minutes = now.getMinutes();
                const ampm = hours >= 12 ? 'Ïò§ÌõÑ' : 'Ïò§Ï†Ñ';
                const displayHours = hours % 12 || 12;
                const displayMinutes = minutes.toString().padStart(2, '0');
                timeElement.textContent = `${ampm} ${displayHours}:${displayMinutes}`;
            }
        }

        // Current spread data
        let currentSpread = null;
        let currentSpreadCards = [];

        // Spread definitions with card positions
        const spreadDefinitions = {
            'one-card': {
                name: '1Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú - Îπ†Î•∏ ÎΩëÍ∏∞',
                cardCount: 1,
                positions: ['ÌòÑÏû¨ ÏÉÅÌô©'],
                layout: 'single'
            },
            'three-card': {
                name: '3Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú',
                cardCount: 3,
                positions: ['Í≥ºÍ±∞', 'ÌòÑÏû¨', 'ÎØ∏Îûò'],
                layout: 'horizontal'
            },
            'five-card': {
                name: '5Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú',
                cardCount: 5,
                positions: ['Í∏∞Î∞ò', 'ÎèÑÏ†Ñ', 'Ìûò', 'Ï°∞Ïñ∏', 'Í≤∞Í≥º'],
                layout: 'v-shape'
            },
            'four-card-timeline': {
                name: '4Ïπ¥Îìú ÏãúÍ∞ÑÏÑ†',
                cardCount: 4,
                positions: ['1Í∞úÏõî Ï†Ñ', 'ÌòÑÏû¨', '3Í∞úÏõî ÌõÑ', '1ÎÖÑ ÌõÑ'],
                layout: 'timeline'
            },
            'celtic-cross': {
                name: 'ÏºàÌã± ÌÅ¨Î°úÏä§',
                cardCount: 10,
                positions: ['ÌòÑÏû¨ ÏÉÅÌô©', 'Î∞©Ìï¥Î¨º', 'Î¨∏Ï†úÏùò ÌïµÏã¨', 'Í≥ºÍ±∞', 'ÌòÑÏû¨', 'ÎØ∏Îûò', 'ÏßàÎ¨∏Ïûê Í¥ÄÏ†ê', 'Ïô∏Î∂Ä ÏÉÅÌô©', 'ÏßàÎ¨∏Ïûê Î∞îÎûå, ÎëêÎ†§ÏõÄ', 'ÏµúÏ¢Ö ÏòàÏ∏°'],
                layout: 'celtic-cross'
            },
            'cup-of-relationship': {
                name: 'Ïªµ Ïò§Î∏å Î¶¥Î†àÏù¥ÏÖòÏã≠',
                cardCount: 11,
                positions: ['ÎÇòÏùò ÌòÑÏû¨ ÏÉÅÌÉú', 'ÏÉÅÎåÄÏùò ÌòÑÏû¨ ÏÉÅÌÉú', 'Ïö∞Î¶¨Ïùò ÌòÑÏû¨ ÏÉÅÌÉú', 'Í≥ºÍ±∞', 'ÌòÑÏû¨', 'Î∞©Ìï¥Î¨º', 'ÎÇòÏùò ÎßàÏùå', 'ÏÉÅÎåÄÏùò ÎßàÏùå', 'ÎÇ¥Í∞Ä ÏÉÅÎåÄÏóê Î∞îÎùºÎäî Ï†ê', 'ÏÉÅÎåÄÍ∞Ä ÎÇòÏóêÍ≤å Î∞îÎùºÎäî Ï†ê', 'Í≤∞Í≥º'],
                layout: 'cup-shape'
            },
            'ab-choice': {
                name: 'ABÏÑ†ÌÉù Ïä§ÌîÑÎ†àÎìú',
                cardCount: 7,
                positions: ['A ÏÑ†ÌÉùÏßÄ 1', 'A ÏÑ†ÌÉùÏßÄ 2', 'A ÏÑ†ÌÉùÏßÄ 3', 'ÌòÑÏû¨ ÏÉÅÌô©', 'B ÏÑ†ÌÉùÏßÄ 1', 'B ÏÑ†ÌÉùÏßÄ 2', 'B ÏÑ†ÌÉùÏßÄ 3'],
                layout: 'choice'
            }
        };

        // Start spread reading function
        function startSpreadReading(spreadId) {
            currentSpread = spreadDefinitions[spreadId];
            if (!currentSpread) {
                alert('ÏÑ†ÌÉùÎêú Ïä§ÌîÑÎ†àÎìúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }

            console.log(`üé¥ ${currentSpread.name} ÏãúÏûë`);
            
            // Hide spread list and show spread interface in the same tab
            const spreadsContent = document.getElementById('spreads-content');
            if (spreadsContent) {
                // Hide the entire spread selection layout
                const spreadSelectionLayout = spreadsContent.querySelector('.space-y-8');
                if (spreadSelectionLayout) {
                    spreadSelectionLayout.classList.add('hidden');
                }
                
                // Create and add spread interface
                const spreadInterface = createSpreadInterface(spreadId);
                spreadInterface.classList.add('spread-reading-interface');
                spreadsContent.appendChild(spreadInterface);
                
                // Ïä§ÌîÑÎ†àÎìú Î¶¨Îî© ÌôîÎ©¥ ÏßÑÏûÖ ÌõÑ ÏÉÅÎã®ÏúºÎ°ú Ïä§ÌÅ¨Î°§
                setTimeout(() => {
                    spreadsContent.scrollTop = 0;
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }, 100);
            }
        }

        // Hide initial timer interface
        function hideInitialTimerState() {
            const initialState = document.getElementById('initial-state');
            const cardsDrawnState = document.getElementById('cards-drawn-state');
            
            if (initialState) {
                initialState.classList.add('hidden');
            }
            if (cardsDrawnState) {
                cardsDrawnState.classList.add('hidden');
            }
        }

        // Reset timer content to original state
        function resetTimerContent() {
            const timerContent = document.getElementById('timer-content');
            if (timerContent) {
                // Store original timer HTML (should be preserved)
                const originalTimerHTML = `
                    <div class="space-y-8">
                        <!-- Header -->
                        <div class="text-center space-y-4">
                            <div class="flex items-center justify-center">
                                <svg class="h-12 w-12 text-yellow-400 animate-mystical-pulse" fill="currentColor" viewBox="0 0 24 24">
                                    <!-- ÌÉÄÎ°úÏπ¥Îìú Î∞∞Í≤Ω -->
                                    <rect x="4" y="1" width="16" height="22" rx="2" ry="2" fill="currentColor" opacity="0.9"/>
                                    <rect x="5" y="2" width="14" height="20" rx="1" ry="1" fill="rgba(26, 31, 58, 0.7)"/>
                                    <!-- ÏãúÍ≥Ñ ÏöîÏÜå -->
                                    <circle cx="12" cy="11" r="5" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                    <polyline points="12,8 12,11 15,13" stroke="currentColor" stroke-width="1.8" fill="none"/>
                                    <!-- ÌÉÄÎ°ú Ïû•Ïãù -->
                                    <circle cx="8" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                                    <circle cx="12" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                                    <circle cx="16" cy="18" r="1.2" fill="currentColor" opacity="0.7"/>
                                </svg>
                            </div>
                            <h1 class="display-large text-gradient-mystical">Tarot Timer</h1>
                            <p class="body-small text-white/70">24ÏãúÍ∞Ñ ÌÉÄÎ°ú Ïó¨Ï†ïÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî</p>
                        </div>

                        <!-- Initial State: Before Drawing Cards -->
                        <div id="initial-state" class="space-y-8">
                            <div class="text-center space-y-4">
                                <div class="bg-white/5 border border-white/10 rounded-2xl p-8 space-y-6">
                                    <div class="space-y-3">
                                        <svg class="h-16 w-16 mx-auto text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4V4H4z"/>
                                            <path d="M10 4h4v16h-4V4z"/>
                                            <path d="M16 4h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4V4z"/>
                                            <circle cx="6" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                            <circle cx="12" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                            <circle cx="18" cy="8" r="1" fill="rgba(26, 31, 58, 1)"/>
                                        </svg>
                                        <h2 class="title-large text-white">24ÏãúÍ∞ÑÏùò Ïã†ÎπÑÎ°úÏö¥ Ïó¨Ï†ï</h2>
                                        <p class="body-medium text-white/70 max-w-sm mx-auto">
                                            ÌïòÎ£® 24ÏãúÍ∞Ñ, Í∞Å ÏãúÍ∞ÑÎßàÎã§Ïùò ÌäπÎ≥ÑÌïú Î©îÏãúÏßÄÎ•º Îã¥ÏùÄ ÌÉÄÎ°úÏπ¥ÎìúÎ•º ÎΩëÏïÑÎ≥¥ÏÑ∏Ïöî.
                                        </p>
                                    </div>
                                    
                                    <button id="draw-cards-btn" onclick="drawDailyCards()" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-semibold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 animate-mystical-pulse">
                                        24ÏãúÍ∞Ñ ÌÉÄÎ°ú ÎΩëÍ∏∞
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Cards Drawn State will be added here when daily cards are drawn -->
                    </div>
                `;
                
                timerContent.innerHTML = originalTimerHTML;
                
                // Restore the drawn state if daily cards were previously drawn
                restoreTimerDrawnState();
            }
        }

        // Restore timer drawn state if cards were previously drawn
        function restoreTimerDrawnState() {
            const isDrawn = localStorage.getItem('dailyCardsDrawn');
            const drawDate = localStorage.getItem('drawDate');
            const today = new Date().toDateString();
            
            if (isDrawn === 'true' && drawDate === today) {
                // Add drawn state HTML back
                const timerContent = document.getElementById('timer-content');
                if (timerContent) {
                    // Add the cards drawn state content
                    const drawnStateHTML = getDrawnStateHTML();
                    timerContent.querySelector('.space-y-8').innerHTML += drawnStateHTML;
                    
                    // Show drawn state
                    drawDailyCards();
                }
            }
        }

        function getDrawnStateHTML() {
            return `
                <!-- Cards Drawn State: After Drawing Cards -->
                <div id="cards-drawn-state" class="space-y-8 hidden">
                    <!-- Current time and cards display content -->
                    <!-- This will be populated by the drawDailyCards function -->
                </div>
            `;
        }

        // Show spread drawing interface
        function showSpreadDrawingInterface(spreadId) {
            // Hide the entire tab structure and show full screen spread
            const tabContent = document.getElementById('timer-content');
            
            // Replace timer content with spread interface
            if (tabContent) {
                tabContent.innerHTML = '';
                const spreadInterface = createSpreadInterface(spreadId);
                tabContent.appendChild(spreadInterface);
            }
        }

        // This function is no longer needed as we're using full screen
        function createSpreadDrawingArea() {
            // Deprecated - now using full screen approach
        }

        // Create spread interface
        function createSpreadInterface(spreadId) {
            const spread = spreadDefinitions[spreadId];
            const container = document.createElement('div');
            container.className = 'flex flex-col h-full';
            container.dataset.spreadId = spreadId;

            // Fixed Top Section: Header + Title Input (ÌÉ≠ ÎÇ¥Î∂ÄÏóêÏÑúÎßå Í≥†Ï†ï)
            const topSection = document.createElement('div');
            topSection.className = 'flex-shrink-0 border-b border-white/5';
            
            // Top Header with title and back button
            const topHeader = document.createElement('div');
            topHeader.className = 'flex items-center justify-between px-5 py-3';
            topHeader.innerHTML = `
                <button onclick="backToSpreadSelection()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-all duration-200 touch-optimization flex items-center justify-center">
                    <svg class="h-4 w-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <polyline points="15,18 9,12 15,6"></polyline>
                    </svg>
                </button>
                <h1 class="text-lg font-semibold text-white">${spread.name}</h1>
                <div class="w-8"></div>
            `;

            // Reading title input section
            const titleSection = document.createElement('div');
            titleSection.className = 'px-5 pb-3';
            titleSection.innerHTML = `
                <input type="text" id="spread-title-input" placeholder="Î¶¨Îî© Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" 
                       class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white text-center placeholder-white/50 focus:outline-none focus:border-yellow-400 transition-colors spread-title-input" 
                       maxlength="50">
            `;

            topSection.appendChild(topHeader);
            topSection.appendChild(titleSection);

            // Scrollable Middle Section: Card Area
            const middleSection = document.createElement('div');
            middleSection.className = 'flex-1 overflow-y-auto px-5';
            
            const cardArea = document.createElement('div');
            cardArea.className = 'min-h-full flex items-center justify-center py-6';
            cardArea.innerHTML = createCardLayout(spreadId);
            
            middleSection.appendChild(cardArea);

            // Fixed Bottom Section: Action Buttons (ÌÉ≠ ÎÇ¥Î∂ÄÏóêÏÑúÎßå Í≥†Ï†ï)
            const bottomSection = document.createElement('div');
            bottomSection.className = 'flex-shrink-0 border-t border-white/5 p-4';
            
            const actionArea = document.createElement('div');
            actionArea.className = 'space-y-3';
            actionArea.innerHTML = `
                <div id="initial-action">
                    <button onclick="drawSpreadCards('${spreadId}')" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 px-6 text-sm hover:from-yellow-500 hover:to-yellow-600 transition-all duration-200 shadow-2xl shadow-yellow-400/20 rounded-xl touch-optimization">
                        <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                        </svg>
                        Ïπ¥Îìú ÎΩëÍ∏∞ ÏãúÏûë
                    </button>
                </div>
                <div id="completed-actions" class="hidden space-y-3">
                    <button onclick="drawSpreadCards('${spreadId}')" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold py-3 px-6 text-sm hover:from-yellow-500 hover:to-yellow-600 transition-all duration-200 shadow-2xl shadow-yellow-400/20 rounded-xl touch-optimization">
                        <svg class="h-4 w-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                        </svg>
                        Ïπ¥Îìú ÎΩëÍ∏∞ ÏãúÏûë
                    </button>
                    <div class="flex gap-3">
                        <button onclick="redrawSpreadCards('${spreadId}')" class="flex-1 bg-white/10 border border-white/20 text-white font-semibold py-2.5 px-4 text-sm rounded-xl hover:bg-white/20 transition-all duration-200 touch-optimization">
                            <svg class="h-4 w-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                                <path d="M21 3v5h-5"></path>
                                <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                                <path d="M3 21v-5h5"></path>
                            </svg>
                            Îã§Ïãú ÎΩëÍ∏∞
                        </button>
                        <button onclick="saveSpreadReading('${spreadId}')" class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold py-2.5 px-4 text-sm rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-lg touch-optimization">
                            <svg class="h-4 w-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7,10 12,15 17,10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Ï†ÄÏû•ÌïòÍ∏∞
                        </button>
                    </div>
                </div>
            `;

            bottomSection.appendChild(actionArea);

            container.appendChild(topSection);
            container.appendChild(middleSection);
            container.appendChild(bottomSection);

            // 1Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìúÏùò ÌÉ≠ Ìà¨ ÎìúÎ°úÏö∞ Í∏∞Îä• ÌôúÏÑ±Ìôî
            setTimeout(() => {
                const tapToDrawCard = container.querySelector('.tap-to-draw');
                if (tapToDrawCard) {
                    tapToDrawCard.addEventListener('click', () => {
                        drawSpreadCards(spreadId);
                    });
                }
            }, 100);
            
            return container;
        }

        // Create card layout based on spread type with responsive sizing
        function createCardLayout(spreadId) {
            const spread = spreadDefinitions[spreadId];
            let layoutHTML = '';

            switch (spread.layout) {
                case 'single':
                    layoutHTML = `
                        <div class="w-full h-full flex justify-center items-center p-4">
                            <div class="card-slot cursor-pointer tap-to-draw" data-position="0">
                                <div class="w-64 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 440px;">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-lg font-medium">TAP TO DRAW</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'horizontal':
                    const cardWidth = Math.min(90, (window.innerWidth * 0.7) / spread.positions.length);
                    const cardHeight = cardWidth * 1.72;
                    layoutHTML = `
                        <div class="w-full h-full flex justify-center items-center px-4">
                            <div class="flex justify-center gap-3 flex-wrap">
                                ${spread.positions.map((position, index) => `
                                    <div class="card-slot cursor-pointer" data-position="${index}">
                                        <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: ${cardWidth}px; height: ${cardHeight}px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">${index + 1}</div>
                                            </div>
                                        </div>
                                        <div class="text-center mt-2 text-xs text-white/70 font-medium px-1">${position}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    break;

                case 'v-shape':
                    layoutHTML = `
                        <div class="w-full h-full flex flex-col items-center justify-center gap-2 p-4">
                            <div class="flex gap-12">
                                <div class="card-slot cursor-pointer" data-position="0">
                                    <div class="w-19 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 132px;">
                                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                        <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                        <div class="w-full h-full flex items-center justify-center">
                                            <div class="text-yellow-400/60 text-xs font-medium">1</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-slot cursor-pointer" data-position="2">
                                    <div class="w-19 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 132px;">
                                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                        <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                        <div class="w-full h-full flex items-center justify-center">
                                            <div class="text-yellow-400/60 text-xs font-medium">4</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex gap-1">
                                <div class="card-slot cursor-pointer" data-position="1">
                                    <div class="w-19 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 132px;">
                                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                        <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                        <div class="w-full h-full flex items-center justify-center">
                                            <div class="text-yellow-400/60 text-xs font-medium">2</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-slot cursor-pointer" data-position="4">
                                    <div class="w-19 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 132px;">
                                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                        <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                        <div class="w-full h-full flex items-center justify-center">
                                            <div class="text-yellow-400/60 text-xs font-medium">5</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-slot cursor-pointer" data-position="3">
                                <div class="w-19 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 132px;">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">3</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'timeline':
                    // Í∞ÄÎ°ú ÎÑàÎπÑÏóê ÎßûÏ∂∞ÏÑú Ïπ¥Îìú ÌÅ¨Í∏∞Î•º Í≥ÑÏÇ∞ (ÌÉÄÎ°ú Ïπ¥Îìú Ïã§Ï†ú ÎπÑÏú® Ï†ÅÏö©)
                    const containerWidth = Math.min(window.innerWidth * 0.85, 360);
                    const totalGap = (spread.positions.length - 1) * 4; // 4px gap between cards
                    const timelineCardWidth = (containerWidth - totalGap) / spread.positions.length;
                    const timelineCardHeight = timelineCardWidth * 1.75; // ÌÉÄÎ°ú Ïπ¥Îìú Ïã§Ï†ú ÎπÑÏú® (ÏïΩ 5:8.75)
                    layoutHTML = `
                        <div class="w-full h-full flex justify-center items-center px-6">
                            <div class="flex justify-center gap-1 w-full max-w-sm">
                                ${spread.positions.map((position, index) => `
                                    <div class="card-slot cursor-pointer" data-position="${index}">
                                        <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: ${timelineCardWidth}px; height: ${timelineCardHeight}px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">${index + 1}</div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    break;

                case 'choice':
                    layoutHTML = `
                        <div class="w-full h-full flex justify-center items-center p-3">
                            <div class="flex justify-center gap-8">
                                <div class="text-center">
                                    <h3 class="text-yellow-400 font-bold mb-3 text-sm">ÏÑ†ÌÉùÏßÄ A</h3>
                                    <div class="flex flex-col gap-2">
                                        ${[0,1,2].map(i => `
                                            <div class="card-slot cursor-pointer" data-position="${i}">
                                                <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: 90px; height: 150px;">
                                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                                    <div class="w-full h-full flex items-center justify-center">
                                                        <div class="text-yellow-400/60 text-xs font-medium">A${i + 1}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="card-slot cursor-pointer" data-position="3">
                                        <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: 90px; height: 150px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">NOW</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <h3 class="text-yellow-400 font-bold mb-3 text-sm">ÏÑ†ÌÉùÏßÄ B</h3>
                                    <div class="flex flex-col gap-2">
                                        ${[4,5,6].map((globalIndex, localIndex) => `
                                            <div class="card-slot cursor-pointer" data-position="${globalIndex}">
                                                <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: 90px; height: 150px;">
                                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                                    <div class="w-full h-full flex items-center justify-center">
                                                        <div class="text-yellow-400/60 text-xs font-medium">B${localIndex + 1}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'celtic-cross':
                    layoutHTML = `
                        <div class="celtic-cross">
                            <!-- Card 1 -->
                            <div class="card card-1 card-slot cursor-pointer" data-position="0">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">1</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 2 (Ìö°Î∞©Ìñ•) -->
                            <div class="card card-2 card-slot cursor-pointer" data-position="1">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">2</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 3 -->
                            <div class="card card-3 card-slot cursor-pointer" data-position="4">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">4</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 4 -->
                            <div class="card card-4 card-slot cursor-pointer" data-position="2">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">3</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 5 -->
                            <div class="card card-5 card-slot cursor-pointer" data-position="3">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">5</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 6 -->
                            <div class="card card-6 card-slot cursor-pointer" data-position="5">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">5</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 7 -->
                            <div class="card card-7 card-slot cursor-pointer" data-position="6">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">7</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 8 -->
                            <div class="card card-8 card-slot cursor-pointer" data-position="7">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">8</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 9 -->
                            <div class="card card-9 card-slot cursor-pointer" data-position="8">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">9</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Card 10 -->
                            <div class="card card-10 card-slot cursor-pointer" data-position="9">
                                <div class="w-full h-full bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                    <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-yellow-400/60 text-xs font-medium">10</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'cup-shape':
                    // ÏºàÌã± ÌÅ¨Î°úÏä§ÏôÄ Í∞ôÏùÄ Ïπ¥Îìú ÌÅ¨Í∏∞ ÏÑ§Ï†ï
                    layoutHTML = `
                        <div class="cup-relationship relative w-full h-full flex items-center justify-center">
                            <div class="flex flex-col items-center gap-2">
                                <!-- ÏµúÏÉÅÎã®: Ïπ¥Îìú 9, 11, 10 -->
                                <div class="flex gap-2">
                                    <div class="card-slot cursor-pointer" data-position="8" style="transform: translateX(-72px);">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">9</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="10">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">11</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="9" style="transform: translateX(72px);">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">10</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Îëê Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 7, 8 -->
                                <div class="flex gap-1">
                                    <div class="card-slot cursor-pointer" data-position="6" style="transform: translateX(-36px);">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">7</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="7" style="transform: translateX(36px);">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">8</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ÏÑ∏ Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 5 -->
                                <div class="flex justify-center">
                                    <div class="card-slot cursor-pointer" data-position="2">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">5</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ÎÑ§ Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 4ÏôÄ 6 (3,2Î≤à Ïπ¥Îìú ÏúÑÏ™Ω Ï†ïÎ†¨) -->
                                <div class="flex gap-2">
                                    <div class="w-16"></div> <!-- 1Î≤à Ïπ¥Îìú ÏûêÎ¶¨ -->
                                    <div class="card-slot cursor-pointer" data-position="4">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">4</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="5" style="transform: translateY(-56px);">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">6</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ÏµúÌïòÎã®: Ïπ¥Îìú 1, 3, 2 -->
                                <div class="flex gap-2">
                                    <div class="card-slot cursor-pointer" data-position="0">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">1</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="3">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">3</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-slot cursor-pointer" data-position="1">
                                        <div class="w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-xl shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="height: 112px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-lg"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">2</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'celtic-cross':
                case 'cup-shape':
                default:
                    const cols = Math.ceil(Math.sqrt(spread.positions.length));
                    const cardSize = Math.min(70, (window.innerWidth * 0.7) / cols);
                    layoutHTML = `
                        <div class="w-full h-full flex items-center justify-center p-2">
                            <div class="grid gap-3" style="grid-template-columns: repeat(${cols}, 1fr); max-width: 90%;">
                                ${spread.positions.map((position, index) => `
                                    <div class="card-slot cursor-pointer" data-position="${index}">
                                        <div class="bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden" style="width: ${cardSize}px; height: ${cardSize * 1.4}px;">
                                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                                            <div class="absolute inset-1 border border-yellow-400/10 rounded-md"></div>
                                            <div class="w-full h-full flex items-center justify-center">
                                                <div class="text-yellow-400/60 text-xs font-medium">${index + 1}</div>
                                            </div>
                                        </div>
                                        <div class="text-center mt-1 text-xs text-white/70 font-medium px-1">${position}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    break;
            }

            return layoutHTML;
        }

        // Draw spread cards
        function drawSpreadCards(spreadId) {
            const spread = spreadDefinitions[spreadId];
            currentSpreadCards = [];

            // Fisher-Yates shuffle for random card selection
            const shuffledCards = [...allTarotCards];
            for (let i = shuffledCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledCards[i], shuffledCards[j]] = [shuffledCards[j], shuffledCards[i]];
            }

            // Select required number of cards
            for (let i = 0; i < spread.cardCount; i++) {
                currentSpreadCards.push(shuffledCards[i]);
            }

            // Show cards with animation
            animateCardDraw(spread);
        }

        // Animate card drawing
        function animateCardDraw(spread) {
            const cardSlots = document.querySelectorAll('.card-slot');
            
            // Sort card slots by data-position for proper order
            const sortedSlots = Array.from(cardSlots).sort((a, b) => {
                return parseInt(a.dataset.position) - parseInt(b.dataset.position);
            });
            
            let delay = 0;

            sortedSlots.forEach((slot, index) => {
                setTimeout(() => {
                    const card = currentSpreadCards[index];
                    const cardElement = slot.querySelector('div');
                    
                    // Add faster flip animation
                    cardElement.style.transition = 'transform 0.2s ease-in-out';
                    cardElement.style.transform = 'rotateY(90deg)';
                    
                    setTimeout(() => {
                        // Replace with actual card using enhanced image system
                        cardElement.innerHTML = '';
                        cardElement.style.position = 'relative';
                        cardElement.style.transform = 'rotateY(0deg)';
                        
                        // Remove placeholder styling completely
                        cardElement.className = cardElement.className
                            .replace(/border-dashed/g, '')
                            .replace(/border-yellow-400\/30/g, '')
                            .replace(/border-2/g, '')
                            .replace(/bg-gradient-to-br/g, '')
                            .replace(/from-white\/5/g, '')
                            .replace(/to-white\/10/g, '')
                            .replace(/w-14/g, '')
                            .trim();
                        
                        // Ensure card maintains original size and styling
                        if (!cardElement.classList.contains('card')) {
                            cardElement.classList.add('card');
                        }
                        
                        // Use enhanced image loading system for consistency
                        const position = currentSpread ? currentSpread.positions[index] : null;
                        createEnhancedCardImage(card, cardElement, {
                            showLoading: true,
                            enableFlip: false,
                            size: 'normal',
                            enablePopup: true,
                            position: position
                        });
                    }, 100);
                }, delay);
                
                delay += 150; // Faster stagger animation
            });

            // Show completion message after all cards are drawn
            setTimeout(() => {
                showSpreadCompletion();
            }, delay + 300);
        }

        // Show spread completion
        function showSpreadCompletion() {
            // Hide initial action and show completed actions
            const initialAction = document.getElementById('initial-action');
            const completedActions = document.getElementById('completed-actions');
            
            if (initialAction && completedActions) {
                initialAction.classList.add('hidden');
                completedActions.classList.remove('hidden');
            }

            console.log(`üé¥ ${currentSpread?.name || 'Spread'} Î¶¨Îî© ÏôÑÎ£å!`);
        }

        // Redraw spread cards with new random selection
        function redrawSpreadCards(spreadId) {
            // Reset button state to initial
            const initialAction = document.getElementById('initial-action');
            const completedActions = document.getElementById('completed-actions');
            
            if (initialAction && completedActions) {
                initialAction.classList.remove('hidden');
                completedActions.classList.add('hidden');
            }
            
            // Clear current cards and reset to transparent placeholders
            clearCurrentCards();
            
            // Redraw with new cards
            drawSpreadCards(spreadId);
            
            console.log('üîÑ Ïπ¥ÎìúÎ•º Îã§Ïãú ÎΩëÍ≥† ÏûàÏäµÎãàÎã§...');
        }
        
        // Save current spread reading to diary
        function saveSpreadReading() {
            if (!currentSpread || !currentSpreadCards.length) {
                alert('Ï†ÄÏû•Ìï† Ïä§ÌîÑÎ†àÎìú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const titleInput = document.querySelector('.spread-title-input');
            const spreadTitle = titleInput ? titleInput.value.trim() : '';
            
            if (!spreadTitle) {
                alert('Ïä§ÌîÑÎ†àÎìú Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                titleInput?.focus();
                return;
            }
            
            // Get current cards with positions
            const cards = currentSpreadCards.map((card, index) => ({
                position: currentSpread.positions[index],
                cardName: card.name,
                cardImage: card.image,
                keywords: card.keywords?.join(', ') || '',
                meaning: card.meaning || ''
            }));
            
            // Create spread record
            const spreadRecord = {
                id: Date.now().toString(),
                title: spreadTitle,
                spreadType: currentSpread.name,
                spreadId: currentSpread.id,
                date: new Date().toISOString(),
                dateFormatted: new Date().toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                }),
                cards: cards,
                positions: currentSpread.positions,
                layout: currentSpread.layout,
                cardCount: currentSpread.cardCount
            };
            
            // Save to localStorage
            const existingRecords = JSON.parse(localStorage.getItem('spreadRecords') || '[]');
            existingRecords.unshift(spreadRecord);
            localStorage.setItem('spreadRecords', JSON.stringify(existingRecords));
            
            console.log('üíæ Ïä§ÌîÑÎ†àÎìúÍ∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§:', spreadRecord);
            
            // Show success message and return to spread selection
            alert('‚ú® Ïä§ÌîÑÎ†àÎìúÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
            
            // Refresh spread records list
            refreshSpreadRecordsList();
            
            backToSpreadSelection();
        }
        
        // Helper functions for redraw and save
        function clearCurrentCards() {
            const cardSlots = document.querySelectorAll('.card-slot');
            
            // Sort card slots by data-position for proper order
            const sortedSlots = Array.from(cardSlots).sort((a, b) => {
                return parseInt(a.dataset.position) - parseInt(b.dataset.position);
            });
            
            sortedSlots.forEach((slot, index) => {
                // Reset to original card placeholder with correct styling based on layout
                const placeholder = slot.querySelector('div');
                if (placeholder) {
                    // Determine layout type by checking width classes or parent structure
                    const isSingleLayout = placeholder.classList.contains('w-72'); // 100% enlarged single card
                    const isSmallCard = placeholder.classList.contains('w-14') || placeholder.classList.contains('w-16') || placeholder.classList.contains('w-18') || placeholder.classList.contains('w-20');
                    const isDynamicCard = placeholder.style.width; // Dynamic sized cards
                    
                    if (isSingleLayout) {
                        // Reset to single card layout design (ÌÅ∞ Ïπ¥Îìú)
                        placeholder.innerHTML = `
                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                            <div class="absolute inset-2 border border-yellow-400/10 rounded-md"></div>
                            <div class="w-full h-full flex items-center justify-center">
                                <div class="text-yellow-400/60 text-lg font-medium">TAP TO DRAW</div>
                            </div>
                        `;
                        placeholder.className = 'w-72 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        placeholder.style.height = '496px';
                    } else if (isSmallCard || isDynamicCard) {
                        // Reset for other layouts (smaller cards) - ÏñáÏùÄ Ïú§Í≥ΩÏÑ†ÏúºÎ°ú Î≥µÏõê
                        placeholder.innerHTML = `
                            <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/5 to-transparent"></div>
                            <div class="absolute inset-1 border border-yellow-400/10 rounded-md"></div>
                            <div class="w-full h-full flex items-center justify-center">
                                <div class="text-yellow-400/60 text-xs font-medium">${index + 1}</div>
                            </div>
                        `;
                        // ÏõêÎûò className Î≥µÏõê - ÏñáÏùÄ border-yellow-400/20 ÏÇ¨Ïö©
                        if (placeholder.classList.contains('w-14')) {
                            placeholder.className = 'w-14 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        } else if (placeholder.classList.contains('w-16')) {
                            placeholder.className = 'w-16 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        } else if (placeholder.classList.contains('w-18')) {
                            placeholder.className = 'w-18 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        } else if (placeholder.classList.contains('w-20')) {
                            placeholder.className = 'w-20 bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        } else if (isDynamicCard) {
                            placeholder.className = 'bg-gradient-to-b from-indigo-900/20 via-purple-800/20 to-indigo-900/20 border border-yellow-400/20 rounded-lg shadow-2xl hover:shadow-yellow-400/10 transition-all duration-300 relative overflow-hidden';
                        }
                    } else {
                        // Fallback for celtic-cross and other special layouts
                        placeholder.innerHTML = `<div class="w-3 h-4 bg-yellow-400/20 rounded-sm"></div>`;
                        placeholder.className = 'w-14 bg-gradient-to-br from-white/5 to-white/10 border-2 border-dashed border-yellow-400/30 rounded-lg shadow-lg flex items-center justify-center';
                    }
                    
                    // Reset transform and transition for all cards
                    placeholder.style.transform = 'none';
                    placeholder.style.transition = '';
                    placeholder.style.position = '';
                }
            });
        }
        
        function generateRandomCards(count) {
            // Use Fisher-Yates shuffle to get random cards
            const allCards = [...tarotCards];
            for (let i = allCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allCards[i], allCards[j]] = [allCards[j], allCards[i]];
            }
            return allCards.slice(0, count);
        }

        // Back to spread selection
        function backToSpreadSelection() {
            // Reset states
            currentSpread = null;
            currentSpreadCards = [];

            // Remove spread interface and show spread list again
            const spreadsContent = document.getElementById('spreads-content');
            if (spreadsContent) {
                // Remove spread reading interface
                const spreadInterface = spreadsContent.querySelector('.spread-reading-interface');
                if (spreadInterface) {
                    spreadInterface.remove();
                }
                
                // Show the spread selection layout
                const spreadSelectionLayout = spreadsContent.querySelector('.space-y-8');
                if (spreadSelectionLayout) {
                    spreadSelectionLayout.classList.remove('hidden');
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 60000); // Update every minute
            
            // Load diary list on page load
            refreshDiaryList();
            
            // Load spread records list on page load
            refreshSpreadRecordsList();
            
            // Set timer tab as default active tab
            showTab('timer');
            
            console.log('üìñ ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å, ÌÉÄÏù¥Î®∏ ÌÉ≠ ÌôúÏÑ±Ìôî, ÏùºÍ∏∞ Î¶¨Ïä§Ìä∏ Î∞è Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù Ï¥àÍ∏∞ÌôîÎê®');
        });

        // Draw daily cards functionality
        function drawDailyCards() {
            // Hide initial state and show drawn state
            const initialState = document.getElementById('initial-state');
            const cardsDrawnState = document.getElementById('cards-drawn-state');
            
            if (initialState && cardsDrawnState) {
                initialState.classList.add('hidden');
                cardsDrawnState.classList.remove('hidden');
                
                // Save state to localStorage
                localStorage.setItem('dailyCardsDrawn', 'true');
                localStorage.setItem('drawDate', new Date().toDateString());
                
                // Generate random cards for 24 hours
                generateHourlyCards();
                
                console.log('24ÏãúÍ∞Ñ ÌÉÄÎ°úÏπ¥ÎìúÍ∞Ä ÎΩëÌòîÏäµÎãàÎã§!');
            }
        }
        
        // Complete 78-card tarot deck database
        const allTarotCards = [
            // Major Arcana (22 cards)
            { name: 'The Fool', image: 'assets/tarot-cards/classic-tarot/major_00_fool.jpg', type: 'major' },
            { name: 'The Magician', image: 'assets/tarot-cards/classic-tarot/major_01_magician.jpg', type: 'major' },
            { name: 'The High Priestess', image: 'assets/tarot-cards/classic-tarot/major_02_high_priestess.jpg', type: 'major' },
            { name: 'The Empress', image: 'assets/tarot-cards/classic-tarot/major_03_empress.jpg', type: 'major' },
            { name: 'The Emperor', image: 'assets/tarot-cards/classic-tarot/major_04_emperor.jpg', type: 'major' },
            { name: 'The Hierophant', image: 'assets/tarot-cards/classic-tarot/major_05_hierophant.jpg', type: 'major' },
            { name: 'The Lovers', image: 'assets/tarot-cards/classic-tarot/major_06_lovers.jpg', type: 'major' },
            { name: 'The Chariot', image: 'assets/tarot-cards/classic-tarot/major_07_chariot.jpg', type: 'major' },
            { name: 'Strength', image: 'assets/tarot-cards/classic-tarot/major_08_strength.jpg', type: 'major' },
            { name: 'The Hermit', image: 'assets/tarot-cards/classic-tarot/major_09_hermit.jpg', type: 'major' },
            { name: 'Wheel of Fortune', image: 'assets/tarot-cards/classic-tarot/major_10_wheel_of_fortune.jpg', type: 'major' },
            { name: 'Justice', image: 'assets/tarot-cards/classic-tarot/major_11_justice.jpg', type: 'major' },
            { name: 'The Hanged Man', image: 'assets/tarot-cards/classic-tarot/major_12_hanged_man.jpg', type: 'major' },
            { name: 'Death', image: 'assets/tarot-cards/classic-tarot/major_13_death.jpg', type: 'major' },
            { name: 'Temperance', image: 'assets/tarot-cards/classic-tarot/major_14_temperance.jpg', type: 'major' },
            { name: 'The Devil', image: 'assets/tarot-cards/classic-tarot/major_15_devil.jpg', type: 'major' },
            { name: 'The Tower', image: 'assets/tarot-cards/classic-tarot/major_16_tower.jpg', type: 'major' },
            { name: 'The Star', image: 'assets/tarot-cards/classic-tarot/major_17_star.jpg', type: 'major' },
            { name: 'The Moon', image: 'assets/tarot-cards/classic-tarot/major_18_moon.jpg', type: 'major' },
            { name: 'The Sun', image: 'assets/tarot-cards/classic-tarot/major_19_sun.jpg', type: 'major' },
            { name: 'Judgement', image: 'assets/tarot-cards/classic-tarot/major_20_judgement.jpg', type: 'major' },
            { name: 'The World', image: 'assets/tarot-cards/classic-tarot/major_21_world.jpg', type: 'major' },
            
            // Minor Arcana - Cups (Ïã§Ï†ú Ï°¥Ïû¨ÌïòÎäî ÌååÏùºÎßå)
            { name: 'Ace of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_ace.jpg', type: 'minor' },
            { name: 'Two of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_02.jpg', type: 'minor' },
            { name: 'Three of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_03.jpg', type: 'minor' },
            { name: 'Four of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_04.jpg', type: 'minor' },
            { name: 'Five of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_05.jpg', type: 'minor' },
            { name: 'Six of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_06.jpg', type: 'minor' },
            { name: 'Seven of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_07.jpg', type: 'minor' },
            { name: 'Eight of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_08.jpg', type: 'minor' },
            { name: 'Nine of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_09.jpg', type: 'minor' },
            { name: 'Ten of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_10.jpg', type: 'minor' },
            { name: 'Page of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_page.jpg', type: 'minor' },
            { name: 'Knight of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_knight.jpg', type: 'minor' },
            { name: 'Queen of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_queen.jpg', type: 'minor' },
            { name: 'King of Cups', image: 'assets/tarot-cards/classic-tarot/minor_cups_king.jpg', type: 'minor' },
            
            // Minor Arcana - Pentacles (Ïã§Ï†ú Ï°¥Ïû¨ÌïòÎäî ÌååÏùºÎßå)
            { name: 'Ace of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_ace.jpg', type: 'minor' },
            { name: 'Two of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_02.jpg', type: 'minor' },
            { name: 'Three of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_03.jpg', type: 'minor' },
            { name: 'Four of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_04.jpg', type: 'minor' },
            { name: 'Five of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_05.jpg', type: 'minor' },
            { name: 'Six of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_06.jpg', type: 'minor' },
            { name: 'Seven of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_07.jpg', type: 'minor' },
            { name: 'Eight of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_08.jpg', type: 'minor' },
            { name: 'Nine of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_09.jpg', type: 'minor' },
            { name: 'Ten of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_10.jpg', type: 'minor' },
            { name: 'Page of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_page.jpg', type: 'minor' },
            { name: 'Knight of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_knight.jpg', type: 'minor' },
            { name: 'Queen of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_queen.jpg', type: 'minor' },
            { name: 'King of Pentacles', image: 'assets/tarot-cards/classic-tarot/minor_pentacles_king.jpg', type: 'minor' },
            
            // Minor Arcana - Swords (Ïã§Ï†ú Ï°¥Ïû¨ÌïòÎäî ÌååÏùºÎßå)
            { name: 'Ace of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_ace.jpg', type: 'minor' },
            { name: 'Two of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_02.jpg', type: 'minor' },
            { name: 'Three of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_03.jpg', type: 'minor' },
            { name: 'Four of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_04.jpg', type: 'minor' },
            { name: 'Five of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_05.jpg', type: 'minor' },
            { name: 'Six of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_06.jpg', type: 'minor' },
            { name: 'Seven of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_07.jpg', type: 'minor' },
            { name: 'Eight of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_08.jpg', type: 'minor' },
            { name: 'Nine of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_09.jpg', type: 'minor' },
            { name: 'Ten of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_10.jpg', type: 'minor' },
            { name: 'Page of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_page.jpg', type: 'minor' },
            { name: 'Knight of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_knight.jpg', type: 'minor' },
            { name: 'Queen of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_queen.jpg', type: 'minor' },
            { name: 'King of Swords', image: 'assets/tarot-cards/classic-tarot/minor_swords_king.jpg', type: 'minor' },
            
            // Minor Arcana - Wands (Ïã§Ï†ú Ï°¥Ïû¨ÌïòÎäî ÌååÏùºÎßå)
            { name: 'Ace of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_ace.jpg', type: 'minor' },
            { name: 'Two of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_02.jpg', type: 'minor' },
            { name: 'Three of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_03.jpg', type: 'minor' },
            { name: 'Four of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_04.jpg', type: 'minor' },
            { name: 'Five of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_05.jpg', type: 'minor' },
            { name: 'Six of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_06.jpg', type: 'minor' },
            { name: 'Seven of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_07.jpg', type: 'minor' },
            { name: 'Eight of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_08.jpg', type: 'minor' },
            { name: 'Nine of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_09.jpg', type: 'minor' },
            { name: 'Ten of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_10.jpg', type: 'minor' },
            { name: 'Page of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_page.jpg', type: 'minor' },
            { name: 'Knight of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_knight.jpg', type: 'minor' },
            { name: 'Queen of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_queen.jpg', type: 'minor' },
            { name: 'King of Wands', image: 'assets/tarot-cards/classic-tarot/minor_wands_king.jpg', type: 'minor' }
        ];

        // Global variable to store currently selected 24 cards
        let currentDailyCards = [];
        
        // Global variable to track current hour in popup
        let currentPopupHour = 0;

        // Fisher-Yates shuffle algorithm for random card selection
        function shuffleArray(array) {
            const shuffled = [...array]; // Create a copy
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Handle redraw button click
        function redrawCards() {
            console.log('üîÑ Îã§Ïãú ÎΩëÍ∏∞ Î≤ÑÌäºÏù¥ ÌÅ¥Î¶≠ÎêòÏóàÏäµÎãàÎã§!');
            
            // Add visual feedback for card change
            const timelineContainer = document.querySelector('.flex.space-x-4.overflow-x-auto');
            if (timelineContainer) {
                timelineContainer.style.opacity = '0.5';
                timelineContainer.style.transition = 'opacity 0.3s ease';
            }
            
            setTimeout(() => {
                generateHourlyCards();
                if (timelineContainer) {
                    timelineContainer.style.opacity = '1';
                }
            }, 150);
        }

        // Generate random 24 cards from the full 78-card deck
        function generateHourlyCards() {
            console.log('üéØ generateHourlyCards() Ìï®Ïàò ÏãúÏûë');
            console.log('üìù Ï†ÑÏ≤¥ Ïπ¥Îìú Ïàò:', allTarotCards.length);
            
            // Check if allTarotCards is properly loaded
            if (!allTarotCards || allTarotCards.length !== 78) {
                console.error('‚ùå ÌÉÄÎ°úÏπ¥Îìú Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïò§Î•ò! Ïπ¥Îìú Ïàò:', allTarotCards?.length || 0);
                return;
            }
            
            console.log('üîÑ 78Ïû•Ïùò Ïπ¥Îìú Ï§ëÏóêÏÑú ÎûúÎç§ÏúºÎ°ú 24Ïû•ÏùÑ ÏÑ†ÌÉùÌïòÎäî Ï§ë...');
            
            // Shuffle all cards and select first 24
            const shuffledCards = shuffleArray(allTarotCards);
            console.log('‚ú® ÏÖîÌîå ÏôÑÎ£å, Ï≤òÏùå 5Ïû•:', shuffledCards.slice(0, 5).map(c => c.name));
            
            currentDailyCards = shuffledCards.slice(0, 24).map(card => ({
                ...card,
                memo: '' // Initialize memo property for each card
            }));
            
            console.log('üìã ÏÑ†ÌÉùÎêú 24Ïû• Ïπ¥Îìú Î™©Î°ù:');
            currentDailyCards.forEach((card, index) => {
                console.log(`  ${index}Ïãú: ${card.name}`);
            });
            
            // Update the card display
            console.log('üñºÔ∏è Ïπ¥Îìú ÎîîÏä§ÌîåÎ†àÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë...');
            updateCardDisplay();
            
            console.log('‚úÖ 24Ïû•Ïùò Ïπ¥ÎìúÍ∞Ä ÏÑ†ÌÉùÎêòÍ≥† ÌôîÎ©¥Ïù¥ ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§!');
        }

        // Update the card display with newly generated random cards
        function updateCardDisplay() {
            if (currentDailyCards.length === 0) {
                console.log('‚ùå Ïπ¥ÎìúÍ∞Ä ÏÉùÏÑ±ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                return;
            }

            console.log('üñºÔ∏è Ïπ¥Îìú ÎîîÏä§ÌîåÎ†àÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë...');

            // Get current hour and highlight current time card
            const now = new Date();
            const currentHour = now.getHours();
            console.log('‚è∞ ÌòÑÏû¨ ÏãúÍ∞Ñ:', currentHour + 'Ïãú');

            // Update main current time card (larger display)
            const mainCardImg = document.querySelector('#cards-drawn-state .w-48.h-80 img');
            const mainCardTitle = document.getElementById('current-card-name');
            const currentTimeMemo = document.getElementById('current-time-memo');
            
            if (mainCardImg && currentDailyCards[currentHour]) {
                console.log('üéØ Î©îÏù∏ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏:', currentDailyCards[currentHour].name);
                mainCardImg.src = currentDailyCards[currentHour].image;
                mainCardImg.alt = currentDailyCards[currentHour].name;
                
                if (mainCardTitle) {
                    mainCardTitle.textContent = currentDailyCards[currentHour].name;
                    console.log('üìù Ïπ¥ÎìúÎ™Ö ÏóÖÎç∞Ïù¥Ìä∏:', currentDailyCards[currentHour].name);
                }
                
                // Update memo area with saved memo
                if (currentTimeMemo) {
                    currentTimeMemo.value = currentDailyCards[currentHour].memo || '';
                    console.log('üìù ÌòÑÏû¨ ÏãúÍ∞Ñ Î©îÎ™® Î°úÎìú:', currentDailyCards[currentHour].memo || '(ÎπÑÏñ¥ÏûàÏùå)');
                }
            }

            // Update 24-hour timeline cards
            const timelineCards = document.querySelectorAll('.flex-shrink-0.touch-optimization');
            let currentHourCard = null;
            console.log('üìã ÌÉÄÏûÑÎùºÏù∏ Ïπ¥Îìú Ïàò:', timelineCards.length);
            
            timelineCards.forEach((card, index) => {
                if (currentDailyCards[index]) {
                    const img = card.querySelector('img');
                    const timeLabel = card.querySelector('.caption');
                    
                    if (img) {
                        console.log(`üì∑ ${index}Ïãú Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏:`, currentDailyCards[index].name);
                        img.src = currentDailyCards[index].image;
                        img.alt = currentDailyCards[index].name;
                    }
                    
                    // Add/remove current hour highlight
                    if (index === currentHour) {
                        card.classList.add('ring-2', 'ring-yellow-400');
                        currentHourCard = card;
                        console.log('üü° ÌòÑÏû¨ ÏãúÍ∞Ñ Ïπ¥Îìú Í∞ïÏ°∞:', index + 'Ïãú');
                    } else {
                        card.classList.remove('ring-2', 'ring-yellow-400');
                    }
                }
            });

            // Scroll current hour card to center
            if (currentHourCard) {
                console.log('üéØ ÌòÑÏû¨ ÏãúÍ∞Ñ Ïπ¥ÎìúÎ°ú Ïä§ÌÅ¨Î°§ Ï§ë...');
                setTimeout(() => {
                    currentHourCard.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'nearest',
                        inline: 'center' 
                    });
                    console.log('‚úÖ Ïä§ÌÅ¨Î°§ ÏôÑÎ£å');
                }, 200);
            } else {
                console.log('‚ö†Ô∏è ÌòÑÏû¨ ÏãúÍ∞Ñ Ïπ¥ÎìúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
            }

            console.log('‚úÖ Ïπ¥Îìú ÎîîÏä§ÌîåÎ†àÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å');
        }

        // Sample interactions
        function selectCard(hour) {
            console.log('Ïπ¥Îìú ÏÑ†ÌÉùÎê®:', hour + 'Ïãú');
            
            // Show popup modal with card details
            showCardPopup(hour);
        }
        
        // Show card popup modal
        function showCardPopup(hour) {
            // Store current hour for save function
            currentPopupHour = hour;
            
            const popup = document.getElementById('card-popup');
            const popupHour = document.getElementById('popup-hour');
            const popupCard = document.getElementById('popup-card-image');
            const popupMemo = document.getElementById('popup-memo');
            
            // Time labels for each hour
            const timeLabels = {
                0: 'ÏûêÏ†ï', 1: 'ÏÉàÎ≤Ω 1Ïãú', 2: 'ÏÉàÎ≤Ω 2Ïãú', 3: 'ÏÉàÎ≤Ω 3Ïãú', 4: 'ÏÉàÎ≤Ω 4Ïãú', 5: 'ÏÉàÎ≤Ω 5Ïãú',
                6: 'Ïò§Ï†Ñ 6Ïãú', 7: 'Ïò§Ï†Ñ 7Ïãú', 8: 'Ïò§Ï†Ñ 8Ïãú', 9: 'Ïò§Ï†Ñ 9Ïãú', 10: 'Ïò§Ï†Ñ 10Ïãú', 11: 'Ïò§Ï†Ñ 11Ïãú',
                12: 'Ï†ïÏò§', 13: 'Ïò§ÌõÑ 1Ïãú', 14: 'Ïò§ÌõÑ 2Ïãú', 15: 'Ïò§ÌõÑ 3Ïãú', 16: 'Ïò§ÌõÑ 4Ïãú', 17: 'Ïò§ÌõÑ 5Ïãú',
                18: 'Ïò§ÌõÑ 6Ïãú', 19: 'Ïò§ÌõÑ 7Ïãú', 20: 'Ïò§ÌõÑ 8Ïãú', 21: 'Ïò§ÌõÑ 9Ïãú', 22: 'Ïò§ÌõÑ 10Ïãú', 23: 'Ïò§ÌõÑ 11Ïãú'
            };
            
            // Get card info from current daily cards or default
            const cardData = currentDailyCards[hour];
            const timeLabel = timeLabels[hour] || (hour + 'Ïãú');
            
            if (cardData) {
                // Update popup content with actual card data
                popupHour.textContent = timeLabel;
                popupCard.src = cardData.image;
                popupCard.alt = cardData.name;
                popupMemo.value = cardData.memo || '';
                
                // Update popup title with card name
                const popupTitle = document.querySelector('#card-popup .title-medium');
                if (popupTitle) {
                    popupTitle.textContent = cardData.name;
                }
            } else {
                // Fallback if no card data available
                popupHour.textContent = timeLabel;
                popupCard.src = 'assets/tarot-cards/classic-tarot/major_00_fool.jpg';
                popupCard.alt = 'Mystery Card';
                popupMemo.value = '';
                
                const popupTitle = document.querySelector('#card-popup .title-medium');
                if (popupTitle) {
                    popupTitle.textContent = 'Mystery Card';
                }
            }
            
            // Show popup
            popup.classList.remove('hidden');
            popup.classList.add('flex');
        }
        
        // Close card popup
        function closeCardPopup() {
            const popup = document.getElementById('card-popup');
            popup.classList.add('hidden');
            popup.classList.remove('flex');
        }
        
        // Save memo for current time card (main display area)
        function saveCurrentTimeMemo() {
            const now = new Date();
            const currentHour = now.getHours();
            const memo = document.getElementById('current-time-memo').value;
            
            console.log('üíæ ÌòÑÏû¨ ÏãúÍ∞Ñ Î©îÎ™® Ï†ÄÏû• ÏãúÏûë:', currentHour + 'Ïãú');
            
            // Save memo to currentDailyCards array
            if (currentDailyCards[currentHour]) {
                currentDailyCards[currentHour].memo = memo;
                console.log(`‚úÖ ${currentHour}Ïãú Î©îÎ™® Ï†ÄÏû• ÏôÑÎ£å:`, memo);
                
                // Show save confirmation
                showMemoSaveConfirmation();
            } else {
                console.log('‚ùå ÌòÑÏû¨ ÏãúÍ∞ÑÏóê Ìï¥ÎãπÌïòÎäî Ïπ¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.');
            }
        }
        
        // Show memo save confirmation
        function showMemoSaveConfirmation() {
            const button = document.querySelector('button[onclick="saveCurrentTimeMemo()"]');
            const originalHTML = button.innerHTML;
            
            // Show success state
            button.innerHTML = `
                <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                ÏôÑÎ£å
            `;
            button.classList.add('bg-green-500/20', 'border-green-400/30', 'text-green-400');
            button.classList.remove('bg-yellow-400/10', 'border-yellow-400/30', 'text-yellow-400');
            
            // Reset after 2 seconds
            setTimeout(() => {
                button.innerHTML = originalHTML;
                button.classList.remove('bg-green-500/20', 'border-green-400/30', 'text-green-400');
                button.classList.add('bg-yellow-400/10', 'border-yellow-400/30', 'text-yellow-400');
            }, 2000);
        }

        // Save memo for specific hour (popup modal)
        function saveMemo() {
            const memo = document.getElementById('popup-memo').value;
            const hour = currentPopupHour;
            
            // Save memo to currentDailyCards array
            if (currentDailyCards[hour]) {
                currentDailyCards[hour].memo = memo;
                console.log(`${hour}Ïãú Î©îÎ™® Ï†ÄÏû•:`, memo);
                console.log('Updated card data:', currentDailyCards[hour]);
            }
            
            // Close popup
            closeCardPopup();
        }

        // Variables for diary view
        let currentDiaryData = null;
        let currentDiaryHour = 0;
        
        // localStorage key for daily tarot diary
        const DIARY_STORAGE_KEY = 'dailyTarotDiary';
        
        // Get saved diary data from localStorage
        function getSavedDiaryData() {
            try {
                const saved = localStorage.getItem(DIARY_STORAGE_KEY);
                return saved ? JSON.parse(saved) : {};
            } catch (e) {
                console.error('‚ùå ÏùºÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', e);
                return {};
            }
        }
        
        // Save diary data to localStorage
        function saveDiaryData(diaryData) {
            try {
                localStorage.setItem(DIARY_STORAGE_KEY, JSON.stringify(diaryData));
                console.log('üíæ ÏùºÍ∏∞ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ÏôÑÎ£å');
                return true;
            } catch (e) {
                console.error('‚ùå ÏùºÍ∏∞ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ïã§Ìå®:', e);
                return false;
            }
        }
        
        // Save current daily tarot to diary
        function saveDailyTarot() {
            console.log('üíæ Îç∞ÏùºÎ¶¨ ÌÉÄÎ°ú Ï†ÄÏû• ÏãúÏûë');
            
            // Check if cards are drawn
            if (!currentDailyCards || currentDailyCards.length === 0) {
                alert('Î®ºÏ†Ä 24ÏãúÍ∞Ñ ÌÉÄÎ°ú Ïπ¥ÎìúÎ•º ÎΩëÏïÑÏ£ºÏÑ∏Ïöî!');
                return;
            }
            
            // Get current date
            const now = new Date();
            const dateKey = now.toISOString().split('T')[0]; // YYYY-MM-DD format
            const dateDisplay = `${now.getFullYear()}ÎÖÑ ${now.getMonth() + 1}Ïõî ${now.getDate()}Ïùº ${['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'][now.getDay()]}ÏöîÏùº`;
            
            // Get existing diary data
            const diaryData = getSavedDiaryData();
            
            // Check if entry already exists for today
            if (diaryData[dateKey]) {
                const confirmOverwrite = confirm(`Ïò§Îäò(${dateDisplay}) ÏùºÍ∏∞Í∞Ä Ïù¥ÎØ∏ Ï°¥Ïû¨Ìï©ÎãàÎã§.\n\nÍ∏∞Ï°¥ ÏùºÍ∏∞Î•º ÎçÆÏñ¥Ïì∞ÏãúÍ≤†ÏäµÎãàÍπå?`);
                if (!confirmOverwrite) {
                    console.log('‚ùå ÏÇ¨Ïö©ÏûêÍ∞Ä ÎçÆÏñ¥Ïì∞Í∏∞Î•º Ï∑®ÏÜåÌñàÏäµÎãàÎã§.');
                    return;
                }
            }
            
            // Prepare diary entry
            const diaryEntry = {
                date: dateDisplay,
                dateKey: dateKey,
                timestamp: now.toISOString(),
                cards: currentDailyCards.map((card, hour) => ({
                    hour: hour,
                    name: card.name,
                    image: card.image,
                    type: card.type,
                    memo: card.memo || ''
                }))
            };
            
            // Add/update entry
            diaryData[dateKey] = diaryEntry;
            
            // Save to localStorage
            if (saveDiaryData(diaryData)) {
                // Show success message and update UI
                showSaveSuccessMessage();
                refreshDiaryList();
                console.log('‚úÖ Îç∞ÏùºÎ¶¨ ÌÉÄÎ°ú Ï†ÄÏû• ÏôÑÎ£å:', dateDisplay);
                console.log('üìä Ï†ÄÏû•Îêú Ïπ¥Îìú Ïàò:', diaryEntry.cards.length);
                console.log('üìù Î©îÎ™® ÏûàÎäî Ïπ¥Îìú:', diaryEntry.cards.filter(card => card.memo).length);
            } else {
                alert('Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
            }
        }
        
        // Show save success message
        function showSaveSuccessMessage() {
            const button = document.querySelector('button[onclick="saveDailyTarot()"]');
            const originalHTML = button.innerHTML;
            
            // Show success state
            button.innerHTML = `
                <svg class="h-5 w-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Ï†ÄÏû• ÏôÑÎ£å!
            `;
            button.classList.add('from-green-500', 'to-green-600');
            button.classList.remove('from-yellow-400', 'to-yellow-500');
            
            // Reset after 3 seconds
            setTimeout(() => {
                button.innerHTML = originalHTML;
                button.classList.remove('from-green-500', 'to-green-600');
                button.classList.add('from-yellow-400', 'to-yellow-500');
            }, 3000);
        }
        
        // Refresh diary list with latest data
        function refreshDiaryList() {
            const diaryData = getSavedDiaryData();
            const diaryList = document.getElementById('daily-diary-list');
            
            if (!diaryList) {
                console.log('üìã ÏùºÍ∏∞ Î¶¨Ïä§Ìä∏ ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            // Get entries sorted by date (newest first)
            const entries = Object.values(diaryData).sort((a, b) => 
                new Date(b.timestamp) - new Date(a.timestamp)
            );
            
            // Clear existing list
            diaryList.innerHTML = '';
            
            if (entries.length === 0) {
                diaryList.innerHTML = `
                    <div class="text-center py-8 text-white/60">
                        <svg class="h-12 w-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <p class="body-small">ÏïÑÏßÅ Ï†ÄÏû•Îêú ÏùºÍ∏∞Í∞Ä ÏóÜÏäµÎãàÎã§.<br>ÌÉÄÏù¥Î®∏ÏóêÏÑú 24ÏãúÍ∞Ñ ÌÉÄÎ°úÎ•º ÎΩëÍ≥† Ï†ÄÏû•Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                    </div>
                `;
                return;
            }
            
            // Render entries
            entries.forEach(entry => {
                const memoCount = entry.cards.filter(card => card.memo && card.memo.trim() !== '').length;
                const entryHTML = createDiaryEntryHTML(entry, memoCount);
                diaryList.appendChild(entryHTML);
            });
            
            // Update diary count
            const countElement = document.getElementById('diary-count');
            if (countElement) {
                countElement.textContent = `${entries.length}Í∞ú Í∏∞Î°ù`;
            }
        }
        
        // Create diary entry HTML element
        function createDiaryEntryHTML(entry, memoCount) {
            const div = document.createElement('div');
            div.className = 'bg-white/5 border border-white/10 touch-card rounded-2xl p-5 space-y-4';
            
            // Generate card previews (show up to 5 cards, then +X indicator)
            const visibleCards = entry.cards.slice(0, 5);
            const remainingCards = Math.max(0, entry.cards.length - 5);
            
            const cardsHTML = visibleCards.map(card => `
                <div class="flex-shrink-0 w-7 h-12 rounded overflow-hidden border border-yellow-400/30 shadow-lg relative">
                    <img src="${card.image}" alt="${card.name}" class="w-full h-full object-cover">
                    ${card.memo && card.memo.trim() !== '' ? `
                        <div class="absolute top-0 right-0 w-2 h-2 bg-yellow-400 rounded-full flex items-center justify-center">
                            <svg class="w-1 h-1 text-black" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                            </svg>
                        </div>
                    ` : ''}
                </div>
            `).join('');
            
            const remainingHTML = remainingCards > 0 ? `
                <div class="flex-shrink-0 w-7 h-12 rounded bg-white/10 border border-white/20 flex items-center justify-center">
                    <span class="text-xs text-white/60">+${remainingCards}</span>
                </div>
            ` : '';
            
            div.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex items-center gap-2">
                        <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        <span class="body-medium text-white">${entry.date}</span>
                    </div>
                    <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">${record.spreadType}</span>
                </div>
                
                <div class="flex gap-1 overflow-x-auto pb-2 scrollbar-none">
                    ${cardsHTML}
                    ${remainingHTML}
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <svg class="h-3 w-3 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        <span class="caption text-yellow-400">${memoCount}Í∞ú ÏãúÍ∞ÑÎåÄ Î©îÎ™®</span>
                    </div>
                    <button onclick="viewDailyDiary('${entry.dateKey}')" class="px-3 py-0.5 text-sm rounded-lg border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10 transition-all duration-300 touch-optimization">
                        Î≥¥Í∏∞
                    </button>
                </div>
            `;
            
            return div;
        }
        
        // Refresh spread records list with latest data
        function refreshSpreadRecordsList() {
            const spreadRecords = JSON.parse(localStorage.getItem('spreadRecords') || '[]');
            const recordsList = document.getElementById('spread-records-list');
            const spreadCount = document.getElementById('spread-count');
            
            if (!recordsList) {
                console.log('üìã Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù Î¶¨Ïä§Ìä∏ ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            // Update count
            if (spreadCount) {
                spreadCount.textContent = `${spreadRecords.length}Í∞ú Í∏∞Î°ù`;
            }
            
            // Clear existing list
            recordsList.innerHTML = '';
            
            if (spreadRecords.length === 0) {
                recordsList.innerHTML = `
                    <div class="text-center py-8 text-white/60">
                        <svg class="h-12 w-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="9" x2="15" y2="15"></line>
                            <line x1="15" y1="9" x2="9" y2="15"></line>
                        </svg>
                        <p class="body-medium mb-2">Ï†ÄÏû•Îêú Ïä§ÌîÑÎ†àÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§</p>
                        <p class="body-small">Ïä§ÌîÑÎ†àÎìú Î¶¨Îî©ÏùÑ ÏôÑÎ£åÌïòÍ≥† Ï†ÄÏû•Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>
                `;
                return;
            }
            
            // Sort by date (newest first)
            const sortedRecords = spreadRecords.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Add each spread record
            sortedRecords.forEach(record => {
                const recordElement = createSpreadRecordElement(record);
                recordsList.appendChild(recordElement);
            });
            
            console.log('üìú Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù Î¶¨Ïä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏Îê®:', spreadRecords.length);
        }
        
        // Create spread record element
        function createSpreadRecordElement(record) {
            const div = document.createElement('div');
            div.className = 'bg-white/5 border border-white/10 touch-card rounded-2xl p-5 space-y-4';
            
            div.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="space-y-2 flex-1">
                        <div class="flex items-center gap-2">
                            <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="9" y1="9" x2="15" y2="15"></line>
                                <line x1="15" y1="9" x2="9" y2="15"></line>
                            </svg>
                            <span class="body-medium text-white group-hover:text-yellow-400 transition-colors">${record.title}</span>
                        </div>
                        <div class="flex items-center gap-2 body-small">
                            <svg class="h-3 w-3 text-yellow-400/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            <span class="text-white/70">${record.dateFormatted}</span>
                        </div>
                    </div>
                    <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">${record.spreadType}</span>
                </div>

                <!-- Spread Badge -->
                <div class="flex items-center justify-center">
                    <span class="inline-flex items-center rounded-full px-3 py-1 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">${record.spreadType}</span>
                </div>
                
                <!-- Cards Preview (first 3 cards) -->
                <div class="flex justify-center gap-2">
                    ${record.cards.slice(0, 3).map(card => `
                        <div class="w-8 h-12 rounded overflow-hidden border border-yellow-400/30 shadow-lg">
                            <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                        </div>
                    `).join('')}
                    ${record.cards.length > 3 ? `
                        <div class="w-8 h-12 rounded bg-white/10 border border-white/20 flex items-center justify-center">
                            <span class="text-xs text-white/60">+${record.cards.length - 3}</span>
                        </div>
                    ` : ''}
                </div>
                
                <!-- Action Button -->
                <div class="pt-2">
                    <button onclick="viewSpreadRecord('${record.id}')" class="w-full px-4 py-2 text-sm rounded-lg border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10 transition-all duration-300 group-hover:border-yellow-400/50 touch-optimization">
                        <svg class="h-3 w-3 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="9" x2="15" y2="15"></line>
                            <line x1="15" y1="9" x2="9" y2="15"></line>
                        </svg>
                        Î≥¥Í∏∞
                    </button>
                </div>
            `;
            
            return div;
        }
        
        // View spread record popup
        function viewSpreadRecord(recordId) {
            console.log('üé¥ Opening spread record:', recordId);
            
            // Load spread records from localStorage
            const spreadRecords = JSON.parse(localStorage.getItem('spreadRecords') || '[]');
            const record = spreadRecords.find(r => r.id === recordId);
            
            if (!record) {
                alert('Ìï¥Îãπ Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ùÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // Show popup
            document.getElementById('spread-popup').classList.remove('hidden');
            document.getElementById('spread-popup').classList.add('flex');
            
            // Update popup content
            document.getElementById('spread-popup-title').value = record.title;
            document.getElementById('spread-popup-title').dataset.recordId = record.id;
            document.getElementById('spread-popup-type').textContent = record.spreadType;
            document.getElementById('spread-popup-date').textContent = record.dateFormatted;
            
            // Render spread layout only (remove card details)
            renderSpreadPopupLayout(record);
            
            console.log('üìú Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù ÌåùÏóÖ Ïó¥Í∏∞ ÏôÑÎ£å:', record.title);
        }
        
        // Close spread record popup
        function closeSpreadPopup() {
            document.getElementById('spread-popup').classList.add('hidden');
            document.getElementById('spread-popup').classList.remove('flex');
            console.log('üé¥ Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù ÌåùÏóÖ Îã´Í∏∞');
        }
        
        // Render spread layout in popup
        function renderSpreadPopupLayout(record) {
            const layoutContainer = document.getElementById('spread-popup-layout');
            if (!layoutContainer) return;
            
            let layoutHTML = '';
            
            switch (record.layout) {
                case 'single':
                    layoutHTML = `
                        <div class="flex justify-center">
                            <div class="w-16 h-24 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                <img src="${record.cards[0].cardImage}" alt="${record.cards[0].cardName}" class="w-full h-full object-cover">
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'horizontal':
                    layoutHTML = `
                        <div class="flex justify-center gap-2">
                            ${record.cards.map(card => `
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                    
                case 'v-shape':
                    layoutHTML = `
                        <div class="flex flex-col items-center gap-1">
                            <!-- Ï≤´ Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 1, 5 -->
                            <div class="flex justify-center gap-6">
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[0].cardImage}" alt="${record.cards[0].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[4].cardImage}" alt="${record.cards[4].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- Îëê Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 2, 4 -->
                            <div class="flex justify-center gap-1">
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[1].cardImage}" alt="${record.cards[1].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[3].cardImage}" alt="${record.cards[3].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- ÏÑ∏ Î≤àÏß∏ Ï§Ñ: Ïπ¥Îìú 3 -->
                            <div class="flex justify-center">
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[2].cardImage}" alt="${record.cards[2].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'timeline':
                    layoutHTML = `
                        <div class="flex justify-center gap-1">
                            ${record.cards.map(card => `
                                <div class="w-20 h-32 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    break;
                    
                case 'choice':
                    layoutHTML = `
                        <div class="flex justify-center items-center gap-4">
                            <!-- Choice A -->
                            <div class="text-center">
                                <h3 class="text-yellow-400 font-bold mb-2 text-xs">ÏÑ†ÌÉùÏßÄ A</h3>
                                <div class="flex flex-col items-center gap-1">
                                    ${record.cards.slice(0, 3).map(card => `
                                        <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                            <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <!-- Center -->
                            <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                <img src="${record.cards[3].cardImage}" alt="${record.cards[3].cardName}" class="w-full h-full object-cover">
                            </div>
                            <!-- Choice B -->
                            <div class="text-center">
                                <h3 class="text-yellow-400 font-bold mb-2 text-xs">ÏÑ†ÌÉùÏßÄ B</h3>
                                <div class="flex flex-col items-center gap-1">
                                    ${record.cards.slice(4).map(card => `
                                        <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                            <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'celtic-cross':
                    layoutHTML = `
                        <div class="flex justify-center items-center w-full h-full py-4">
                            <div class="celtic-cross-record relative" style="width: 280px; height: 280px;">
                                ${record.cards.map((card, index) => {
                                    const positions = [
                                        { left: '37.5%', top: '45%' }, // Card 1
                                        { left: '37.5%', top: '45%', transform: 'rotate(90deg)' }, // Card 2
                                        { left: '37.5%', top: '10%' }, // Card 3
                                        { left: '37.5%', top: '75%' }, // Card 4
                                        { left: '12.5%', top: '45%' }, // Card 5
                                        { left: '62.5%', top: '45%' }, // Card 6
                                        { left: '87.5%', top: '91%' }, // Card 7
                                        { left: '87.5%', top: '63%' }, // Card 8
                                        { left: '87.5%', top: '35%' }, // Card 9
                                        { left: '87.5%', top: '7%' }   // Card 10
                                    ];
                                    return `
                                        <div class="absolute w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30" style="left: ${positions[index].left}; top: ${positions[index].top}; transform: ${positions[index].transform ? `translate(-50%, -50%) ${positions[index].transform}` : 'translate(-50%, -50%)'};">
                                            <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'cup-shape':
                    layoutHTML = `
                        <div class="flex flex-col items-center gap-1">
                            <!-- ÏµúÏÉÅÎã®: Ïπ¥Îìú 9, 11, 10 -->
                            <div class="flex gap-1.5">
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30" style="transform: translateX(-36px);">
                                    <img src="${record.cards[8].cardImage}" alt="${record.cards[8].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[10].cardImage}" alt="${record.cards[10].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30" style="transform: translateX(36px);">
                                    <img src="${record.cards[9].cardImage}" alt="${record.cards[9].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- Ïπ¥Îìú 7, 8 -->
                            <div class="flex gap-1">
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30" style="transform: translateX(-18px);">
                                    <img src="${record.cards[6].cardImage}" alt="${record.cards[6].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30" style="transform: translateX(18px);">
                                    <img src="${record.cards[7].cardImage}" alt="${record.cards[7].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- Ïπ¥Îìú 5 -->
                            <div class="flex justify-center">
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[4].cardImage}" alt="${record.cards[4].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- Ïπ¥Îìú 4ÏôÄ 6 (3,2Î≤àÍ≥º Ï†ïÎ†¨) -->
                            <div class="flex gap-1.5">
                                <div class="w-9"></div> <!-- 1Î≤à Ïπ¥Îìú ÏûêÎ¶¨ -->
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[3].cardImage}" alt="${record.cards[3].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30" style="transform: translateY(-30px);">
                                    <img src="${record.cards[5].cardImage}" alt="${record.cards[5].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <!-- ÏµúÌïòÎã®: Ïπ¥Îìú 1, 3, 2 -->
                            <div class="flex gap-1.5">
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[0].cardImage}" alt="${record.cards[0].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[2].cardImage}" alt="${record.cards[2].cardName}" class="w-full h-full object-cover">
                                </div>
                                <div class="w-9 h-15 rounded overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${record.cards[1].cardImage}" alt="${record.cards[1].cardName}" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    layoutHTML = `
                        <div class="flex flex-wrap justify-center gap-2">
                            ${record.cards.map(card => `
                                <div class="w-12 h-18 rounded-lg overflow-hidden shadow-lg border border-yellow-400/30">
                                    <img src="${card.cardImage}" alt="${card.cardName}" class="w-full h-full object-cover">
                                </div>
                            `).join('')}
                        </div>
                    `;
            }
            
            layoutContainer.innerHTML = layoutHTML;
        }
        
        // Render spread cards details in popup
        // Save spread title function
        function saveSpreadTitle(newTitle) {
            const titleInput = document.getElementById('spread-popup-title');
            const recordId = titleInput.dataset.recordId;
            
            if (!recordId || !newTitle.trim()) return;
            
            // Update localStorage
            const spreadRecords = JSON.parse(localStorage.getItem('spreadRecords') || '[]');
            const recordIndex = spreadRecords.findIndex(r => r.id === recordId);
            
            if (recordIndex !== -1) {
                spreadRecords[recordIndex].title = newTitle.trim();
                localStorage.setItem('spreadRecords', JSON.stringify(spreadRecords));
                
                // Refresh the records list
                refreshSpreadRecordsList();
                
                console.log('üíæ Ïä§ÌîÑÎ†àÎìú Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏Îê®:', newTitle);
            }
        }
        
        // View daily diary popup
        function viewDailyDiary(date) {
            console.log('üìñ Opening diary for:', date);
            
            // Load actual data from localStorage
            const diaryData = getSavedDiaryData();
            currentDiaryData = diaryData[date] || null;
            
            if (!currentDiaryData) {
                console.error('‚ùå Ìï¥Îãπ ÎÇ†ÏßúÏùò Îç∞Ïù¥ÌÑ∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', date);
                alert('Ìï¥Îãπ ÎÇ†ÏßúÏùò ÏùºÍ∏∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // Show popup
            document.getElementById('diary-popup').classList.remove('hidden');
            document.getElementById('diary-popup').classList.add('flex');
            
            // Update popup content
            document.getElementById('diary-date').textContent = currentDiaryData.date;
            
            // Render all cards
            renderDiaryCards();
            
            // Show first card (hour 0)
            showDiaryCard(0);
        }
        
        // Render all 24 cards in horizontal scroll (Mobile Optimized)
        function renderDiaryCards() {
            const cardsContainer = document.getElementById('diary-cards-container');
            cardsContainer.innerHTML = '';
            
            currentDiaryData.cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'flex-shrink-0 w-16 h-24 rounded-lg overflow-hidden border-2 border-transparent shadow-lg cursor-pointer transition-all duration-300 relative touch-optimization';
                cardElement.onclick = () => showDiaryCard(index);
                cardElement.dataset.hour = index;
                cardElement.style.scrollSnapAlign = 'start';
                
                const hasMemo = card.memo && card.memo.trim() !== '';
                
                cardElement.innerHTML = `
                    <img src="${card.image}" alt="${card.name}" class="w-full h-full object-cover">
                    <div class="absolute bottom-0 left-0 right-0 bg-black/90 text-white text-xs py-0.5 px-1 text-center font-medium">
                        ${index}Ïãú
                    </div>
                    ${hasMemo ? `
                        <div class="absolute top-0.5 right-0.5 w-2.5 h-2.5 bg-yellow-400 rounded-full flex items-center justify-center">
                            <svg class="w-1.5 h-1.5 text-black" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                            </svg>
                        </div>
                    ` : ''}
                `;
                
                cardsContainer.appendChild(cardElement);
            });
        }
        
        // Show specific card and its memo
        function showDiaryCard(hour) {
            currentDiaryHour = hour;
            const card = currentDiaryData.cards[hour];
            
            // Update active card highlight
            document.querySelectorAll('#diary-cards-container > div').forEach((el, index) => {
                if (index === hour) {
                    el.classList.add('border-yellow-400', 'ring-2', 'ring-yellow-400/50');
                    el.classList.remove('border-transparent');
                    // Scroll to center
                    el.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                } else {
                    el.classList.remove('border-yellow-400', 'ring-2', 'ring-yellow-400/50');
                    el.classList.add('border-transparent');
                }
            });
            
            // Update card details
            document.getElementById('diary-card-name').textContent = card.name;
            document.getElementById('diary-card-hour').textContent = `${hour}Ïãú`;
            document.getElementById('diary-card-image').src = card.image;
            document.getElementById('diary-card-image').alt = card.name;
            
            // Update memo
            document.getElementById('diary-memo-text').value = card.memo || '';
            
            console.log(`üìñ ${hour}Ïãú Ïπ¥Îìú ÏÑ†ÌÉù:`, card.name, 'Î©îÎ™®:', card.memo || 'ÏóÜÏùå');
        }
        
        // Save diary memo
        function saveDiaryMemo() {
            const memo = document.getElementById('diary-memo-text').value;
            const card = currentDiaryData.cards[currentDiaryHour];
            
            // Update memo in current data
            card.memo = memo;
            
            // Save to localStorage
            const diaryData = getSavedDiaryData();
            if (diaryData[currentDiaryData.dateKey]) {
                diaryData[currentDiaryData.dateKey].cards[currentDiaryHour].memo = memo;
                saveDiaryData(diaryData);
                
                // Refresh diary list to show updated memo count
                refreshDiaryList();
            }
            
            // Re-render cards to update star indicators
            renderDiaryCards();
            showDiaryCard(currentDiaryHour);
            
            // Show confirmation
            showDiaryMemoSaveConfirmation();
            
            console.log(`üíæ ${currentDiaryHour}Ïãú Î©îÎ™® Ï†ÄÏû•:`, memo);
        }
        
        // Show diary memo save confirmation
        function showDiaryMemoSaveConfirmation() {
            const button = document.querySelector('button[onclick="saveDiaryMemo()"]');
            const originalHTML = button.innerHTML;
            
            button.innerHTML = `
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Ï†ÄÏû• ÏôÑÎ£å
            `;
            button.classList.add('bg-green-500/20', 'border-green-400/30', 'text-green-400');
            button.classList.remove('bg-yellow-400/10', 'border-yellow-400/30', 'text-yellow-400');
            
            setTimeout(() => {
                button.innerHTML = originalHTML;
                button.classList.remove('bg-green-500/20', 'border-green-400/30', 'text-green-400');
                button.classList.add('bg-yellow-400/10', 'border-yellow-400/30', 'text-yellow-400');
            }, 2000);
        }
        
        // Close diary popup
        function closeDiaryPopup() {
            document.getElementById('diary-popup').classList.add('hidden');
            document.getElementById('diary-popup').classList.remove('flex');
            currentDiaryData = null;
            currentDiaryHour = 0;
            console.log('üìñ ÏùºÍ∏∞ ÌåùÏóÖ Îã´Í∏∞');
        }

        // =====================================
        // üéØ Enhanced Image Loading System
        // =====================================

        // Ïπ¥ÎìúÎ≥Ñ ÎßûÏ∂§ ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Ïù¥Î™®Ìã∞ÏΩò
        const cardPlaceholders = {
            'The Fool': 'üÉè',
            'The Magician': 'üé©',
            'The High Priestess': 'üåô',
            'The Empress': 'üëë',
            'The Emperor': '‚ö°',
            'The Hierophant': 'üìø',
            'The Lovers': 'üíï',
            'The Chariot': 'üèõÔ∏è',
            'Strength': 'ü¶Å',
            'The Hermit': 'üïØÔ∏è',
            'Wheel of Fortune': 'üé°',
            'Justice': '‚öñÔ∏è',
            'The Hanged Man': 'üôÉ',
            'Death': 'üíÄ',
            'Temperance': 'üç∑',
            'The Devil': 'üëπ',
            'The Tower': 'üóº',
            'The Star': '‚≠ê',
            'The Moon': 'üåô',
            'The Sun': '‚òÄÔ∏è',
            'Judgement': 'üìØ',
            'The World': 'üåç',
            // Minor Arcana Í∏∞Î≥∏Í∞íÎì§
            'Ace of Cups': 'üèÜ',
            'Two of Cups': 'üíù',
            'Three of Cups': 'üéâ',
            'Four of Cups': 'ü§î',
            'Five of Cups': 'üò¢',
            'Six of Cups': 'üí≠',
            'Seven of Cups': 'üåà',
            'Eight of Cups': 'üö∂',
            'Nine of Cups': 'üòä',
            'Ten of Cups': 'üè°'
        };

        // Ïπ¥Îìú ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Í∞ÄÏ†∏Ïò§Í∏∞
        function getCardPlaceholder(cardName) {
            return cardPlaceholders[cardName] || 'üîÆ';
        }

        // Enhanced Ïπ¥Îìú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ìï®Ïàò
        function createEnhancedCardImage(card, containerElement, options = {}) {
            const {
                showLoading = true,
                enableFlip = false,
                size = 'normal', // 'small', 'normal', 'large'
                onLoadComplete = null,
                enablePopup = true, // ÌåùÏóÖ ÌÅ¥Î¶≠ ÌôúÏÑ±Ìôî Ïó¨Î∂Ä
                position = null // Ïπ¥Îìú Ìè¨ÏßÄÏÖò Ï†ïÎ≥¥
            } = options;

            // Ïª®ÌÖåÏù¥ÎÑà Ïä§ÌÉÄÏùº ÏÑ§Ï†ï
            containerElement.classList.add('relative', 'overflow-hidden');
            if (enableFlip) {
                containerElement.classList.add('card-flip');
            }

            // Î°úÎî© ÏÉÅÌÉú ÌëúÏãú
            if (showLoading) {
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'absolute inset-0 bg-gradient-to-br from-purple-900/50 to-blue-900/50 flex items-center justify-center backdrop-blur-sm z-10 transition-opacity duration-500';
                loadingDiv.innerHTML = `
                    <div class="text-center animate-pulse">
                        <div class="animate-spin w-6 h-6 border-2 border-yellow-400 border-t-transparent rounded-full mb-2 mx-auto"></div>
                        <div class="text-yellow-400 text-xs font-medium">Ïπ¥Îìú Î°úÎî©Ï§ë...</div>
                    </div>
                `;
                containerElement.appendChild(loadingDiv);
            }

            // Ïù¥ÎØ∏ÏßÄ ÏöîÏÜå ÏÉùÏÑ±
            const img = document.createElement('img');
            img.src = card.image;
            img.alt = card.name;
            img.className = 'w-full h-full object-cover transition-all duration-500';

            // Îí§ÏßëÍ∏∞ Ïï†ÎãàÎ©îÏù¥ÏÖòÏö© ÎûòÌçº
            if (enableFlip) {
                const flipInner = document.createElement('div');
                flipInner.className = 'card-flip-inner w-full h-full relative';
                
                const cardBack = document.createElement('div');
                cardBack.className = 'card-back absolute inset-0 bg-gradient-to-br from-purple-900 to-blue-900 flex items-center justify-center rounded-lg border-2 border-yellow-400/50';
                cardBack.innerHTML = `
                    <div class="text-center text-yellow-400">
                        <div class="text-2xl mb-1">üîÆ</div>
                        <div class="text-xs opacity-80">ÌÉÄÎ°úÏπ¥Îìú</div>
                    </div>
                `;

                const cardFront = document.createElement('div');
                cardFront.className = 'card-front absolute inset-0';
                cardFront.appendChild(img);

                flipInner.appendChild(cardBack);
                flipInner.appendChild(cardFront);
                containerElement.appendChild(flipInner);
            } else {
                containerElement.appendChild(img);
            }

            // Ïù¥ÎØ∏ÏßÄ Î°úÎìú ÏÑ±Í≥µ Ï≤òÎ¶¨
            img.onload = () => {
                console.log(`‚úÖ Ïù¥ÎØ∏ÏßÄ Î°úÎìú ÏÑ±Í≥µ: ${card.name}`);
                
                if (showLoading) {
                    const loadingDiv = containerElement.querySelector('.absolute.inset-0');
                    if (loadingDiv) {
                        loadingDiv.style.opacity = '0';
                        setTimeout(() => {
                            loadingDiv.remove();
                        }, 300);
                    }
                }

                // Îí§ÏßëÍ∏∞ Ìö®Í≥º Ïã§Ìñâ
                if (enableFlip) {
                    setTimeout(() => {
                        containerElement.classList.add('flipped');
                    }, 500);
                }

                // ÏÑ±Í≥µ ÏΩúÎ∞± Ïã§Ìñâ
                if (onLoadComplete) {
                    onLoadComplete(true, card);
                }
            };

            // Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå® Ï≤òÎ¶¨
            img.onerror = () => {
                console.log(`‚ùå Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®: ${card.name}`);
                
                const placeholder = document.createElement('div');
                placeholder.className = 'absolute inset-0 bg-gradient-to-br from-purple-900/70 to-blue-900/70 flex items-center justify-center text-center p-3 backdrop-blur-sm border-2 border-yellow-400/30 rounded-lg';
                placeholder.innerHTML = `
                    <div class="text-white">
                        <div class="text-3xl mb-2 animate-pulse">${getCardPlaceholder(card.name)}</div>
                        <div class="font-medium text-sm leading-tight">${card.name}</div>
                        <div class="text-xs opacity-60 mt-1">Ïã†ÎπÑÎ°úÏö¥ Ïπ¥Îìú</div>
                    </div>
                `;

                // Î°úÎî© ÌëúÏãú Ï†úÍ±∞
                const loadingDiv = containerElement.querySelector('.absolute.inset-0');
                if (loadingDiv && loadingDiv !== placeholder) {
                    loadingDiv.remove();
                }

                containerElement.appendChild(placeholder);

                // Ïã§Ìå® ÏΩúÎ∞± Ïã§Ìñâ
                if (onLoadComplete) {
                    onLoadComplete(false, card);
                }
            };

            // ÌåùÏóÖ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
            if (enablePopup) {
                containerElement.style.cursor = 'pointer';
                containerElement.addEventListener('click', () => {
                    showCardPopup(card, position);
                });
                
                // Ìò∏Î≤Ñ Ìö®Í≥º Ï∂îÍ∞Ä
                containerElement.addEventListener('mouseenter', () => {
                    containerElement.style.transform = 'scale(1.05)';
                    containerElement.style.transition = 'transform 0.2s ease';
                });
                
                containerElement.addEventListener('mouseleave', () => {
                    containerElement.style.transform = 'scale(1)';
                });
            }

            return containerElement;
        }

        // Ïù¥ÎØ∏ÏßÄ ÌîÑÎ¶¨Î°úÎî© ÏãúÏä§ÌÖú
        let preloadedImages = new Set();

        function preloadImage(imageSrc) {
            return new Promise((resolve, reject) => {
                if (preloadedImages.has(imageSrc)) {
                    resolve(imageSrc);
                    return;
                }

                const img = new Image();
                img.onload = () => {
                    preloadedImages.add(imageSrc);
                    console.log(`üöÄ ÌîÑÎ¶¨Î°úÎìú ÏôÑÎ£å: ${imageSrc}`);
                    resolve(imageSrc);
                };
                img.onerror = () => {
                    console.log(`‚ùå ÌîÑÎ¶¨Î°úÎìú Ïã§Ìå®: ${imageSrc}`);
                    reject(imageSrc);
                };
                img.src = imageSrc;
            });
        }

        // Ï§ëÏöîÌïú Ïπ¥ÎìúÎì§ ÌîÑÎ¶¨Î°úÎî©
        function preloadImportantCards() {
            if (!dailyCards || dailyCards.length === 0) return;

            const currentHour = new Date().getHours();
            const importantIndexes = [
                currentHour, // ÌòÑÏû¨ ÏãúÍ∞Ñ
                (currentHour + 1) % 24, // Îã§Ïùå ÏãúÍ∞Ñ
                (currentHour - 1 + 24) % 24, // Ïù¥Ï†Ñ ÏãúÍ∞Ñ
                (currentHour + 2) % 24, // 2ÏãúÍ∞Ñ ÌõÑ
                (currentHour - 2 + 24) % 24 // 2ÏãúÍ∞Ñ Ï†Ñ
            ];

            console.log(`üöÄ Ï§ëÏöîÌïú Ïπ¥ÎìúÎì§ ÌîÑÎ¶¨Î°úÎî© ÏãúÏûë (ÌòÑÏû¨ ÏãúÍ∞Ñ: ${currentHour}Ïãú)`);

            const preloadPromises = importantIndexes
                .filter((index, pos, arr) => arr.indexOf(index) === pos) // Ï§ëÎ≥µ Ï†úÍ±∞
                .map(index => {
                    const card = dailyCards[index];
                    if (card) {
                        return preloadImage(card.image);
                    }
                    return Promise.resolve();
                });

            Promise.allSettled(preloadPromises).then(results => {
                const successCount = results.filter(r => r.status === 'fulfilled').length;
                console.log(`‚úÖ ÌîÑÎ¶¨Î°úÎî© ÏôÑÎ£å: ${successCount}/${preloadPromises.length} ÏÑ±Í≥µ`);
            });
        }

        // Ïπ¥Îìú ÌåùÏóÖ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function showCardPopup(card, position = null) {
            const overlay = document.getElementById('cardPopupOverlay');
            const image = document.getElementById('cardPopupImage');
            const name = document.getElementById('cardPopupName');
            const positionText = document.getElementById('cardPopupPosition');
            
            // ÌåùÏóÖ ÎÇ¥Ïö© ÏÑ§Ï†ï
            image.src = card.image;
            image.alt = card.name;
            name.textContent = card.name;
            positionText.textContent = position ? `Ìè¨ÏßÄÏÖò: ${position}` : 'ÌÉÄÎ°úÏπ¥Îìú';
            
            // ÌåùÏóÖ ÌëúÏãú
            overlay.style.display = 'flex';
            setTimeout(() => {
                overlay.classList.add('active');
            }, 10);
            
            // ESC ÌÇ§Î°ú Îã´Í∏∞
            document.addEventListener('keydown', handleEscapeKey);
        }

        function closeCardPopup() {
            const overlay = document.getElementById('cardPopupOverlay');
            overlay.classList.remove('active');
            
            setTimeout(() => {
                overlay.style.display = 'none';
            }, 300);
            
            // ESC ÌÇ§ Ïù¥Î≤§Ìä∏ Ï†úÍ±∞
            document.removeEventListener('keydown', handleEscapeKey);
        }

        function handleEscapeKey(event) {
            if (event.key === 'Escape') {
                closeCardPopup();
            }
        }

        // Ïï± Ï¥àÍ∏∞Ìôî Ïãú ÌîÑÎ¶¨Î°úÎî© Ïã§Ìñâ
        function initializeImageSystem() {
            console.log('üéØ Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ï§ë...');
            
            // Ï§ëÏöîÌïú Ïπ¥ÎìúÎì§ ÌîÑÎ¶¨Î°úÎî©
            if (dailyCards && dailyCards.length > 0) {
                preloadImportantCards();
            }

            // 5Î∂ÑÎßàÎã§ Îã§Ïùå ÏãúÍ∞Ñ Ïπ¥Îìú ÌîÑÎ¶¨Î°úÎî©
            setInterval(() => {
                const nextHour = (new Date().getHours() + 1) % 24;
                const nextCard = dailyCards[nextHour];
                if (nextCard && !preloadedImages.has(nextCard.image)) {
                    preloadImage(nextCard.image);
                }
            }, 5 * 60 * 1000); // 5Î∂Ñ

            console.log('‚úÖ Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        // Í∏∞Ï°¥ Ïπ¥Îìú ÏÉùÏÑ± Ìï®ÏàòÎì§ÏùÑ Enhanced Î≤ÑÏ†ÑÏúºÎ°ú ÏóÖÍ∑∏Î†àÏù¥Îìú
        function updateExistingCardDisplays() {
            // Î©îÏù∏ ÌòÑÏû¨ Ïπ¥Îìú ÌëúÏãú Í∞úÏÑ†
            const mainCardImg = document.querySelector('#timer-content img[alt="ÌÉÄÎ°ú Ïπ¥Îìú"]');
            if (mainCardImg && mainCardImg.parentElement) {
                const container = mainCardImg.parentElement;
                const currentCard = dailyCards[new Date().getHours()];
                if (currentCard) {
                    container.innerHTML = '';
                    createEnhancedCardImage(currentCard, container, {
                        showLoading: true,
                        enableFlip: false,
                        size: 'large'
                    });
                }
            }

            // 24ÏãúÍ∞Ñ Ïπ¥Îìú Ïä§ÌÅ¨Î°§ Í∞úÏÑ†
            updateHourlyCardsDisplay();
        }

        // ÏãúÍ∞ÑÎ≥Ñ Ïπ¥Îìú ÌëúÏãú Í∞úÏÑ†
        function updateHourlyCardsDisplay() {
            const hourlyCards = document.querySelectorAll('#timer-content [id$="Ïãú"] img');
            hourlyCards.forEach((img, index) => {
                if (dailyCards[index] && img.parentElement) {
                    const container = img.parentElement;
                    container.innerHTML = '';
                    createEnhancedCardImage(dailyCards[index], container, {
                        showLoading: false,
                        enableFlip: false,
                        size: 'small'
                    });
                }
            });
        }

        // 24ÏãúÍ∞Ñ Ïπ¥Îìú ÏÉùÏÑ± Ïãú Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Ï†ÅÏö©
        const originalDrawAll24Cards = window.drawAll24Cards;
        window.drawAll24Cards = function() {
            // ÏõêÎûò Ìï®Ïàò Ïã§Ìñâ
            if (originalDrawAll24Cards) {
                originalDrawAll24Cards();
            }

            // Ïπ¥Îìú ÏÉùÏÑ± ÌõÑ Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Ï†ÅÏö©
            setTimeout(() => {
                preloadImportantCards();
                updateExistingCardDisplays();
            }, 100);
        };

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeImageSystem();
                
                // Ïù¥ÎØ∏ Ïπ¥ÎìúÍ∞Ä ÏûàÎã§Î©¥ ÌëúÏãú Í∞úÏÑ†
                if (dailyCards && dailyCards.length > 0) {
                    updateExistingCardDisplays();
                }
            }, 1000);
        });

        console.log('üéØ Enhanced Image Loading System Î°úÎìú ÏôÑÎ£å');
    </script>

    <!-- Card Popup Modal -->
    <div id="card-popup" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-gradient-to-b from-slate-900 to-slate-800 rounded-2xl border border-yellow-400/30 max-w-sm w-full space-y-6 p-6 animate-mystical-glow">
            <!-- Header -->
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12,6 12,12 16,14"></polyline>
                    </svg>
                    <h3 id="popup-hour" class="title-medium text-white">ÏûêÏ†ï</h3>
                </div>
                <button onclick="closeCardPopup()" class="text-white/60 hover:text-white transition-colors p-1">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Card Image -->
            <div class="flex justify-center">
                <div class="relative">
                    <div class="absolute -inset-2 bg-yellow-400/30 blur-xl rounded-2xl"></div>
                    <div class="relative w-32 h-48 rounded-xl overflow-hidden shadow-2xl border border-yellow-400/50">
                        <img id="popup-card-image" src="assets/tarot-cards/classic-tarot/major_00_fool.jpg" alt="ÌÉÄÎ°ú Ïπ¥Îìú" class="w-full h-full object-cover">
                    </div>
                </div>
            </div>
            
            <!-- Memo Area -->
            <div class="space-y-3">
                <div class="flex items-center gap-2">
                    <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    <label class="title-small text-white">Î©îÎ™®</label>
                </div>
                <textarea 
                    id="popup-memo" 
                    placeholder="Ïù¥ ÏãúÍ∞ÑÏóê ÎåÄÌïú ÏÉùÍ∞ÅÏù¥ÎÇò ÎäêÎÇåÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî..."
                    class="w-full h-24 p-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/50 body-small resize-none focus:outline-none focus:border-yellow-400/50 focus:bg-white/10 transition-all">
                </textarea>
            </div>
            
            <!-- Buttons -->
            <div class="flex gap-3">
                <button onclick="closeCardPopup()" class="flex-1 py-3 px-4 rounded-xl border border-white/20 text-white hover:bg-white/10 transition-all">
                    Îã´Í∏∞
                </button>
                <button onclick="saveMemo()" class="flex-1 py-3 px-4 rounded-xl bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-semibold hover:from-yellow-500 hover:to-yellow-600 transition-all">
                    Ï†ÄÏû•
                </button>
            </div>
        </div>
    </div>

    <!-- Diary View Popup Modal (Mobile Optimized) -->
    <div id="diary-popup" class="fixed inset-0 bg-black/80 backdrop-blur-mystical z-50 hidden items-center justify-center p-4">
        <div class="bg-gradient-to-b from-slate-900 to-slate-800 rounded-2xl border border-yellow-400/30 max-w-md w-full max-h-[90vh] flex flex-col animate-mystical-glow">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b border-white/10">
                <div class="flex items-center gap-2">
                    <svg class="h-5 w-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                    </svg>
                    <h2 id="diary-date" class="title-medium text-white">2025ÎÖÑ 1Ïõî 4Ïùº Í∏àÏöîÏùº</h2>
                </div>
                <button onclick="closeDiaryPopup()" class="text-white/60 hover:text-white transition-colors p-1 rounded-lg hover:bg-white/10 touch-optimization">
                    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Top Section - 24ÏãúÍ∞Ñ ÌÉÄÎ°ú Ïπ¥Îìú (Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§) -->
            <div class="p-4 border-b border-white/10">
                <div class="flex items-center gap-2 mb-3">
                    <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12,6 12,12 16,14"></polyline>
                    </svg>
                    <h3 class="title-small text-white">24ÏãúÍ∞Ñ ÌÉÄÎ°ú Ïπ¥Îìú</h3>
                </div>
                
                <!-- Cards Horizontal Scroll -->
                <div class="relative">
                    <div id="diary-cards-container" class="flex gap-2 overflow-x-auto pb-2 scrollbar-none touch-optimization" style="scroll-snap-type: x mandatory;">
                        <!-- Cards will be rendered here by JavaScript -->
                    </div>
                    
                    <!-- Scroll indicators -->
                    <div class="absolute top-0 left-0 w-6 h-full bg-gradient-to-r from-slate-900 to-transparent pointer-events-none opacity-50"></div>
                    <div class="absolute top-0 right-0 w-6 h-full bg-gradient-to-l from-slate-900 to-transparent pointer-events-none opacity-50"></div>
                </div>
            </div>

            <!-- Middle Section - ÏÑ†ÌÉùÎêú Ïπ¥ÎìúÏôÄ Î©îÎ™® -->
            <div class="flex-1 p-4 overflow-y-auto">
                <!-- Selected Card Info -->
                <div class="text-center mb-4">
                    <div class="flex items-center justify-center gap-2 mb-3">
                        <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12,6 12,12 16,14"></polyline>
                        </svg>
                        <span id="diary-card-hour" class="title-small text-white">0Ïãú</span>
                    </div>
                    
                    <!-- Card Image -->
                    <div class="relative mb-3 inline-block">
                        <div class="absolute -inset-1 bg-yellow-400/30 blur-xl rounded-xl"></div>
                        <div class="relative w-20 h-32 rounded-lg overflow-hidden shadow-lg border border-yellow-400/50">
                            <img id="diary-card-image" src="assets/tarot-cards/classic-tarot/major_00_fool.jpg" alt="ÌÉÄÎ°ú Ïπ¥Îìú" class="w-full h-full object-cover">
                        </div>
                    </div>
                    
                    <h4 id="diary-card-name" class="body-medium text-white">The Fool</h4>
                </div>
                
                <!-- Memo Section -->
                <div class="space-y-3">
                    <div class="flex items-center gap-2">
                        <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        <label class="title-small text-white">Î©îÎ™®</label>
                    </div>
                    
                    <textarea 
                        id="diary-memo-text" 
                        placeholder="Ïù¥ ÏãúÍ∞ÑÎåÄÏóê ÎåÄÌïú ÏÉùÍ∞ÅÏù¥ÎÇò ÎäêÎÇåÏùÑ Í∏∞Î°ùÌï¥Î≥¥ÏÑ∏Ïöî..."
                        class="w-full h-24 p-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/50 body-small resize-none focus:outline-none focus:border-yellow-400/50 focus:bg-white/10 transition-all">
                    </textarea>
                    
                    <!-- Save Button -->
                    <button 
                        onclick="saveDiaryMemo()" 
                        class="w-full py-2.5 px-4 rounded-lg bg-yellow-400/10 border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/20 transition-all duration-300 flex items-center justify-center gap-2 touch-optimization">
                        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        Î©îÎ™® Ï†ÄÏû•
                    </button>
                </div>
            </div>

            <!-- Bottom Section - ÏïàÎÇ¥Î¨∏Íµ¨ Î∞è Îã´Í∏∞ -->
            <div class="p-4 border-t border-white/10 space-y-3">
                <div class="flex items-center justify-center gap-2 text-white/60">
                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="caption text-center">Ïπ¥ÎìúÎ•º ÌÑ∞ÏπòÌï¥ÏÑú Îã§Î•∏ ÏãúÍ∞ÑÎåÄÎ•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî</span>
                </div>
                <button 
                    onclick="closeDiaryPopup()" 
                    class="w-full py-3 px-4 rounded-lg border border-white/20 text-white hover:bg-white/10 transition-all touch-optimization">
                    Îã´Í∏∞
                </button>
            </div>
        </div>
    </div>

    <!-- Spread Record Popup Modal (Mobile Optimized) -->
    <div id="spread-popup" class="fixed inset-0 bg-black/80 backdrop-blur-mystical z-50 hidden items-center justify-center p-4">
        <div class="bg-gradient-to-b from-slate-900 to-slate-800 rounded-2xl border border-yellow-400/30 max-w-md w-full max-h-[90vh] flex flex-col animate-mystical-glow">
            <!-- Header -->
            <div class="p-3 border-b border-white/10">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2 flex-1">
                        <svg class="h-4 w-4 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="9" x2="15" y2="15"></line>
                            <line x1="15" y1="9" x2="9" y2="15"></line>
                        </svg>
                        <input type="text" id="spread-popup-title" class="text-base font-medium text-white bg-transparent border-none outline-none flex-1 focus:text-yellow-400 transition-colors" value="Ïä§ÌîÑÎ†àÎìú Í∏∞Î°ù" onblur="saveSpreadTitle(this.value)">
                    </div>
                    <button onclick="closeSpreadPopup()" class="text-white/60 hover:text-white transition-colors ml-3 text-lg leading-none w-6 h-6 flex items-center justify-center">
                        √ó
                    </button>
                </div>
                <div class="flex items-center justify-between text-sm">
                    <span id="spread-popup-type" class="inline-flex items-center rounded-full px-2 py-1 text-xs bg-yellow-400/20 text-yellow-400 border border-yellow-400/30">
                        3Ïπ¥Îìú Ïä§ÌîÑÎ†àÎìú
                    </span>
                    <span id="spread-popup-date" class="text-white/50">2025.01.04</span>
                </div>
            </div>


            <!-- Spread Cards Display -->
            <div class="flex-1 p-4 overflow-y-auto custom-scrollbar">
                <div class="flex justify-center items-center min-h-[300px]">
                    <!-- Cards Layout Container -->
                    <div id="spread-popup-layout" class="w-full">
                        <!-- Dynamic layout will be inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="p-2 border-t border-white/10">
                <div class="flex justify-end">
                    <button 
                        onclick="closeSpreadPopup()" 
                        class="px-3 py-1 text-sm rounded border border-white/20 text-white/70 hover:bg-white/10 hover:text-white transition-all">
                        Îã´Í∏∞
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>