<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>타로 타이머 프로토타입</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            /* 브랜드 색상 */
            --background: #0f0f1a;
            --foreground: #ffffff;
            --card: #1a1f3a;
            --card-foreground: #ffffff;
            --primary: #4a1a4f;
            --secondary: #1a1f3a;
            --secondary-foreground: #c8b8d4;
            --accent: #f4d03f;
            --accent-foreground: #0f0f1a;
            --border: #2a2f4a;
            --premium-gold: #f4d03f;
            --deep-purple: #4a1a4f;
            --midnight-blue: #1a1f3a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--midnight-blue) 0%, var(--deep-purple) 50%, var(--midnight-blue) 100%);
            color: var(--foreground);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* 애니메이션 */
        @keyframes mystical-pulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1); 
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.02); 
            }
        }

        .mystical-pulse {
            animation: mystical-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(244, 208, 63, 0.3);
            }
            50% { 
                box-shadow: 0 0 40px rgba(244, 208, 63, 0.6);
            }
        }

        .glow-effect {
            animation: glow 2s ease-in-out infinite;
        }

        /* 컨테이너 */
        .app-container {
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--background);
            position: relative;
            overflow: hidden;
        }

        /* 헤더 */
        .header {
            padding: 44px 20px 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--premium-gold) 0%, #ffffff 50%, var(--premium-gold) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: var(--secondary-foreground);
            font-size: 16px;
        }

        /* 네비게이션 탭 */
        .nav-tabs {
            display: flex;
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(16px);
            border-radius: 16px;
            margin: 0 20px;
            padding: 4px;
            position: relative;
        }

        .nav-tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .nav-tab.active {
            background: var(--primary);
            color: var(--foreground);
            box-shadow: 0 4px 12px rgba(74, 26, 79, 0.3);
        }

        .nav-tab:not(.active) {
            color: var(--secondary-foreground);
        }

        /* 메인 콘텐츠 */
        .main-content {
            padding: 20px;
            min-height: calc(100vh - 180px);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* 스프레드 선택 화면 */
        .spread-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-top: 24px;
        }

        .spread-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .spread-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--premium-gold) 0%, var(--accent) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .spread-card:hover,
        .spread-card.selected {
            border-color: var(--premium-gold);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(244, 208, 63, 0.2);
        }

        .spread-card:hover::before,
        .spread-card.selected::before {
            opacity: 1;
        }

        .spread-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
        }

        .spread-description {
            color: var(--secondary-foreground);
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .spread-cards {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .spread-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--premium-gold);
            font-size: 14px;
            font-weight: 600;
        }

        .spread-time {
            color: var(--secondary-foreground);
            font-size: 12px;
        }

        /* 타이머 화면 */
        .timer-container {
            text-align: center;
            padding: 40px 0;
        }

        .timer-circle {
            width: 280px;
            height: 280px;
            margin: 0 auto 40px;
            position: relative;
        }

        .circle-progress {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(var(--premium-gold) 0deg, transparent 0deg);
            padding: 8px;
            transition: all 0.1s ease;
        }

        .circle-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--card);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--border);
        }

        .timer-time {
            font-size: 48px;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .timer-label {
            color: var(--secondary-foreground);
            font-size: 16px;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .control-btn {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.2s ease;
            position: relative;
        }

        .control-btn.primary {
            background: var(--primary);
            color: var(--foreground);
            box-shadow: 0 4px 16px rgba(74, 26, 79, 0.3);
        }

        .control-btn.primary:active {
            transform: scale(0.95);
        }

        .control-btn.secondary {
            background: var(--secondary);
            color: var(--secondary-foreground);
            border: 2px solid var(--border);
        }

        .current-spread {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .current-spread h3 {
            color: var(--premium-gold);
            font-size: 16px;
            margin-bottom: 8px;
        }

        .current-spread p {
            color: var(--secondary-foreground);
            font-size: 14px;
        }

        /* 세션 기록 화면 */
        .sessions-list {
            margin-top: 20px;
        }

        .session-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .session-spread {
            color: var(--premium-gold);
            font-weight: 600;
        }

        .session-date {
            color: var(--secondary-foreground);
            font-size: 12px;
        }

        .session-duration {
            color: var(--foreground);
            font-size: 18px;
            font-weight: 700;
        }

        /* 버튼 */
        .btn {
            background: var(--primary);
            color: var(--foreground);
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-top: 20px;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn.secondary {
            background: transparent;
            color: var(--secondary-foreground);
            border: 2px solid var(--border);
        }

        /* 설정 화면 */
        .settings-group {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .settings-group h3 {
            color: var(--premium-gold);
            font-size: 16px;
            margin-bottom: 16px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: var(--foreground);
            font-size: 14px;
        }

        .setting-value {
            color: var(--secondary-foreground);
            font-size: 14px;
        }

        /* 반응형 */
        @media (max-width: 375px) {
            .timer-circle {
                width: 240px;
                height: 240px;
            }
            
            .timer-time {
                font-size: 36px;
            }
            
            .header h1 {
                font-size: 24px;
            }
        }

        /* 상태 표시 */
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-ready { background: var(--premium-gold); }
        .status-running { background: #22c55e; }
        .status-paused { background: #f59e0b; }
        .status-finished { background: #ef4444; }

        /* 빈 상태 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--secondary-foreground);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--foreground);
        }

        .empty-state p {
            font-size: 14px;
            line-height: 1.4;
        }

        /* 로딩 애니메이션 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--premium-gold);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 헤더 -->
        <div class="header">
            <h1 class="mystical-pulse">🔮 타로 타이머</h1>
            <p>신비로운 여정을 시작하세요</p>
        </div>

        <!-- 네비게이션 탭 -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-screen="spreads">스프레드</div>
            <div class="nav-tab" data-screen="timer">타이머</div>
            <div class="nav-tab" data-screen="sessions">세션</div>
            <div class="nav-tab" data-screen="settings">설정</div>
        </div>

        <!-- 메인 콘텐츠 -->
        <div class="main-content">
            <!-- 스프레드 선택 화면 -->
            <div id="spreads" class="screen active">
                <div class="spread-grid">
                    <div class="spread-card" data-spread="past-present-future">
                        <div class="spread-name">과거-현재-미래</div>
                        <div class="spread-description">시간의 흐름 속에서 상황을 파악하고 미래를 준비하세요</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>🔮</span>
                                <span>3장의 카드</span>
                            </div>
                            <div class="spread-time">15분 권장</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="love-relationship">
                        <div class="spread-name">연애운</div>
                        <div class="spread-description">사랑과 관계에 대한 깊은 통찰을 얻어보세요</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>💕</span>
                                <span>5장의 카드</span>
                            </div>
                            <div class="spread-time">25분 권장</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="career-money">
                        <div class="spread-name">직업과 금전운</div>
                        <div class="spread-description">커리어와 재정에 관한 조언을 구해보세요</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>💰</span>
                                <span>4장의 카드</span>
                            </div>
                            <div class="spread-time">20분 권장</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="celtic-cross">
                        <div class="spread-name">셀틱 크로스</div>
                        <div class="spread-description">가장 전통적이고 포괄적인 타로 스프레드</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>✨</span>
                                <span>10장의 카드</span>
                            </div>
                            <div class="spread-time">45분 권장</div>
                        </div>
                    </div>

                    <div class="spread-card" data-spread="daily-guidance">
                        <div class="spread-name">오늘의 가이던스</div>
                        <div class="spread-description">하루를 시작하기 전 필요한 조언을 받아보세요</div>
                        <div class="spread-cards">
                            <div class="spread-info">
                                <span>🌅</span>
                                <span>1장의 카드</span>
                            </div>
                            <div class="spread-time">5분 권장</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 타이머 화면 -->
            <div id="timer" class="screen">
                <div id="timer-content">
                    <div class="empty-state">
                        <div class="empty-state-icon">⏱️</div>
                        <h3>스프레드를 선택해주세요</h3>
                        <p>먼저 스프레드 탭에서 원하는 스프레드를 선택하세요</p>
                    </div>
                </div>
            </div>

            <!-- 세션 기록 화면 -->
            <div id="sessions" class="screen">
                <div id="sessions-content">
                    <div class="empty-state">
                        <div class="empty-state-icon">📚</div>
                        <h3>아직 기록된 세션이 없습니다</h3>
                        <p>첫 번째 타로 세션을 시작해보세요</p>
                    </div>
                </div>
            </div>

            <!-- 설정 화면 -->
            <div id="settings" class="screen">
                <div class="settings-group">
                    <h3>타이머 설정</h3>
                    <div class="setting-item">
                        <div class="setting-label">자동 시작</div>
                        <div class="setting-value">켜짐</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">완료 시 알림</div>
                        <div class="setting-value">켜짐</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">배경 음악</div>
                        <div class="setting-value">꺼짐</div>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>앱 정보</h3>
                    <div class="setting-item">
                        <div class="setting-label">버전</div>
                        <div class="setting-value">1.0.0</div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">제작자</div>
                        <div class="setting-value">Claude Code</div>
                    </div>
                </div>

                <button class="btn secondary" onclick="clearAllSessions()">
                    모든 세션 기록 삭제
                </button>
            </div>
        </div>
    </div>

    <script>
        // 전역 상태
        let currentSpread = null;
        let timer = null;
        let timerInterval = null;
        let startTime = null;
        let pausedTime = 0;
        let isRunning = false;
        let isPaused = false;

        // 스프레드 정보
        const spreads = {
            'past-present-future': {
                name: '과거-현재-미래',
                description: '시간의 흐름 속에서 상황을 파악하고 미래를 준비하세요',
                cards: 3,
                recommendedTime: 15 * 60, // 15분 (초 단위)
                emoji: '🔮'
            },
            'love-relationship': {
                name: '연애운',
                description: '사랑과 관계에 대한 깊은 통찰을 얻어보세요',
                cards: 5,
                recommendedTime: 25 * 60,
                emoji: '💕'
            },
            'career-money': {
                name: '직업과 금전운',
                description: '커리어와 재정에 관한 조언을 구해보세요',
                cards: 4,
                recommendedTime: 20 * 60,
                emoji: '💰'
            },
            'celtic-cross': {
                name: '셀틱 크로스',
                description: '가장 전통적이고 포괄적인 타로 스프레드',
                cards: 10,
                recommendedTime: 45 * 60,
                emoji: '✨'
            },
            'daily-guidance': {
                name: '오늘의 가이던스',
                description: '하루를 시작하기 전 필요한 조언을 받아보세요',
                cards: 1,
                recommendedTime: 5 * 60,
                emoji: '🌅'
            }
        };

        // DOM 로드 완료 후 실행
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // 네비게이션 탭 이벤트 리스너
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab));
            });

            // 스프레드 카드 이벤트 리스너
            document.querySelectorAll('.spread-card').forEach(card => {
                card.addEventListener('click', () => selectSpread(card));
            });

            // 저장된 세션 불러오기
            loadSessions();
        }

        // 탭 전환
        function switchTab(clickedTab) {
            // 모든 탭 비활성화
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 모든 화면 숨기기
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // 클릭된 탭과 해당 화면 활성화
            clickedTab.classList.add('active');
            const screenId = clickedTab.dataset.screen;
            document.getElementById(screenId).classList.add('active');

            // 특별한 경우 처리
            if (screenId === 'sessions') {
                loadSessions();
            }
        }

        // 스프레드 선택
        function selectSpread(card) {
            // 이전 선택 제거
            document.querySelectorAll('.spread-card').forEach(c => {
                c.classList.remove('selected');
            });

            // 새 선택 표시
            card.classList.add('selected');

            const spreadKey = card.dataset.spread;
            currentSpread = spreads[spreadKey];
            currentSpread.key = spreadKey;

            // 타이머 화면 업데이트
            updateTimerScreen();

            // 선택 후 1초 뒤 타이머 탭으로 전환
            setTimeout(() => {
                document.querySelector('[data-screen="timer"]').click();
            }, 1000);
        }

        // 타이머 화면 업데이트
        function updateTimerScreen() {
            if (!currentSpread) return;

            const timerContent = document.getElementById('timer-content');
            const totalSeconds = currentSpread.recommendedTime;

            timerContent.innerHTML = `
                <div class="timer-container">
                    <div class="current-spread">
                        <h3>${currentSpread.emoji} ${currentSpread.name}</h3>
                        <p>${currentSpread.description}</p>
                    </div>

                    <div class="timer-circle glow-effect">
                        <div class="circle-progress" id="circle-progress">
                            <div class="circle-inner">
                                <div class="timer-time" id="timer-display">
                                    ${formatTime(totalSeconds)}
                                </div>
                                <div class="timer-label">
                                    ${currentSpread.cards}장의 카드 • ${Math.floor(totalSeconds / 60)}분
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timer-controls">
                        <button class="control-btn secondary" onclick="resetTimer()" title="리셋">
                            ⏹️
                        </button>
                        <button class="control-btn primary" id="play-pause-btn" onclick="toggleTimer()" title="시작/일시정지">
                            ▶️
                        </button>
                        <button class="control-btn secondary" onclick="finishSession()" title="완료">
                            ✅
                        </button>
                    </div>
                </div>
            `;

            resetTimer();
        }

        // 타이머 토글 (시작/일시정지)
        function toggleTimer() {
            if (!isRunning && !isPaused) {
                // 시작
                startTimer();
            } else if (isRunning) {
                // 일시정지
                pauseTimer();
            } else if (isPaused) {
                // 재개
                resumeTimer();
            }
        }

        // 타이머 시작
        function startTimer() {
            if (!currentSpread) return;

            startTime = Date.now();
            isRunning = true;
            isPaused = false;
            
            const totalSeconds = currentSpread.recommendedTime;
            let remainingTime = totalSeconds;

            // 버튼 업데이트
            document.getElementById('play-pause-btn').innerHTML = '⏸️';
            document.getElementById('play-pause-btn').title = '일시정지';

            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime + pausedTime) / 1000);
                remainingTime = Math.max(0, totalSeconds - elapsed);

                updateTimerDisplay(remainingTime, totalSeconds);

                if (remainingTime <= 0) {
                    completeTimer();
                }
            }, 1000);
        }

        // 타이머 일시정지
        function pauseTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            pausedTime += Date.now() - startTime;
            isRunning = false;
            isPaused = true;

            // 버튼 업데이트
            document.getElementById('play-pause-btn').innerHTML = '▶️';
            document.getElementById('play-pause-btn').title = '재개';
        }

        // 타이머 재개
        function resumeTimer() {
            startTime = Date.now();
            isRunning = true;
            isPaused = false;

            const totalSeconds = currentSpread.recommendedTime;
            const elapsed = Math.floor(pausedTime / 1000);
            let remainingTime = Math.max(0, totalSeconds - elapsed);

            // 버튼 업데이트
            document.getElementById('play-pause-btn').innerHTML = '⏸️';
            document.getElementById('play-pause-btn').title = '일시정지';

            timerInterval = setInterval(() => {
                const currentElapsed = Math.floor((Date.now() - startTime + pausedTime) / 1000);
                remainingTime = Math.max(0, totalSeconds - currentElapsed);

                updateTimerDisplay(remainingTime, totalSeconds);

                if (remainingTime <= 0) {
                    completeTimer();
                }
            }, 1000);
        }

        // 타이머 리셋
        function resetTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            isRunning = false;
            isPaused = false;
            pausedTime = 0;
            startTime = null;

            if (currentSpread) {
                const totalSeconds = currentSpread.recommendedTime;
                updateTimerDisplay(totalSeconds, totalSeconds);
            }

            // 버튼 리셋
            const playBtn = document.getElementById('play-pause-btn');
            if (playBtn) {
                playBtn.innerHTML = '▶️';
                playBtn.title = '시작';
            }
        }

        // 타이머 완료
        function completeTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            isRunning = false;
            isPaused = false;

            // 완료 효과
            document.querySelector('.timer-circle').classList.add('mystical-pulse');
            
            // 알림 (브라우저가 지원하는 경우)
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('타로 세션 완료!', {
                    body: `${currentSpread.name} 세션이 완료되었습니다.`,
                    icon: '🔮'
                });
            }

            // 자동으로 세션 저장
            setTimeout(() => {
                finishSession();
            }, 2000);
        }

        // 세션 완료
        function finishSession() {
            if (!currentSpread) return;

            const totalTime = currentSpread.recommendedTime;
            const elapsedTime = pausedTime + (isRunning ? Date.now() - startTime : 0);
            const actualDuration = Math.floor(elapsedTime / 1000);

            // 세션 저장
            const session = {
                id: Date.now(),
                spreadKey: currentSpread.key,
                spreadName: currentSpread.name,
                totalTime: totalTime,
                actualDuration: actualDuration,
                completedAt: new Date().toISOString(),
                isCompleted: actualDuration >= totalTime
            };

            saveSession(session);
            resetTimer();

            // 세션 탭으로 전환
            document.querySelector('[data-screen="sessions"]').click();
        }

        // 타이머 디스플레이 업데이트
        function updateTimerDisplay(remainingTime, totalTime) {
            const display = document.getElementById('timer-display');
            const progress = document.getElementById('circle-progress');
            
            if (display) {
                display.textContent = formatTime(remainingTime);
                
                // 시간이 줄어들수록 색상 변경
                if (remainingTime < 60) {
                    display.style.color = '#ef4444'; // 빨간색
                } else if (remainingTime < 300) {
                    display.style.color = '#f59e0b'; // 주황색
                } else {
                    display.style.color = 'var(--foreground)';
                }
            }

            if (progress) {
                const percentage = ((totalTime - remainingTime) / totalTime) * 360;
                progress.style.background = `conic-gradient(var(--premium-gold) ${percentage}deg, transparent ${percentage}deg)`;
            }
        }

        // 시간 포맷팅
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // 세션 저장
        function saveSession(session) {
            let sessions = JSON.parse(localStorage.getItem('tarotSessions') || '[]');
            sessions.unshift(session); // 최신순 정렬
            
            // 최대 50개 세션만 보관
            if (sessions.length > 50) {
                sessions = sessions.slice(0, 50);
            }
            
            localStorage.setItem('tarotSessions', JSON.stringify(sessions));
        }

        // 세션 불러오기
        function loadSessions() {
            const sessions = JSON.parse(localStorage.getItem('tarotSessions') || '[]');
            const container = document.getElementById('sessions-content');

            if (sessions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">📚</div>
                        <h3>아직 기록된 세션이 없습니다</h3>
                        <p>첫 번째 타로 세션을 시작해보세요</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="sessions-list">
                    ${sessions.map(session => `
                        <div class="session-card">
                            <div class="session-header">
                                <div class="session-spread">
                                    <span class="status-indicator status-${session.isCompleted ? 'finished' : 'paused'}"></span>
                                    ${spreads[session.spreadKey]?.emoji || '🔮'} ${session.spreadName}
                                </div>
                                <div class="session-date">
                                    ${new Date(session.completedAt).toLocaleDateString('ko-KR', {
                                        month: 'short',
                                        day: 'numeric',
                                        hour: '2-digit',
                                        minute: '2-digit'
                                    })}
                                </div>
                            </div>
                            <div class="session-duration">
                                ${formatTime(session.actualDuration)} / ${formatTime(session.totalTime)}
                                ${session.isCompleted ? '✅' : '⏸️'}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // 모든 세션 기록 삭제
        function clearAllSessions() {
            if (confirm('모든 세션 기록을 삭제하시겠습니까?')) {
                localStorage.removeItem('tarotSessions');
                loadSessions();
            }
        }

        // 알림 권한 요청
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // 페이지 언로드 시 타이머 정리
        window.addEventListener('beforeunload', function() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
        });

        // 모바일 터치 최적화
        document.addEventListener('touchstart', function() {}, { passive: true });
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>